/*! For license information please see annotorious-selector-pack.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Annotorious=e():(t.Annotorious=t.Annotorious||{},t.Annotorious.SelectorPack=e())}(self,(()=>(()=>{var t={94:t=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}t.exports=function t(n,r){if(n===r)return!0;if(n&&r&&"object"==e(n)&&"object"==e(r)){if(n.constructor!==r.constructor)return!1;var i,o,u;if(Array.isArray(n)){if((i=n.length)!=r.length)return!1;for(o=i;0!=o--;)if(!t(n[o],r[o]))return!1;return!0}if(n.constructor===RegExp)return n.source===r.source&&n.flags===r.flags;if(n.valueOf!==Object.prototype.valueOf)return n.valueOf()===r.valueOf();if(n.toString!==Object.prototype.toString)return n.toString()===r.toString();if((i=(u=Object.keys(n)).length)!==Object.keys(r).length)return!1;for(o=i;0!=o--;)if(!Object.prototype.hasOwnProperty.call(r,u[o]))return!1;for(o=i;0!=o--;){var a=u[o];if(!t(n[a],r[a]))return!1}return!0}return n!=n&&r!=r}},773:t=>{function e(){}e.prototype={on:function(t,e,n){var r=this.e||(this.e={});return(r[t]||(r[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var r=this;function i(){r.off(t,i),e.apply(n,arguments)}return i._=e,this.on(t,i,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),r=0,i=n.length;r<i;r++)n[r].fn.apply(n[r].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),r=n[t],i=[];if(r&&e)for(var o=0,u=r.length;o<u;o++)r[o].fn!==e&&r[o].fn._!==e&&i.push(r[o]);return i.length?n[t]=i:delete n[t],this}},t.exports=e,t.exports.TinyEmitter=e}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var r={};return(()=>{"use strict";n.d(r,{default:()=>ka});var t,e=n(773),i=n.n(e),o="http://www.w3.org/2000/svg",u=new Uint8Array(16);function a(){if(!t&&!(t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return t(u)}const s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var l=[],c=0;c<256;++c)l.push((c+256).toString(16).substr(1));const f=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(l[t[e+0]]+l[t[e+1]]+l[t[e+2]]+l[t[e+3]]+"-"+l[t[e+4]]+l[t[e+5]]+"-"+l[t[e+6]]+l[t[e+7]]+"-"+l[t[e+8]]+l[t[e+9]]+"-"+l[t[e+10]]+l[t[e+11]]+l[t[e+12]]+l[t[e+13]]+l[t[e+14]]+l[t[e+15]]).toLowerCase();if(!function(t){return"string"==typeof t&&s.test(t)}(n))throw TypeError("Stringified UUID is invalid");return n},h=function(t,e,n){var r=(t=t||{}).random||(t.rng||a)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return f(r)};var p=n(94),y=n.n(p);function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function b(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){g(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,w(r.key),r)}}function g(t,e,n){return(e=w(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w(t){var e=function(t,e){if("object"!==d(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===d(e)?e:String(e)}var O=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),g(this,"clone",(function(e,n){return new t(b(b({},r.underlying),e),b(b({},r.opts),n))})),g(this,"selector",(function(t){var e=r.underlying.target;if(e.selector)return(Array.isArray(e.selector)?e.selector:[e.selector]).find((function(e){return e.type===t}))})),this.underlying=e,this.opts=n}var e,n;return e=t,(n=[{key:"isEqual",value:function(t){return"Annotation"===(null==t?void 0:t.type)&&(this.underlying===t.underlying||!(!this.underlying.id||!t.underlying.id)&&y()(this.underlying,t.underlying))}},{key:"readOnly",get:function(){var t;return null===(t=this.opts)||void 0===t?void 0:t.readOnly}},{key:"id",get:function(){return this.underlying.id}},{key:"context",get:function(){return this.underlying["@context"]}},{key:"type",get:function(){return this.underlying.type}},{key:"motivation",get:function(){return this.underlying.motivation}},{key:"body",get:function(){return this.underlying.body}},{key:"target",get:function(){return this.underlying.target}},{key:"bodies",get:function(){return Array.isArray(this.underlying.body)?this.underlying.body:[this.underlying.body]},set:function(t){this.underlying.body=t}},{key:"targets",get:function(){return Array.isArray(this.underlying.target)?this.underlying.target:[this.underlying.target]}},{key:"quote",get:function(){var t;return null===(t=this.selector("TextQuoteSelector"))||void 0===t?void 0:t.exact}},{key:"start",get:function(){var t;return null===(t=this.selector("TextPositionSelector"))||void 0===t?void 0:t.start}},{key:"end",get:function(){var t;return null===(t=this.selector("TextPositionSelector"))||void 0===t?void 0:t.end}}])&&m(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function x(t){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x(t)}function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){j(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function k(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,P(r.key),r)}}function j(t,e,n){return(e=P(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P(t){var e=function(t,e){if("object"!==x(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==x(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===x(e)?e:String(e)}g(O,"create",(function(t){var e={"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation",id:"#".concat(h()),body:[]};return new O(b(b({},e),t))}));var A=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),j(this,"clone",(function(e){var n=new t;return n.underlying=JSON.parse(JSON.stringify(r.underlying)),e&&(n.underlying=_(_({},n.underlying),e)),n})),j(this,"selector",(function(t){var e=r.underlying.target;if(e.selector)return(Array.isArray(e.selector)?e.selector:[e.selector]).find((function(e){return e.type===t}))})),j(this,"toAnnotation",(function(){var t=Object.assign({},r.underlying,{type:"Annotation",id:"#".concat(h())});return new O(t)})),this.underlying={"@context":"http://www.w3.org/ns/anno.jsonld",type:"Selection",body:n||[],target:e}}var e,n;return e=t,(n=[{key:"context",get:function(){return this.underlying["@context"]}},{key:"type",get:function(){return this.underlying.type}},{key:"body",get:function(){return this.underlying.body}},{key:"target",get:function(){return this.underlying.target}},{key:"targets",get:function(){return Array.isArray(this.underlying.target)?this.underlying.target:[this.underlying.target]}},{key:"isEqual",value:function(t){return!!t&&y()(this.underlying,t.underlying)}},{key:"bodies",get:function(){return Array.isArray(this.underlying.body)?this.underlying.body:[this.underlying.body]}},{key:"quote",get:function(){var t;return null===(t=this.selector("TextQuoteSelector"))||void 0===t?void 0:t.exact}},{key:"isSelection",get:function(){return!0}}])&&k(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}function M(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,B(r.key),r)}}function T(t,e,n){return e&&C(t.prototype,e),n&&C(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function R(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&N(t,e)}function N(t,e){return N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},N(t,e)}function D(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L(t);if(e){var i=L(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===E(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return G(t)}(this,n)}}function G(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function L(t){return L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},L(t)}function I(t,e,n){return(e=B(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B(t){var e=function(t,e){if("object"!==E(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==E(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===E(e)?e:String(e)}var H="An implementation is missing",q="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,z=function(t){R(n,t);var e=D(n);function n(t,r,i){var u;M(this,n),I(G(u=e.call(this)),"enableResponsive",(function(){window.ResizeObserver&&(u.resizeObserver=new ResizeObserver((function(){var t=u.svg.getBoundingClientRect(),e=u.svg.viewBox.baseVal,n=e.width,r=e.height;u.scale=Math.max(n/t.width,r/t.height),u.onScaleChanged&&u.onScaleChanged(u.scale)})),u.resizeObserver.observe(u.svg.parentNode))})),I(G(u),"getSVGPoint",(function(t){var e=u.svg.createSVGPoint();if(q){var n=u.svg.getBoundingClientRect(),r=t.clientX-n.x,i=t.clientY-n.y,o=u.svg.getBoundingClientRect(),a=o.left,s=o.top;return e.x=r+a,e.y=i+s,e.matrixTransform(u.g.getScreenCTM().inverse())}return e.x=t.offsetX,e.y=t.offsetY,e.matrixTransform(u.g.getCTM().inverse())})),I(G(u),"drawHandle",(function(t,e){var n=document.createElementNS(o,"g");n.setAttribute("class","a9s-handle");var r=document.createElementNS(o,"g"),i=function(n){var r=document.createElementNS(o,"circle");return r.setAttribute("cx",t),r.setAttribute("cy",e),r.setAttribute("r",n),r.setAttribute("transform-origin","".concat(t," ").concat(e)),r},a=u.config.handleRadius||6,s=i(a);s.setAttribute("class","a9s-handle-inner");var l=i(a+1);return l.setAttribute("class","a9s-handle-outer"),r.appendChild(l),r.appendChild(s),n.appendChild(r),n})),I(G(u),"setHandleXY",(function(t,e,n){var r=t.querySelector(".a9s-handle-inner");r.setAttribute("cx",e),r.setAttribute("cy",n),r.setAttribute("transform-origin","".concat(e," ").concat(n));var i=t.querySelector(".a9s-handle-outer");i.setAttribute("cx",e),i.setAttribute("cy",n),i.setAttribute("transform-origin","".concat(e," ").concat(n))})),I(G(u),"getHandleXY",(function(t){var e=t.querySelector(".a9s-handle-outer");return{x:parseFloat(e.getAttribute("cx")),y:parseFloat(e.getAttribute("cy"))}})),I(G(u),"scaleHandle",(function(t){var e=t.querySelector(".a9s-handle-inner"),n=t.querySelector(".a9s-handle-outer"),r=u.scale*(u.config.handleRadius||6);e.setAttribute("r",r),n.setAttribute("r",r)})),u.svg=t.closest("svg"),u.g=t,u.config=r,u.env=i,u.scale=1;var a=i.image;return(a instanceof Element||a instanceof HTMLDocument)&&u.enableResponsive(),u}return T(n,[{key:"destroy",value:function(){this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeObserver=null}}]),n}(i()),F=function(t){R(n,t);var e=D(n);function n(t,r,i){var o;return M(this,n),I(G(o=e.call(this,t,r,i)),"attachListeners",(function(t){var e=t.mouseMove,n=t.mouseUp,r=t.dblClick;e&&(o.mouseMove=function(t){var n=o.getSVGPoint(t),r=n.x,i=n.y;o.started||(o.emit("startSelection",{x:r,y:i}),o.started=!0),e(r,i,t)},o.svg.addEventListener("mousemove",o.mouseMove)),n&&(o.mouseUp=function(t){if(0===t.button){var e=o.getSVGPoint(t),r=e.x,i=e.y;n(r,i,t)}},document.addEventListener("mouseup",o.mouseUp)),r&&(o.dblClick=function(t){var e=o.getSVGPoint(t),n=e.x,i=e.y;r(n,i,t)},document.addEventListener("dblclick",o.dblClick))})),I(G(o),"detachListeners",(function(){o.mouseMove&&o.svg.removeEventListener("mousemove",o.mouseMove),o.mouseUp&&document.removeEventListener("mouseup",o.mouseUp),o.dblClick&&document.removeEventListener("dblclick",o.dblClick)})),I(G(o),"start",(function(t,e){var n=o.getSVGPoint(t),r=n.x,i=n.y;o.startDrawing(r,i,e,t)})),I(G(o),"startDrawing",(function(t){throw new Error(H)})),I(G(o),"createEditableShape",(function(t,e){throw new Error(H)})),o.started=!1,o}return T(n,[{key:"isDrawing",get:function(){throw new Error(H)}}]),n}(z);function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}function Y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$(r.key),r)}}function U(t,e){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},U(t,e)}function V(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function W(t){return W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},W(t)}function $(t){var e=function(t,e){if("object"!==X(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==X(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===X(e)?e:String(e)}F.supports=function(t){throw new Error(H)};var Z="An implementation is missing",Q=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&U(t,e)}(u,t);var e,n,r,i,o=(r=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=W(r);if(i){var n=W(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===X(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return V(t)}(this,t)});function u(t,e,n,r){var i,a,s,l;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),a=V(i=o.call(this,e,n,r)),l=function(t){throw new Error(Z)},(s=$(s="updateState"))in a?Object.defineProperty(a,s,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[s]=l,i.annotation=t,i}return e=u,(n=[{key:"element",get:function(){throw new Error(Z)}}])&&Y(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(z);function J(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var K=function(t,e){var n=t.selector("FragmentSelector");if(null!=n&&n.conformsTo.startsWith("http://www.w3.org/TR/media-frags")){var r=n.value,i=r.includes(":")?r.substring(r.indexOf("=")+1,r.indexOf(":")):"pixel",o=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,u,a=[],s=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);s=!0);}catch(t){l=!0,i=t}finally{try{if(!s&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(l)throw i}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return J(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?J(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((r.includes(":")?r.substring(r.indexOf(":")+1):r.substring(r.indexOf("=")+1)).split(",").map(parseFloat),4),u=o[0],a=o[1],s=o[2],l=o[3];return"percent"===i.toLowerCase()&&(u=u*e.naturalWidth/100,a=a*e.naturalHeight/100,s=s*e.naturalWidth/100,l=l*e.naturalHeight/100),{x:u,y:a,w:s,h:l}}};function tt(t){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tt(t)}function et(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function nt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?et(Object(n),!0).forEach((function(e){rt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function rt(t,e,n){return(e=function(t){var e=function(t,e){if("object"!==tt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==tt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===tt(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var it=function(t,e,n,r){return nt(nt({},function(t,e,n,r,i,o){return"percent"===(null==o?void 0:o.toLowerCase())?function(t,e,n,r,i){var o=t/i.naturalWidth*100,u=e/i.naturalHeight*100,a=0/i.naturalWidth*100,s=0/i.naturalHeight*100;return{source:i.src,selector:{type:"FragmentSelector",conformsTo:"http://www.w3.org/TR/media-frags/",value:"xywh=percent:".concat(o,",").concat(u,",").concat(a,",").concat(s)}}}(t,e,0,0,i):function(t,e,n,r,i){return{source:null==i?void 0:i.src,selector:{type:"FragmentSelector",conformsTo:"http://www.w3.org/TR/media-frags/",value:"xywh=pixel:".concat(t,",").concat(e,",").concat(0,",").concat(0)}}}(t,e,0,0,i)}(t,e,0,0,n,r)),{},{renderedVia:{name:"point"}})};function ot(t){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(t)}function ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ht(r.key),r)}}function at(){return at="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ct(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},at.apply(this,arguments)}function st(t,e){return st=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},st(t,e)}function lt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ct(t){return ct=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ct(t)}function ft(t,e,n){return(e=ht(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ht(t){var e=function(t,e){if("object"!==ot(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===ot(e)?e:String(e)}var pt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&st(t,e)}(a,t);var e,n,r,i,u=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ct(r);if(i){var n=ct(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===ot(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return lt(t)}(this,t)});function a(t,e,n,r){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),ft(lt(i=u.call(this,t,e,n,r)),"onScaleChanged",(function(){return i.scaleHandle(i.point)})),ft(lt(i),"onGrab",(function(){i.isGrabbed=!0})),ft(lt(i),"onMouseMove",(function(t){if(0===t.button&&i.isGrabbed){var e=i.getSVGPoint(t),n=e.x,r=e.y;i.setHandleXY(i.point,n,r);var o=it(n,r,i.env.image,i.config.fragmentUnit);i.emit("update",o)}})),ft(lt(i),"onMouseUp",(function(){i.isGrabbed=!1})),ft(lt(i),"updateState",(function(t){var e=K(t,i.env.image),n=e.x,r=e.y;i.setHandleXY(i.point,n,r)})),i.svg.addEventListener("mousemove",i.onMouseMove),i.svg.addEventListener("mouseup",i.onMouseUp);var s=K(t,r.image),l=s.x,c=s.y;return i.container=document.createElementNS(o,"g"),i.elementGroup=document.createElementNS(o,"g"),i.elementGroup.setAttribute("class","a9s-annotation editable selected"),i.point=i.drawHandle(l,c),i.point.addEventListener("mousedown",i.onGrab),i.elementGroup.appendChild(i.point),i.container.appendChild(i.elementGroup),e.appendChild(i.container),i.isGrabbed=!1,i}return e=a,(n=[{key:"element",get:function(){return this.elementGroup}},{key:"destroy",value:function(){this.svg.removeEventListener("mousemove",this.onMouseMove),this.svg.removeEventListener("mouseup",this.onMouseUp),this.container.parentNode.removeChild(this.container),at(ct(a.prototype),"destroy",this).call(this)}}])&&ut(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Q);function yt(t){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yt(t)}function dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wt(r.key),r)}}function vt(t,e){return vt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},vt(t,e)}function bt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function mt(t){return mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},mt(t)}function gt(t,e,n){return(e=wt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wt(t){var e=function(t,e){if("object"!==yt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==yt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===yt(e)?e:String(e)}var Ot=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vt(t,e)}(u,t);var e,n,r,i,o=(r=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=mt(r);if(i){var n=mt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===yt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return bt(t)}(this,t)});function u(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),gt(bt(r=o.call(this,t,e,n)),"startDrawing",(function(t,e,n,i){var o,u=null===(o=i.target.closest(".a9s-annotation"))||void 0===o?void 0:o.annotation;if(u&&function(t){var e;return"point"===(null===(e=t.target.renderedVia)||void 0===e?void 0:e.name)}(u))r.emit("cancel");else{var a=r.drawHandle(t,e);r.scaleHandle(a),r.g.appendChild(a),a.annotation=new A(it(t,e,r.env.image,r.config.fragmentUnit)),r.emit("complete",a)}})),gt(bt(r),"stop",(function(){})),gt(bt(r),"createEditableShape",(function(t){return new pt(t,r.g,r.config,r.env)})),r}return e=u,(n=[{key:"isDrawing",get:function(){return!1}}])&&dt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(F);Ot.identifier="point",Ot.supports=function(t){return!1};var xt=function(t){var e=function(t){Array.from(t.attributes).forEach((function(e){e.name.startsWith("on")&&t.removeAttribute(e.name)}))},n=t.getElementsByTagName("script");return Array.from(n).reverse().forEach((function(t){return t.parentNode.removeChild(t)})),e(t),Array.from(t.querySelectorAll("*")).forEach(e),t},St=function(t){var e,n,r=t.selector("SvgSelector");if(r){var i=new DOMParser,u=r.value,a=i.parseFromString(u,"image/svg+xml"),s=a.lookupPrefix(o),l=a.lookupNamespaceURI(null);return s||l?xt(a).firstChild:xt((e=a,n=(new XMLSerializer).serializeToString(e.documentElement).replace("<svg>",'<svg xmlns="'.concat(o,'">')),(new DOMParser).parseFromString(n,"image/svg+xml").documentElement)).firstChild}},_t=function(t){var e=St(t),n=document.createElementNS(o,"g"),r=e.cloneNode(!0);r.setAttribute("class","a9s-inner");var i=e.cloneNode(!0);return i.setAttribute("class","a9s-outer"),n.appendChild(i),n.appendChild(r),n},kt=function(t,e){var n=t.querySelector(".a9s-inner").cloneNode(!0);n.removeAttribute("class"),n.removeAttribute("xmlns");var r=n.outerHTML||(new XMLSerializer).serializeToString(n);return r=r.replace(' xmlns="'.concat(o,'"'),""),{source:null==e?void 0:e.src,selector:{type:"SvgSelector",value:"<svg>".concat(r,"</svg>")}}};function jt(){return jt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=It(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},jt.apply(this,arguments)}function Pt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function At(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Pt(Object(n),!0).forEach((function(e){Et(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Pt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Et(t,e,n){return(e=qt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Lt(t,e)}function Ct(t){var e=Gt();return function(){var n,r=It(t);if(e){var i=It(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Tt(this,n)}}function Tt(t,e){if(e&&("object"===Yt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Rt(t)}function Rt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Nt(t){var e="function"==typeof Map?new Map:void 0;return Nt=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return Dt(t,arguments,It(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Lt(r,t)},Nt(t)}function Dt(t,e,n){return Dt=Gt()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&Lt(i,n.prototype),i},Dt.apply(null,arguments)}function Gt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Lt(t,e){return Lt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Lt(t,e)}function It(t){return It=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},It(t)}function Bt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,qt(r.key),r)}}function Ht(t,e,n){return e&&Bt(t.prototype,e),n&&Bt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function qt(t){var e=function(t,e){if("object"!==Yt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Yt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Yt(e)?e:String(e)}function zt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ft(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,u,a=[],s=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);s=!0);}catch(t){l=!0,i=t}finally{try{if(!s&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(l)throw i}}return a}}(t,e)||Vt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xt(t){return function(t){if(Array.isArray(t))return Wt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Vt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yt(t){return Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yt(t)}function Ut(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Vt(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return u=t.done,t},e:function(t){a=!0,o=t},f:function(){try{u||null==n.return||n.return()}finally{if(a)throw o}}}}function Vt(t,e){if(t){if("string"==typeof t)return Wt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wt(t,e):void 0}}function Wt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var $t={},Zt=[];function Qt(t,e){if(Array.isArray(t)){var n,r=Ut(t);try{for(r.s();!(n=r.n()).done;)Qt(n.value,e)}catch(t){r.e(t)}finally{r.f()}}else if("object"!==Yt(t))Kt(Object.getOwnPropertyNames(e)),$t[t]=Object.assign($t[t]||{},e);else for(var i in t)Qt(i,t[i])}function Jt(t){return $t[t]||{}}function Kt(t){Zt.push.apply(Zt,Xt(t))}function te(t,e){var n,r=t.length,i=[];for(n=0;n<r;n++)i.push(e(t[n]));return i}function ee(t){return t%360*Math.PI/180}function ne(t){return t.toLowerCase().replace(/-(.)/g,(function(t,e){return e.toUpperCase()}))}function re(t){return t.charAt(0).toUpperCase()+t.slice(1)}function ie(t,e,n,r){return null!=e&&null!=n||(r=r||t.bbox(),null==e?e=r.width/r.height*n:null==n&&(n=r.height/r.width*e)),{width:e,height:n}}function oe(t,e){var n=t.origin,r=null!=t.ox?t.ox:null!=t.originX?t.originX:"center",i=null!=t.oy?t.oy:null!=t.originY?t.originY:"center";if(null!=n){var o=Ft(Array.isArray(n)?n:"object"===Yt(n)?[n.x,n.y]:[n,n],2);r=o[0],i=o[1]}var u="string"==typeof r,a="string"==typeof i;if(u||a){var s=e.bbox(),l=s.height,c=s.width,f=s.x,h=s.y;u&&(r=r.includes("left")?f:r.includes("right")?f+c:f+c/2),a&&(i=i.includes("top")?h:i.includes("bottom")?h+l:h+l/2)}return[r,i]}var ue="http://www.w3.org/2000/svg",ae="http://www.w3.org/2000/xmlns/",se="http://www.w3.org/1999/xlink",le={window:"undefined"==typeof window?null:window,document:"undefined"==typeof document?null:document},ce=Ht((function t(){zt(this,t)})),fe={},he="___SYMBOL___ROOT___";function pe(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ue;return le.document.createElementNS(e,t)}function ye(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t instanceof ce)return t;if("object"===Yt(t))return be(t);if(null==t)return new fe[he];if("string"==typeof t&&"<"!==t.charAt(0))return be(le.document.querySelector(t));var n=e?le.document.createElement("div"):pe("svg");return n.innerHTML=t,t=be(n.firstChild),n.removeChild(n.firstChild),t}function de(t,e){return e&&e.ownerDocument&&e instanceof e.ownerDocument.defaultView.Node?e:pe(t)}function ve(t){if(!t)return null;if(t.instance instanceof ce)return t.instance;if("#document-fragment"===t.nodeName)return new fe.Fragment(t);var e=re(t.nodeName||"Dom");return"LinearGradient"===e||"RadialGradient"===e?e="Gradient":fe[e]||(e="Dom"),new fe[e](t)}var be=ve;function me(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.name,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return fe[e]=t,n&&(fe[he]=t),Kt(Object.getOwnPropertyNames(t.prototype)),t}var ge=1e3;function we(t){return"Svgjs"+re(t)+ge++}function Oe(t){for(var e=t.children.length-1;e>=0;e--)Oe(t.children[e]);return t.id?(t.id=we(t.nodeName),t):t}function xe(t,e){var n,r;for(r=(t=Array.isArray(t)?t:[t]).length-1;r>=0;r--)for(n in e)t[r].prototype[n]=e[n]}function Se(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[n.length-1];return!i||i.constructor!==Object||i instanceof Array?t.apply(this,n):t.apply(this,n.slice(0,-1)).attr(i)}}Qt("Dom",{siblings:function(){return this.parent().children()},position:function(){return this.parent().index(this)},next:function(){return this.siblings()[this.position()+1]},prev:function(){return this.siblings()[this.position()-1]},forward:function(){var t=this.position();return this.parent().add(this.remove(),t+1),this},backward:function(){var t=this.position();return this.parent().add(this.remove(),t?t-1:0),this},front:function(){return this.parent().add(this.remove()),this},back:function(){return this.parent().add(this.remove(),0),this},before:function(t){(t=ye(t)).remove();var e=this.position();return this.parent().add(t,e),this},after:function(t){(t=ye(t)).remove();var e=this.position();return this.parent().add(t,e+1),this},insertBefore:function(t){return(t=ye(t)).before(this),this},insertAfter:function(t){return(t=ye(t)).after(this),this}});var _e=/^([+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?)([a-z%]*)$/i,ke=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,je=/rgb\((\d+),(\d+),(\d+)\)/,Pe=/(#[a-z_][a-z0-9\-_]*)/i,Ae=/\)\s*,?\s*/,Ee=/\s/g,Me=/^#[a-f0-9]{3}$|^#[a-f0-9]{6}$/i,Ce=/^rgb\(/,Te=/^(\s+)?$/,Re=/^[+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ne=/\.(jpg|jpeg|png|gif|svg)(\?[^=]+.*)?/i,De=/[\s,]+/,Ge=/[MLHVCSQTAZ]/i;function Le(t){var e=Math.round(t),n=Math.max(0,Math.min(255,e)).toString(16);return 1===n.length?"0"+n:n}function Ie(t,e){for(var n=e.length;n--;)if(null==t[e[n]])return!1;return!0}function Be(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}Qt("Dom",{classes:function(){var t=this.attr("class");return null==t?[]:t.trim().split(De)},hasClass:function(t){return-1!==this.classes().indexOf(t)},addClass:function(t){if(!this.hasClass(t)){var e=this.classes();e.push(t),this.attr("class",e.join(" "))}return this},removeClass:function(t){return this.hasClass(t)&&this.attr("class",this.classes().filter((function(e){return e!==t})).join(" ")),this},toggleClass:function(t){return this.hasClass(t)?this.removeClass(t):this.addClass(t)}}),Qt("Dom",{css:function(t,e){var n={};if(0===arguments.length)return this.node.style.cssText.split(/\s*;\s*/).filter((function(t){return!!t.length})).forEach((function(t){var e=t.split(/\s*:\s*/);n[e[0]]=e[1]})),n;if(arguments.length<2){if(Array.isArray(t)){var r,i=Ut(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,u=ne(o);n[o]=this.node.style[u]}}catch(t){i.e(t)}finally{i.f()}return n}if("string"==typeof t)return this.node.style[ne(t)];if("object"===Yt(t))for(var a in t)this.node.style[ne(a)]=null==t[a]||Te.test(t[a])?"":t[a]}return 2===arguments.length&&(this.node.style[ne(t)]=null==e||Te.test(e)?"":e),this},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},visible:function(){return"none"!==this.css("display")}}),Qt("Dom",{data:function(t,e,n){if(null==t)return this.data(te(function(t,e){var n,r=t.length,i=[];for(n=0;n<r;n++)e(t[n])&&i.push(t[n]);return i}(this.node.attributes,(function(t){return 0===t.nodeName.indexOf("data-")})),(function(t){return t.nodeName.slice(5)})));if(t instanceof Array){var r,i={},o=Ut(t);try{for(o.s();!(r=o.n()).done;){var u=r.value;i[u]=this.data(u)}}catch(t){o.e(t)}finally{o.f()}return i}if("object"===Yt(t))for(e in t)this.data(e,t[e]);else if(arguments.length<2)try{return JSON.parse(this.attr("data-"+t))}catch(e){return this.attr("data-"+t)}else this.attr("data-"+t,null===e?null:!0===n||"string"==typeof e||"number"==typeof e?e:JSON.stringify(e));return this}}),Qt("Dom",{remember:function(t,e){if("object"===Yt(arguments[0]))for(var n in t)this.remember(n,t[n]);else{if(1===arguments.length)return this.memory()[t];this.memory()[t]=e}return this},forget:function(){if(0===arguments.length)this._memory={};else for(var t=arguments.length-1;t>=0;t--)delete this.memory()[arguments[t]];return this},memory:function(){return this._memory=this._memory||{}}});var He=function(){function t(){zt(this,t),this.init.apply(this,arguments)}return Ht(t,[{key:"cmyk",value:function(){var e=this.rgb(),n=Ft([e._a,e._b,e._c].map((function(t){return t/255})),3),r=n[0],i=n[1],o=n[2],u=Math.min(1-r,1-i,1-o);return 1===u?new t(0,0,0,1,"cmyk"):new t((1-r-u)/(1-u),(1-i-u)/(1-u),(1-o-u)/(1-u),u,"cmyk")}},{key:"hsl",value:function(){var e=this.rgb(),n=Ft([e._a,e._b,e._c].map((function(t){return t/255})),3),r=n[0],i=n[1],o=n[2],u=Math.max(r,i,o),a=Math.min(r,i,o),s=(u+a)/2,l=u===a,c=u-a;return new t(360*(l?0:u===r?((i-o)/c+(i<o?6:0))/6:u===i?((o-r)/c+2)/6:u===o?((r-i)/c+4)/6:0),100*(l?0:s>.5?c/(2-u-a):c/(u+a)),100*s,"hsl")}},{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"rgb";if(t=t||0,this.space)for(var o in this.space)delete this[this.space[o]];if("number"==typeof t)i="string"==typeof r?r:i,r="string"==typeof r?0:r,Object.assign(this,{_a:t,_b:e,_c:n,_d:r,space:i});else if(t instanceof Array)this.space=e||("string"==typeof t[3]?t[3]:t[4])||"rgb",Object.assign(this,{_a:t[0],_b:t[1],_c:t[2],_d:t[3]||0});else if(t instanceof Object){var u=function(t,e){var n=Ie(t,"rgb")?{_a:t.r,_b:t.g,_c:t.b,_d:0,space:"rgb"}:Ie(t,"xyz")?{_a:t.x,_b:t.y,_c:t.z,_d:0,space:"xyz"}:Ie(t,"hsl")?{_a:t.h,_b:t.s,_c:t.l,_d:0,space:"hsl"}:Ie(t,"lab")?{_a:t.l,_b:t.a,_c:t.b,_d:0,space:"lab"}:Ie(t,"lch")?{_a:t.l,_b:t.c,_c:t.h,_d:0,space:"lch"}:Ie(t,"cmyk")?{_a:t.c,_b:t.m,_c:t.y,_d:t.k,space:"cmyk"}:{_a:0,_b:0,_c:0,space:"rgb"};return n.space=e||n.space,n}(t,e);Object.assign(this,u)}else if("string"==typeof t)if(Ce.test(t)){var a=t.replace(Ee,""),s=Ft(je.exec(a).slice(1,4).map((function(t){return parseInt(t)})),3),l=s[0],c=s[1],f=s[2];Object.assign(this,{_a:l,_b:c,_c:f,_d:0,space:"rgb"})}else{if(!Me.test(t))throw Error("Unsupported string format, can't construct Color");var h=ke.exec(function(t){return 4===t.length?["#",t.substring(1,2),t.substring(1,2),t.substring(2,3),t.substring(2,3),t.substring(3,4),t.substring(3,4)].join(""):t}(t)).map((function(t){return parseInt(t,16)})),p=Ft(h,4),y=p[1],d=p[2],v=p[3];Object.assign(this,{_a:y,_b:d,_c:v,_d:0,space:"rgb"})}var b=this._a,m=this._b,g=this._c,w=this._d,O="rgb"===this.space?{r:b,g:m,b:g}:"xyz"===this.space?{x:b,y:m,z:g}:"hsl"===this.space?{h:b,s:m,l:g}:"lab"===this.space?{l:b,a:m,b:g}:"lch"===this.space?{l:b,c:m,h:g}:"cmyk"===this.space?{c:b,m,y:g,k:w}:{};Object.assign(this,O)}},{key:"lab",value:function(){var e=this.xyz(),n=e.x,r=e.y;return new t(116*r-16,500*(n-r),200*(r-e.z),"lab")}},{key:"lch",value:function(){var e=this.lab(),n=e.l,r=e.a,i=e.b,o=Math.sqrt(Math.pow(r,2)+Math.pow(i,2)),u=180*Math.atan2(i,r)/Math.PI;return u<0&&(u=360-(u*=-1)),new t(n,o,u,"lch")}},{key:"rgb",value:function(){if("rgb"===this.space)return this;if("lab"===(M=this.space)||"xyz"===M||"lch"===M){var e=this.x,n=this.y,r=this.z;if("lab"===this.space||"lch"===this.space){var i=this.l,o=this.a,u=this.b;if("lch"===this.space){var a=this.c,s=this.h,l=Math.PI/180;o=a*Math.cos(l*s),u=a*Math.sin(l*s)}var c=(i+16)/116,f=o/500+c,h=c-u/200,p=16/116,y=.008856,d=7.787;e=.95047*(Math.pow(f,3)>y?Math.pow(f,3):(f-p)/d),n=1*(Math.pow(c,3)>y?Math.pow(c,3):(c-p)/d),r=1.08883*(Math.pow(h,3)>y?Math.pow(h,3):(h-p)/d)}var v=3.2406*e+-1.5372*n+-.4986*r,b=-.9689*e+1.8758*n+.0415*r,m=.0557*e+-.204*n+1.057*r,g=Math.pow,w=.0031308;return new t(255*(v>w?1.055*g(v,1/2.4)-.055:12.92*v),255*(b>w?1.055*g(b,1/2.4)-.055:12.92*b),255*(m>w?1.055*g(m,1/2.4)-.055:12.92*m))}if("hsl"===this.space){var O=this.h,x=this.s,S=this.l;if(O/=360,S/=100,0==(x/=100))return new t(S*=255,S,S);var _=S<.5?S*(1+x):S+x-S*x,k=2*S-_;return new t(255*Be(k,_,O+1/3),255*Be(k,_,O),255*Be(k,_,O-1/3))}if("cmyk"===this.space){var j=this.c,P=this.m,A=this.y,E=this.k;return new t(255*(1-Math.min(1,j*(1-E)+E)),255*(1-Math.min(1,P*(1-E)+E)),255*(1-Math.min(1,A*(1-E)+E)))}return this;var M}},{key:"toArray",value:function(){return[this._a,this._b,this._c,this._d,this.space]}},{key:"toHex",value:function(){var t=Ft(this._clamped().map(Le),3),e=t[0],n=t[1],r=t[2];return"#".concat(e).concat(n).concat(r)}},{key:"toRgb",value:function(){var t=Ft(this._clamped(),3),e=t[0],n=t[1],r=t[2];return"rgb(".concat(e,",").concat(n,",").concat(r,")")}},{key:"toString",value:function(){return this.toHex()}},{key:"xyz",value:function(){var e=this.rgb(),n=Ft([e._a,e._b,e._c].map((function(t){return t/255})),3),r=n[0],i=n[1],o=n[2],u=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,a=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92,s=o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92,l=(.4124*u+.3576*a+.1805*s)/.95047,c=(.2126*u+.7152*a+.0722*s)/1,f=(.0193*u+.1192*a+.9505*s)/1.08883;return new t(l>.008856?Math.pow(l,1/3):7.787*l+16/116,c>.008856?Math.pow(c,1/3):7.787*c+16/116,f>.008856?Math.pow(f,1/3):7.787*f+16/116,"xyz")}},{key:"_clamped",value:function(){var t=this.rgb(),e=t._a,n=t._b,r=t._c,i=Math.max,o=Math.min,u=Math.round;return[e,n,r].map((function(t){return i(0,o(u(t),255))}))}}],[{key:"isColor",value:function(e){return e&&(e instanceof t||this.isRgb(e)||this.test(e))}},{key:"isRgb",value:function(t){return t&&"number"==typeof t.r&&"number"==typeof t.g&&"number"==typeof t.b}},{key:"random",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"vibrant",n=arguments.length>1?arguments[1]:void 0,r=Math.random,i=Math.round,o=Math.sin,u=Math.PI;if("vibrant"===e)return new t(24*r()+57,38*r()+45,360*r(),"lch");if("sine"===e)return new t(i(80*o(2*u*(n=null==n?r():n)/.5+.01)+150),i(50*o(2*u*n/.5+4.6)+200),i(100*o(2*u*n/.5+2.3)+150));if("pastel"===e)return new t(8*r()+86,17*r()+9,360*r(),"lch");if("dark"===e)return new t(10+10*r(),50*r()+86,360*r(),"lch");if("rgb"===e)return new t(255*r(),255*r(),255*r());if("lab"===e)return new t(100*r(),256*r()-128,256*r()-128,"lab");if("grey"===e){var a=255*r();return new t(a,a,a)}throw new Error("Unsupported random color mode")}},{key:"test",value:function(t){return"string"==typeof t&&(Me.test(t)||Ce.test(t))}}]),t}(),qe=function(){function t(){zt(this,t),this.init.apply(this,arguments)}return Ht(t,[{key:"clone",value:function(){return new t(this)}},{key:"init",value:function(t,e){var n=Array.isArray(t)?{x:t[0],y:t[1]}:"object"===Yt(t)?{x:t.x,y:t.y}:{x:t,y:e};return this.x=null==n.x?0:n.x,this.y=null==n.y?0:n.y,this}},{key:"toArray",value:function(){return[this.x,this.y]}},{key:"transform",value:function(t){return this.clone().transformO(t)}},{key:"transformO",value:function(t){Fe.isMatrixLike(t)||(t=new Fe(t));var e=this.x,n=this.y;return this.x=t.a*e+t.c*n+t.e,this.y=t.b*e+t.d*n+t.f,this}}]),t}();function ze(t,e,n){return Math.abs(e-t)<(n||1e-6)}var Fe=function(){function t(){zt(this,t),this.init.apply(this,arguments)}return Ht(t,[{key:"around",value:function(t,e,n){return this.clone().aroundO(t,e,n)}},{key:"aroundO",value:function(t,e,n){var r=t||0,i=e||0;return this.translateO(-r,-i).lmultiplyO(n).translateO(r,i)}},{key:"clone",value:function(){return new t(this)}},{key:"decompose",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.a,r=this.b,i=this.c,o=this.d,u=this.e,a=this.f,s=n*o-r*i,l=s>0?1:-1,c=l*Math.sqrt(n*n+r*r),f=Math.atan2(l*r,l*n),h=180/Math.PI*f,p=Math.cos(f),y=Math.sin(f),d=(n*i+r*o)/s,v=i*c/(d*n-r)||o*c/(d*r+n);return{scaleX:c,scaleY:v,shear:d,rotate:h,translateX:u-t+t*p*c+e*(d*p*c-y*v),translateY:a-e+t*y*c+e*(d*y*c+p*v),originX:t,originY:e,a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f}}},{key:"equals",value:function(e){if(e===this)return!0;var n=new t(e);return ze(this.a,n.a)&&ze(this.b,n.b)&&ze(this.c,n.c)&&ze(this.d,n.d)&&ze(this.e,n.e)&&ze(this.f,n.f)}},{key:"flip",value:function(t,e){return this.clone().flipO(t,e)}},{key:"flipO",value:function(t,e){return"x"===t?this.scaleO(-1,1,e,0):"y"===t?this.scaleO(1,-1,0,e):this.scaleO(-1,-1,t,e||t)}},{key:"init",value:function(e){var n=t.fromArray([1,0,0,1,0,0]);return e=e instanceof yn?e.matrixify():"string"==typeof e?t.fromArray(e.split(De).map(parseFloat)):Array.isArray(e)?t.fromArray(e):"object"===Yt(e)&&t.isMatrixLike(e)?e:"object"===Yt(e)?(new t).transform(e):6===arguments.length?t.fromArray([].slice.call(arguments)):n,this.a=null!=e.a?e.a:n.a,this.b=null!=e.b?e.b:n.b,this.c=null!=e.c?e.c:n.c,this.d=null!=e.d?e.d:n.d,this.e=null!=e.e?e.e:n.e,this.f=null!=e.f?e.f:n.f,this}},{key:"inverse",value:function(){return this.clone().inverseO()}},{key:"inverseO",value:function(){var t=this.a,e=this.b,n=this.c,r=this.d,i=this.e,o=this.f,u=t*r-e*n;if(!u)throw new Error("Cannot invert "+this);var a=r/u,s=-e/u,l=-n/u,c=t/u,f=-(a*i+l*o),h=-(s*i+c*o);return this.a=a,this.b=s,this.c=l,this.d=c,this.e=f,this.f=h,this}},{key:"lmultiply",value:function(t){return this.clone().lmultiplyO(t)}},{key:"lmultiplyO",value:function(e){var n=e instanceof t?e:new t(e);return t.matrixMultiply(n,this,this)}},{key:"multiply",value:function(t){return this.clone().multiplyO(t)}},{key:"multiplyO",value:function(e){var n=e instanceof t?e:new t(e);return t.matrixMultiply(this,n,this)}},{key:"rotate",value:function(t,e,n){return this.clone().rotateO(t,e,n)}},{key:"rotateO",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;t=ee(t);var r=Math.cos(t),i=Math.sin(t),o=this.a,u=this.b,a=this.c,s=this.d,l=this.e,c=this.f;return this.a=o*r-u*i,this.b=u*r+o*i,this.c=a*r-s*i,this.d=s*r+a*i,this.e=l*r-c*i+n*i-e*r+e,this.f=c*r+l*i-e*i-n*r+n,this}},{key:"scale",value:function(t,e,n,r){var i;return(i=this.clone()).scaleO.apply(i,arguments)}},{key:"scaleO",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;3===arguments.length&&(r=n,n=e,e=t);var i=this.a,o=this.b,u=this.c,a=this.d,s=this.e,l=this.f;return this.a=i*t,this.b=o*e,this.c=u*t,this.d=a*e,this.e=s*t-n*t+n,this.f=l*e-r*e+r,this}},{key:"shear",value:function(t,e,n){return this.clone().shearO(t,e,n)}},{key:"shearO",value:function(t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.a,r=this.b,i=this.c,o=this.d,u=this.e,a=this.f;return this.a=n+r*t,this.c=i+o*t,this.e=u+a*t-e*t,this}},{key:"skew",value:function(t,e,n,r){var i;return(i=this.clone()).skewO.apply(i,arguments)}},{key:"skewO",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;3===arguments.length&&(r=n,n=e,e=t),t=ee(t),e=ee(e);var i=Math.tan(t),o=Math.tan(e),u=this.a,a=this.b,s=this.c,l=this.d,c=this.e,f=this.f;return this.a=u+a*i,this.b=a+u*o,this.c=s+l*i,this.d=l+s*o,this.e=c+f*i-r*i,this.f=f+c*o-n*o,this}},{key:"skewX",value:function(t,e,n){return this.skew(t,0,e,n)}},{key:"skewY",value:function(t,e,n){return this.skew(0,t,e,n)}},{key:"toArray",value:function(){return[this.a,this.b,this.c,this.d,this.e,this.f]}},{key:"toString",value:function(){return"matrix("+this.a+","+this.b+","+this.c+","+this.d+","+this.e+","+this.f+")"}},{key:"transform",value:function(e){if(t.isMatrixLike(e))return new t(e).multiplyO(this);var n=t.formatTransforms(e),r=new qe(n.ox,n.oy).transform(this),i=r.x,o=r.y,u=(new t).translateO(n.rx,n.ry).lmultiplyO(this).translateO(-i,-o).scaleO(n.scaleX,n.scaleY).skewO(n.skewX,n.skewY).shearO(n.shear).rotateO(n.theta).translateO(i,o);if(isFinite(n.px)||isFinite(n.py)){var a=new qe(i,o).transform(u),s=isFinite(n.px)?n.px-a.x:0,l=isFinite(n.py)?n.py-a.y:0;u.translateO(s,l)}return u.translateO(n.tx,n.ty),u}},{key:"translate",value:function(t,e){return this.clone().translateO(t,e)}},{key:"translateO",value:function(t,e){return this.e+=t||0,this.f+=e||0,this}},{key:"valueOf",value:function(){return{a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f}}}],[{key:"formatTransforms",value:function(t){var e="both"===t.flip||!0===t.flip,n=t.flip&&(e||"x"===t.flip)?-1:1,r=t.flip&&(e||"y"===t.flip)?-1:1,i=t.skew&&t.skew.length?t.skew[0]:isFinite(t.skew)?t.skew:isFinite(t.skewX)?t.skewX:0,o=t.skew&&t.skew.length?t.skew[1]:isFinite(t.skew)?t.skew:isFinite(t.skewY)?t.skewY:0,u=t.scale&&t.scale.length?t.scale[0]*n:isFinite(t.scale)?t.scale*n:isFinite(t.scaleX)?t.scaleX*n:n,a=t.scale&&t.scale.length?t.scale[1]*r:isFinite(t.scale)?t.scale*r:isFinite(t.scaleY)?t.scaleY*r:r,s=t.shear||0,l=t.rotate||t.theta||0,c=new qe(t.origin||t.around||t.ox||t.originX,t.oy||t.originY),f=c.x,h=c.y,p=new qe(t.position||t.px||t.positionX||NaN,t.py||t.positionY||NaN),y=p.x,d=p.y,v=new qe(t.translate||t.tx||t.translateX,t.ty||t.translateY),b=v.x,m=v.y,g=new qe(t.relative||t.rx||t.relativeX,t.ry||t.relativeY);return{scaleX:u,scaleY:a,skewX:i,skewY:o,shear:s,theta:l,rx:g.x,ry:g.y,tx:b,ty:m,ox:f,oy:h,px:y,py:d}}},{key:"fromArray",value:function(t){return{a:t[0],b:t[1],c:t[2],d:t[3],e:t[4],f:t[5]}}},{key:"isMatrixLike",value:function(t){return null!=t.a||null!=t.b||null!=t.c||null!=t.d||null!=t.e||null!=t.f}},{key:"matrixMultiply",value:function(t,e,n){var r=t.a*e.a+t.c*e.b,i=t.b*e.a+t.d*e.b,o=t.a*e.c+t.c*e.d,u=t.b*e.c+t.d*e.d,a=t.e+t.a*e.e+t.c*e.f,s=t.f+t.b*e.e+t.d*e.f;return n.a=r,n.b=i,n.c=o,n.d=u,n.e=a,n.f=s,n}}]),t}();function Xe(){if(!Xe.nodes){var t=ye().size(2,0);t.node.style.cssText=["opacity: 0","position: absolute","left: -100%","top: -100%","overflow: hidden"].join(";"),t.attr("focusable","false"),t.attr("aria-hidden","true");var e=t.path().node;Xe.nodes={svg:t,path:e}}if(!Xe.nodes.svg.node.parentNode){var n=le.document.body||le.document.documentElement;Xe.nodes.svg.addTo(n)}return Xe.nodes}function Ye(t){return!(t.width||t.height||t.x||t.y)}me(Fe,"Matrix");var Ue=function(){function t(){zt(this,t),this.init.apply(this,arguments)}return Ht(t,[{key:"addOffset",value:function(){return this.x+=le.window.pageXOffset,this.y+=le.window.pageYOffset,new t(this)}},{key:"init",value:function(t){return t="string"==typeof t?t.split(De).map(parseFloat):Array.isArray(t)?t:"object"===Yt(t)?[null!=t.left?t.left:t.x,null!=t.top?t.top:t.y,t.width,t.height]:4===arguments.length?[].slice.call(arguments):[0,0,0,0],this.x=t[0]||0,this.y=t[1]||0,this.width=this.w=t[2]||0,this.height=this.h=t[3]||0,this.x2=this.x+this.w,this.y2=this.y+this.h,this.cx=this.x+this.w/2,this.cy=this.y+this.h/2,this}},{key:"isNulled",value:function(){return Ye(this)}},{key:"merge",value:function(e){var n=Math.min(this.x,e.x),r=Math.min(this.y,e.y);return new t(n,r,Math.max(this.x+this.width,e.x+e.width)-n,Math.max(this.y+this.height,e.y+e.height)-r)}},{key:"toArray",value:function(){return[this.x,this.y,this.width,this.height]}},{key:"toString",value:function(){return this.x+" "+this.y+" "+this.width+" "+this.height}},{key:"transform",value:function(e){e instanceof Fe||(e=new Fe(e));var n=1/0,r=-1/0,i=1/0,o=-1/0;return[new qe(this.x,this.y),new qe(this.x2,this.y),new qe(this.x,this.y2),new qe(this.x2,this.y2)].forEach((function(t){t=t.transform(e),n=Math.min(n,t.x),r=Math.max(r,t.x),i=Math.min(i,t.y),o=Math.max(o,t.y)})),new t(n,i,r-n,o-i)}}]),t}();function Ve(t,e,n){var r,i;try{if(Ye(r=e(t.node))&&(i=t.node)!==le.document&&!(le.document.documentElement.contains||function(t){for(;t.parentNode;)t=t.parentNode;return t===le.document}).call(le.document.documentElement,i))throw new Error("Element not in the dom")}catch(e){r=n(t)}return r}Qt({viewbox:{viewbox:function(t,e,n,r){return null==t?new Ue(this.attr("viewBox")):this.attr("viewBox",new Ue(t,e,n,r))},zoom:function(t,e){var n=this.attr(["width","height"]),r=n.width,i=n.height;if((r||i)&&"string"!=typeof r&&"string"!=typeof i||(r=this.node.clientWidth,i=this.node.clientHeight),!r||!i)throw new Error("Impossible to get absolute width and height. Please provide an absolute width and height attribute on the zooming element");var o=this.viewbox(),u=r/o.width,a=i/o.height,s=Math.min(u,a);if(null==t)return s;var l=s/t;l===1/0&&(l=Number.MAX_SAFE_INTEGER/100),e=e||new qe(r/2/u+o.x,i/2/a+o.y);var c=new Ue(o).transform(new Fe({scale:l,origin:e}));return this.viewbox(c)}}}),me(Ue,"Box");var We=function(t){Mt(n,t);var e=Ct(n);function n(){var t,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];zt(this,n);for(var o=arguments.length,u=new Array(o>1?o-1:0),a=1;a<o;a++)u[a-1]=arguments[a];return r=e.call.apply(e,[this,i].concat(u)),"number"==typeof i?Tt(r,Rt(r)):(r.length=0,(t=r).push.apply(t,Xt(i)),r)}return Ht(n)}(Nt(Array));xe([We],{each:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return"function"==typeof t?this.map((function(e,n,r){return t.call(e,e,n,r)})):this.map((function(e){return e[t].apply(e,n)}))},toArray:function(){return Array.prototype.concat.apply([],this)}});var $e=["toArray","constructor","each"];function Ze(t,e){return new We(te((e||le.document).querySelectorAll(t),(function(t){return ve(t)})))}We.extend=function(t){t=t.reduce((function(t,e){return $e.includes(e)||"_"===e[0]||(t[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return this.each.apply(this,[e].concat(n))}),t}),{}),xe([We],t)};var Qe=0,Je={};function Ke(t){var e=t.getEventHolder();return e===le.window&&(e=Je),e.events||(e.events={}),e.events}function tn(t){return t.getEventTarget()}function en(t,e,n,r,i){var o=n.bind(r||t),u=ye(t),a=Ke(u),s=tn(u);e=Array.isArray(e)?e:e.split(De),n._svgjsListenerId||(n._svgjsListenerId=++Qe),e.forEach((function(t){var e=t.split(".")[0],r=t.split(".")[1]||"*";a[e]=a[e]||{},a[e][r]=a[e][r]||{},a[e][r][n._svgjsListenerId]=o,s.addEventListener(e,o,i||!1)}))}function nn(t,e,n,r){var i=ye(t),o=Ke(i),u=tn(i);("function"!=typeof n||(n=n._svgjsListenerId))&&(e=Array.isArray(e)?e:(e||"").split(De)).forEach((function(t){var e,a,s=t&&t.split(".")[0],l=t&&t.split(".")[1];if(n)o[s]&&o[s][l||"*"]&&(u.removeEventListener(s,o[s][l||"*"][n],r||!1),delete o[s][l||"*"][n]);else if(s&&l){if(o[s]&&o[s][l]){for(a in o[s][l])nn(u,[s,l].join("."),a);delete o[s][l]}}else if(l)for(t in o)for(e in o[t])l===e&&nn(u,[t,l].join("."));else if(s){if(o[s]){for(e in o[s])nn(u,[s,e].join("."));delete o[s]}}else{for(t in o)nn(u,t);!function(t){var e=t.getEventHolder();e===le.window&&(e=Je),e.events&&(e.events={})}(i)}}))}var rn=function(t){Mt(n,t);var e=Ct(n);function n(){return zt(this,n),e.apply(this,arguments)}return Ht(n,[{key:"addEventListener",value:function(){}},{key:"dispatch",value:function(t,e,n){return function(t,e,n,r){var i=tn(t);return e instanceof le.window.Event||(e=new le.window.CustomEvent(e,At({detail:n,cancelable:!0},r))),i.dispatchEvent(e),e}(this,t,e,n)}},{key:"dispatchEvent",value:function(t){var e=this.getEventHolder().events;if(!e)return!0;var n=e[t.type];for(var r in n)for(var i in n[r])n[r][i](t);return!t.defaultPrevented}},{key:"fire",value:function(t,e,n){return this.dispatch(t,e,n),this}},{key:"getEventHolder",value:function(){return this}},{key:"getEventTarget",value:function(){return this}},{key:"off",value:function(t,e,n){return nn(this,t,e,n),this}},{key:"on",value:function(t,e,n,r){return en(this,t,e,n,r),this}},{key:"removeEventListener",value:function(){}}]),n}(ce);function on(){}me(rn,"EventTarget");var un=400,an=">",sn=0,ln={"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,"stroke-linejoin":"miter","stroke-linecap":"butt",fill:"#000000",stroke:"#000000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0,"stop-opacity":1,"stop-color":"#000000","text-anchor":"start"},cn=function(t){Mt(n,t);var e=Ct(n);function n(){var t,r;zt(this,n);for(var i=arguments.length,o=new Array(i),u=0;u<i;u++)o[u]=arguments[u];return(t=r=e.call.apply(e,[this].concat(o))).init.apply(t,o),r}return Ht(n,[{key:"clone",value:function(){return new this.constructor(this)}},{key:"init",value:function(t){return"number"==typeof t||(this.length=0,this.push.apply(this,Xt(this.parse(t)))),this}},{key:"parse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t instanceof Array?t:t.trim().split(De).map(parseFloat)}},{key:"toArray",value:function(){return Array.prototype.concat.apply([],this)}},{key:"toSet",value:function(){return new Set(this)}},{key:"toString",value:function(){return this.join(" ")}},{key:"valueOf",value:function(){var t=[];return t.push.apply(t,Xt(this)),t}}]),n}(Nt(Array)),fn=function(){function t(){zt(this,t),this.init.apply(this,arguments)}return Ht(t,[{key:"convert",value:function(e){return new t(this.value,e)}},{key:"divide",value:function(e){return e=new t(e),new t(this/e,this.unit||e.unit)}},{key:"init",value:function(e,n){return n=Array.isArray(e)?e[1]:n,e=Array.isArray(e)?e[0]:e,this.value=0,this.unit=n||"","number"==typeof e?this.value=isNaN(e)?0:isFinite(e)?e:e<0?-34e37:34e37:"string"==typeof e?(n=e.match(_e))&&(this.value=parseFloat(n[1]),"%"===n[5]?this.value/=100:"s"===n[5]&&(this.value*=1e3),this.unit=n[5]):e instanceof t&&(this.value=e.valueOf(),this.unit=e.unit),this}},{key:"minus",value:function(e){return e=new t(e),new t(this-e,this.unit||e.unit)}},{key:"plus",value:function(e){return e=new t(e),new t(this+e,this.unit||e.unit)}},{key:"times",value:function(e){return e=new t(e),new t(this*e,this.unit||e.unit)}},{key:"toArray",value:function(){return[this.value,this.unit]}},{key:"toJSON",value:function(){return this.toString()}},{key:"toString",value:function(){return("%"===this.unit?~~(1e8*this.value)/1e6:"s"===this.unit?this.value/1e3:this.value)+this.unit}},{key:"valueOf",value:function(){return this.value}}]),t}(),hn=[],pn=function(t){Mt(n,t);var e=Ct(n);function n(t,r){var i;return zt(this,n),(i=e.call(this)).node=t,i.type=t.nodeName,r&&t!==r&&i.attr(r),i}return Ht(n,[{key:"add",value:function(t,e){return(t=ye(t)).removeNamespace&&this.node instanceof le.window.SVGElement&&t.removeNamespace(),null==e?this.node.appendChild(t.node):t.node!==this.node.childNodes[e]&&this.node.insertBefore(t.node,this.node.childNodes[e]),this}},{key:"addTo",value:function(t,e){return ye(t).put(this,e)}},{key:"children",value:function(){return new We(te(this.node.children,(function(t){return ve(t)})))}},{key:"clear",value:function(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return this}},{key:"clone",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.writeDataToDom(),new this.constructor(Oe(this.node.cloneNode(t)))}},{key:"each",value:function(t,e){var n,r,i=this.children();for(n=0,r=i.length;n<r;n++)t.apply(i[n],[n,i]),e&&i[n].each(t,e);return this}},{key:"element",value:function(t,e){return this.put(new n(pe(t),e))}},{key:"first",value:function(){return ve(this.node.firstChild)}},{key:"get",value:function(t){return ve(this.node.childNodes[t])}},{key:"getEventHolder",value:function(){return this.node}},{key:"getEventTarget",value:function(){return this.node}},{key:"has",value:function(t){return this.index(t)>=0}},{key:"html",value:function(t,e){return this.xml(t,e,"http://www.w3.org/1999/xhtml")}},{key:"id",value:function(t){return void 0!==t||this.node.id||(this.node.id=we(this.type)),this.attr("id",t)}},{key:"index",value:function(t){return[].slice.call(this.node.childNodes).indexOf(t.node)}},{key:"last",value:function(){return ve(this.node.lastChild)}},{key:"matches",value:function(t){var e=this.node,n=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector||null;return n&&n.call(e,t)}},{key:"parent",value:function(t){var e=this;if(!e.node.parentNode)return null;if(e=ve(e.node.parentNode),!t)return e;do{if("string"==typeof t?e.matches(t):e instanceof t)return e}while(e=ve(e.node.parentNode));return e}},{key:"put",value:function(t,e){return t=ye(t),this.add(t,e),t}},{key:"putIn",value:function(t,e){return ye(t).add(this,e)}},{key:"remove",value:function(){return this.parent()&&this.parent().removeElement(this),this}},{key:"removeElement",value:function(t){return this.node.removeChild(t.node),this}},{key:"replace",value:function(t){return t=ye(t),this.node.parentNode&&this.node.parentNode.replaceChild(t.node,this.node),t}},{key:"round",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=Math.pow(10,t),r=this.attr(e);for(var i in r)"number"==typeof r[i]&&(r[i]=Math.round(r[i]*n)/n);return this.attr(r),this}},{key:"svg",value:function(t,e){return this.xml(t,e,ue)}},{key:"toString",value:function(){return this.id()}},{key:"words",value:function(t){return this.node.textContent=t,this}},{key:"wrap",value:function(t){var e=this.parent();if(!e)return this.addTo(t);var n=e.index(this);return e.put(t,n).put(this)}},{key:"writeDataToDom",value:function(){return this.each((function(){this.writeDataToDom()})),this}},{key:"xml",value:function(t,e,n){if("boolean"==typeof t&&(n=e,e=t,t=null),null==t||"function"==typeof t){e=null==e||e,this.writeDataToDom();var r=this;if(null!=t){if(r=ve(r.node.cloneNode(!0)),e){var i=t(r);if(r=i||r,!1===i)return""}r.each((function(){var e=t(this),n=e||this;!1===e?this.remove():e&&this!==n&&this.replace(n)}),!0)}return e?r.node.outerHTML:r.node.innerHTML}e=null!=e&&e;var o=pe("wrapper",n),u=le.document.createDocumentFragment();o.innerHTML=t;for(var a=o.children.length;a--;)u.appendChild(o.firstElementChild);var s=this.parent();return e?this.replace(u)&&s:this.add(u)}}]),n}(rn);xe(pn,{attr:function(t,e,n){var r=this;if(null==t){t={};var i,o=Ut(e=this.node.attributes);try{for(o.s();!(i=o.n()).done;){var u=i.value;t[u.nodeName]=Re.test(u.nodeValue)?parseFloat(u.nodeValue):u.nodeValue}}catch(t){o.e(t)}finally{o.f()}return t}if(t instanceof Array)return t.reduce((function(t,e){return t[e]=r.attr(e),t}),{});if("object"===Yt(t)&&t.constructor===Object)for(e in t)this.attr(e,t[e]);else if(null===e)this.node.removeAttribute(t);else{if(null==e)return null==(e=this.node.getAttribute(t))?ln[t]:Re.test(e)?parseFloat(e):e;"number"==typeof(e=hn.reduce((function(e,n){return n(t,e,r)}),e))?e=new fn(e):He.isColor(e)?e=new He(e):e.constructor===Array&&(e=new cn(e)),"leading"===t?this.leading&&this.leading(e):"string"==typeof n?this.node.setAttributeNS(n,t,e.toString()):this.node.setAttribute(t,e.toString()),!this.rebuild||"font-size"!==t&&"x"!==t||this.rebuild()}return this},find:function(t){return Ze(t,this.node)},findOne:function(t){return ve(this.node.querySelector(t))}}),me(pn,"Dom");var yn=function(t){Mt(n,t);var e=Ct(n);function n(t,r){var i;return zt(this,n),(i=e.call(this,t,r)).dom={},i.node.instance=Rt(i),t.hasAttribute("svgjs:data")&&i.setData(JSON.parse(t.getAttribute("svgjs:data"))||{}),i}return Ht(n,[{key:"center",value:function(t,e){return this.cx(t).cy(e)}},{key:"cx",value:function(t){return null==t?this.x()+this.width()/2:this.x(t-this.width()/2)}},{key:"cy",value:function(t){return null==t?this.y()+this.height()/2:this.y(t-this.height()/2)}},{key:"defs",value:function(){var t=this.root();return t&&t.defs()}},{key:"dmove",value:function(t,e){return this.dx(t).dy(e)}},{key:"dx",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.x(new fn(t).plus(this.x()))}},{key:"dy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.y(new fn(t).plus(this.y()))}},{key:"getEventHolder",value:function(){return this}},{key:"height",value:function(t){return this.attr("height",t)}},{key:"move",value:function(t,e){return this.x(t).y(e)}},{key:"parents",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.root(),e="string"==typeof t;e||(t=ye(t));for(var n=new We,r=this;(r=r.parent())&&r.node!==le.document&&"#document-fragment"!==r.nodeName&&(n.push(r),e||r.node!==t.node)&&(!e||!r.matches(t));)if(r.node===this.root().node)return null;return n}},{key:"reference",value:function(t){if(!(t=this.attr(t)))return null;var e=(t+"").match(Pe);return e?ye(e[1]):null}},{key:"root",value:function(){var t=this.parent(fe[he]);return t&&t.root()}},{key:"setData",value:function(t){return this.dom=t,this}},{key:"size",value:function(t,e){var n=ie(this,t,e);return this.width(new fn(n.width)).height(new fn(n.height))}},{key:"width",value:function(t){return this.attr("width",t)}},{key:"writeDataToDom",value:function(){return this.node.removeAttribute("svgjs:data"),Object.keys(this.dom).length&&this.node.setAttribute("svgjs:data",JSON.stringify(this.dom)),jt(It(n.prototype),"writeDataToDom",this).call(this)}},{key:"x",value:function(t){return this.attr("x",t)}},{key:"y",value:function(t){return this.attr("y",t)}}]),n}(pn);xe(yn,{bbox:function(){var t=Ve(this,(function(t){return t.getBBox()}),(function(t){try{var e=t.clone().addTo(Xe().svg).show(),n=e.node.getBBox();return e.remove(),n}catch(e){throw new Error('Getting bbox of element "'.concat(t.node.nodeName,'" is not possible: ').concat(e.toString()))}}));return new Ue(t)},rbox:function(t){var e=Ve(this,(function(t){return t.getBoundingClientRect()}),(function(t){throw new Error('Getting rbox of element "'.concat(t.node.nodeName,'" is not possible'))})),n=new Ue(e);return t?n.transform(t.screenCTM().inverseO()):n.addOffset()},inside:function(t,e){var n=this.bbox();return t>n.x&&e>n.y&&t<n.x+n.width&&e<n.y+n.height},point:function(t,e){return new qe(t,e).transform(this.screenCTM().inverse())},ctm:function(){return new Fe(this.node.getCTM())},screenCTM:function(){if("function"==typeof this.isRoot&&!this.isRoot()){var t=this.rect(1,1),e=t.node.getScreenCTM();return t.remove(),new Fe(e)}return new Fe(this.node.getScreenCTM())}}),me(yn,"Element");var dn={stroke:["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"],fill:["color","opacity","rule"],prefix:function(t,e){return"color"===e?t:t+"-"+e}};["fill","stroke"].forEach((function(t){var e,n={};n[t]=function(n){if(void 0===n)return this.attr(t);if("string"==typeof n||n instanceof He||He.isRgb(n)||n instanceof yn)this.attr(t,n);else for(e=dn[t].length-1;e>=0;e--)null!=n[dn[t][e]]&&this.attr(dn.prefix(t,dn[t][e]),n[dn[t][e]]);return this},Qt(["Element","Runner"],n)})),Qt(["Element","Runner"],{matrix:function(t,e,n,r,i,o){return null==t?new Fe(this):this.attr("transform",new Fe(t,e,n,r,i,o))},rotate:function(t,e,n){return this.transform({rotate:t,ox:e,oy:n},!0)},skew:function(t,e,n,r){return 1===arguments.length||3===arguments.length?this.transform({skew:t,ox:e,oy:n},!0):this.transform({skew:[t,e],ox:n,oy:r},!0)},shear:function(t,e,n){return this.transform({shear:t,ox:e,oy:n},!0)},scale:function(t,e,n,r){return 1===arguments.length||3===arguments.length?this.transform({scale:t,ox:e,oy:n},!0):this.transform({scale:[t,e],ox:n,oy:r},!0)},translate:function(t,e){return this.transform({translate:[t,e]},!0)},relative:function(t,e){return this.transform({relative:[t,e]},!0)},flip:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"both",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"center";return-1==="xybothtrue".indexOf(t)&&(e=t,t="both"),this.transform({flip:t,origin:e},!0)},opacity:function(t){return this.attr("opacity",t)}}),Qt("radius",{radius:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return"radialGradient"===(this._element||this).type?this.attr("r",new fn(t)):this.rx(t).ry(e)}}),Qt("Path",{length:function(){return this.node.getTotalLength()},pointAt:function(t){return new qe(this.node.getPointAtLength(t))}}),Qt(["Element","Runner"],{font:function(t,e){if("object"===Yt(t)){for(e in t)this.font(e,t[e]);return this}return"leading"===t?this.leading(e):"anchor"===t?this.attr("text-anchor",e):"size"===t||"family"===t||"weight"===t||"stretch"===t||"variant"===t||"style"===t?this.attr("font-"+t,e):this.attr(t,e)}}),Qt("Element",["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","mouseenter","mouseleave","touchstart","touchmove","touchleave","touchend","touchcancel"].reduce((function(t,e){return t[e]=function(t){return null===t?this.off(e):this.on(e,t),this},t}),{})),Qt("Element",{untransform:function(){return this.attr("transform",null)},matrixify:function(){return(this.attr("transform")||"").split(Ae).slice(0,-1).map((function(t){var e=t.trim().split("(");return[e[0],e[1].split(De).map((function(t){return parseFloat(t)}))]})).reverse().reduce((function(t,e){return"matrix"===e[0]?t.lmultiply(Fe.fromArray(e[1])):t[e[0]].apply(t,e[1])}),new Fe)},toParent:function(t,e){if(this===t)return this;var n=this.screenCTM(),r=t.screenCTM().inverse();return this.addTo(t,e).untransform().transform(r.multiply(n)),this},toRoot:function(t){return this.toParent(this.root(),t)},transform:function(t,e){if(null==t||"string"==typeof t){var n=new Fe(this).decompose();return null==t?n:n[t]}Fe.isMatrixLike(t)||(t=At(At({},t),{},{origin:oe(t,this)}));var r=new Fe(!0===e?this:e||!1).transform(t);return this.attr("transform",r)}});var vn=function(t){Mt(n,t);var e=Ct(n);function n(){return zt(this,n),e.apply(this,arguments)}return Ht(n,[{key:"flatten",value:function(){return this.each((function(){if(this instanceof n)return this.flatten().ungroup()})),this}},{key:"ungroup",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parent(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.index(this);return e=-1===e?t.children().length:e,this.each((function(n,r){return r[r.length-n-1].toParent(t,e)})),this.remove()}}]),n}(yn);me(vn,"Container");var bn=function(t){Mt(n,t);var e=Ct(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),e.call(this,de("defs",t),r)}return Ht(n,[{key:"flatten",value:function(){return this}},{key:"ungroup",value:function(){return this}}]),n}(vn);me(bn,"Defs");var mn=function(t){Mt(n,t);var e=Ct(n);function n(){return zt(this,n),e.apply(this,arguments)}return Ht(n)}(yn);function gn(t){return this.attr("rx",t)}function wn(t){return this.attr("ry",t)}function On(t){return null==t?this.cx()-this.rx():this.cx(t+this.rx())}function xn(t){return null==t?this.cy()-this.ry():this.cy(t+this.ry())}function Sn(t){return this.attr("cx",t)}function _n(t){return this.attr("cy",t)}function kn(t){return null==t?2*this.rx():this.rx(new fn(t).divide(2))}function jn(t){return null==t?2*this.ry():this.ry(new fn(t).divide(2))}me(mn,"Shape");var Pn={__proto__:null,rx:gn,ry:wn,x:On,y:xn,cx:Sn,cy:_n,width:kn,height:jn},An=function(t){Mt(n,t);var e=Ct(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),e.call(this,de("ellipse",t),r)}return Ht(n,[{key:"size",value:function(t,e){var n=ie(this,t,e);return this.rx(new fn(n.width).divide(2)).ry(new fn(n.height).divide(2))}}]),n}(mn);xe(An,Pn),Qt("Container",{ellipse:Se((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this.put(new An).size(t,e).move(0,0)}))}),me(An,"Ellipse");var En=function(t){Mt(n,t);var e=Ct(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le.document.createDocumentFragment();return zt(this,n),e.call(this,t)}return Ht(n,[{key:"xml",value:function(t,e,r){if("boolean"==typeof t&&(r=e,e=t,t=null),null==t||"function"==typeof t){var i=new pn(pe("wrapper",r));return i.add(this.node.cloneNode(!0)),i.xml(!1,r)}return jt(It(n.prototype),"xml",this).call(this,t,!1,r)}}]),n}(pn);function Mn(t,e){return"radialGradient"===(this._element||this).type?this.attr({fx:new fn(t),fy:new fn(e)}):this.attr({x1:new fn(t),y1:new fn(e)})}function Cn(t,e){return"radialGradient"===(this._element||this).type?this.attr({cx:new fn(t),cy:new fn(e)}):this.attr({x2:new fn(t),y2:new fn(e)})}me(En,"Fragment");var Tn={__proto__:null,from:Mn,to:Cn},Rn=function(t){Mt(n,t);var e=Ct(n);function n(t,r){return zt(this,n),e.call(this,de(t+"Gradient","string"==typeof t?null:t),r)}return Ht(n,[{key:"attr",value:function(t,e,r){return"transform"===t&&(t="gradientTransform"),jt(It(n.prototype),"attr",this).call(this,t,e,r)}},{key:"bbox",value:function(){return new Ue}},{key:"targets",value:function(){return Ze('svg [fill*="'+this.id()+'"]')}},{key:"toString",value:function(){return this.url()}},{key:"update",value:function(t){return this.clear(),"function"==typeof t&&t.call(this,this),this}},{key:"url",value:function(){return'url("#'+this.id()+'")'}}]),n}(vn);xe(Rn,Tn),Qt({Container:{gradient:function(){var t;return(t=this.defs()).gradient.apply(t,arguments)}},Defs:{gradient:Se((function(t,e){return this.put(new Rn(t)).update(e)}))}}),me(Rn,"Gradient");var Nn=function(t){Mt(n,t);var e=Ct(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),e.call(this,de("pattern",t),r)}return Ht(n,[{key:"attr",value:function(t,e,r){return"transform"===t&&(t="patternTransform"),jt(It(n.prototype),"attr",this).call(this,t,e,r)}},{key:"bbox",value:function(){return new Ue}},{key:"targets",value:function(){return Ze('svg [fill*="'+this.id()+'"]')}},{key:"toString",value:function(){return this.url()}},{key:"update",value:function(t){return this.clear(),"function"==typeof t&&t.call(this,this),this}},{key:"url",value:function(){return'url("#'+this.id()+'")'}}]),n}(vn);Qt({Container:{pattern:function(){var t;return(t=this.defs()).pattern.apply(t,arguments)}},Defs:{pattern:Se((function(t,e,n){return this.put(new Nn).update(n).attr({x:0,y:0,width:t,height:e,patternUnits:"userSpaceOnUse"})}))}}),me(Nn,"Pattern");var Dn,Gn=function(t){Mt(n,t);var e=Ct(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),e.call(this,de("image",t),r)}return Ht(n,[{key:"load",value:function(t,e){if(!t)return this;var n=new le.window.Image;return en(n,"load",(function(t){var r=this.parent(Nn);0===this.width()&&0===this.height()&&this.size(n.width,n.height),r instanceof Nn&&0===r.width()&&0===r.height()&&r.size(this.width(),this.height()),"function"==typeof e&&e.call(this,t)}),this),en(n,"load error",(function(){nn(n)})),this.attr("href",n.src=t,se)}}]),n}(mn);Dn=function(t,e,n){return"fill"!==t&&"stroke"!==t||Ne.test(e)&&(e=n.root().defs().image(e)),e instanceof Gn&&(e=n.root().defs().pattern(0,0,(function(t){t.add(e)}))),e},hn.push(Dn),Qt({Container:{image:Se((function(t,e){return this.put(new Gn).size(0,0).load(t,e)}))}}),me(Gn,"Image");var Ln=function(t){Mt(n,t);var e=Ct(n);function n(){return zt(this,n),e.apply(this,arguments)}return Ht(n,[{key:"bbox",value:function(){var t=-1/0,e=-1/0,n=1/0,r=1/0;return this.forEach((function(i){t=Math.max(i[0],t),e=Math.max(i[1],e),n=Math.min(i[0],n),r=Math.min(i[1],r)})),new Ue(n,r,t-n,e-r)}},{key:"move",value:function(t,e){var n=this.bbox();if(t-=n.x,e-=n.y,!isNaN(t)&&!isNaN(e))for(var r=this.length-1;r>=0;r--)this[r]=[this[r][0]+t,this[r][1]+e];return this}},{key:"parse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0],e=[];(t=t instanceof Array?Array.prototype.concat.apply([],t):t.trim().split(De).map(parseFloat)).length%2!=0&&t.pop();for(var n=0,r=t.length;n<r;n+=2)e.push([t[n],t[n+1]]);return e}},{key:"size",value:function(t,e){var n,r=this.bbox();for(n=this.length-1;n>=0;n--)r.width&&(this[n][0]=(this[n][0]-r.x)*t/r.width+r.x),r.height&&(this[n][1]=(this[n][1]-r.y)*e/r.height+r.y);return this}},{key:"toLine",value:function(){return{x1:this[0][0],y1:this[0][1],x2:this[1][0],y2:this[1][1]}}},{key:"toString",value:function(){for(var t=[],e=0,n=this.length;e<n;e++)t.push(this[e].join(","));return t.join(" ")}},{key:"transform",value:function(t){return this.clone().transformO(t)}},{key:"transformO",value:function(t){Fe.isMatrixLike(t)||(t=new Fe(t));for(var e=this.length;e--;){var n=Ft(this[e],2),r=n[0],i=n[1];this[e][0]=t.a*r+t.c*i+t.e,this[e][1]=t.b*r+t.d*i+t.f}return this}}]),n}(cn),In={__proto__:null,MorphArray:Ln,x:function(t){return null==t?this.bbox().x:this.move(t,this.bbox().y)},y:function(t){return null==t?this.bbox().y:this.move(this.bbox().x,t)},width:function(t){var e=this.bbox();return null==t?e.width:this.size(t,e.height)},height:function(t){var e=this.bbox();return null==t?e.height:this.size(e.width,t)}},Bn=function(t){Mt(n,t);var e=Ct(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),e.call(this,de("line",t),r)}return Ht(n,[{key:"array",value:function(){return new Ln([[this.attr("x1"),this.attr("y1")],[this.attr("x2"),this.attr("y2")]])}},{key:"move",value:function(t,e){return this.attr(this.array().move(t,e).toLine())}},{key:"plot",value:function(t,e,n,r){return null==t?this.array():(t=void 0!==e?{x1:t,y1:e,x2:n,y2:r}:new Ln(t).toLine(),this.attr(t))}},{key:"size",value:function(t,e){var n=ie(this,t,e);return this.attr(this.array().size(n.width,n.height).toLine())}}]),n}(mn);xe(Bn,In),Qt({Container:{line:Se((function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Bn.prototype.plot.apply(this.put(new Bn),null!=e[0]?e:[0,0,0,0])}))}}),me(Bn,"Line");var Hn=function(t){Mt(n,t);var e=Ct(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),e.call(this,de("marker",t),r)}return Ht(n,[{key:"height",value:function(t){return this.attr("markerHeight",t)}},{key:"orient",value:function(t){return this.attr("orient",t)}},{key:"ref",value:function(t,e){return this.attr("refX",t).attr("refY",e)}},{key:"toString",value:function(){return"url(#"+this.id()+")"}},{key:"update",value:function(t){return this.clear(),"function"==typeof t&&t.call(this,this),this}},{key:"width",value:function(t){return this.attr("markerWidth",t)}}]),n}(vn);function qn(t,e){return function(n){return null==n?this[t]:(this[t]=n,e&&e.call(this),this)}}Qt({Container:{marker:function(){var t;return(t=this.defs()).marker.apply(t,arguments)}},Defs:{marker:Se((function(t,e,n){return this.put(new Hn).size(t,e).ref(t/2,e/2).viewbox(0,0,t,e).attr("orient","auto").update(n)}))},marker:{marker:function(t,e,n,r){var i=["marker"];return"all"!==t&&i.push(t),i=i.join("-"),t=arguments[1]instanceof Hn?arguments[1]:this.defs().marker(e,n,r),this.attr(i,t)}}}),me(Hn,"Marker");var zn={"-":function(t){return t},"<>":function(t){return-Math.cos(t*Math.PI)/2+.5},">":function(t){return Math.sin(t*Math.PI/2)},"<":function(t){return 1-Math.cos(t*Math.PI/2)},bezier:function(t,e,n,r){return function(i){return i<0?t>0?e/t*i:n>0?r/n*i:0:i>1?n<1?(1-r)/(1-n)*i+(r-n)/(1-n):t<1?(1-e)/(1-t)*i+(e-t)/(1-t):1:3*i*Math.pow(1-i,2)*e+3*Math.pow(i,2)*(1-i)*r+Math.pow(i,3)}},steps:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"end";e=e.split("-").reverse()[0];var n=t;return"none"===e?--n:"both"===e&&++n,function(r){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=Math.floor(r*t),u=r*o%1==0;return"start"!==e&&"both"!==e||++o,i&&u&&--o,r>=0&&o<0&&(o=0),r<=1&&o>n&&(o=n),o/n}}},Fn=function(){function t(){zt(this,t)}return Ht(t,[{key:"done",value:function(){return!1}}]),t}(),Xn=function(t){Mt(n,t);var e=Ct(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:an;return zt(this,n),(t=e.call(this)).ease=zn[r]||r,t}return Ht(n,[{key:"step",value:function(t,e,n){return"number"!=typeof t?n<1?t:e:t+(e-t)*this.ease(n)}}]),n}(Fn),Yn=function(t){Mt(n,t);var e=Ct(n);function n(t){var r;return zt(this,n),(r=e.call(this)).stepper=t,r}return Ht(n,[{key:"done",value:function(t){return t.done}},{key:"step",value:function(t,e,n,r){return this.stepper(t,e,n,r)}}]),n}(Fn);function Un(){var t=(this._duration||500)/1e3,e=this._overshoot||0,n=Math.PI,r=Math.log(e/100+1e-10),i=-r/Math.sqrt(n*n+r*r),o=3.9/(i*t);this.d=2*i*o,this.k=o*o}xe(function(t){Mt(n,t);var e=Ct(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return zt(this,n),(t=e.call(this)).duration(r).overshoot(i),t}return Ht(n,[{key:"step",value:function(t,e,n,r){if("string"==typeof t)return t;if(r.done=n===1/0,n===1/0)return e;if(0===n)return t;n>100&&(n=16),n/=1e3;var i=r.velocity||0,o=-this.d*i-this.k*(t-e),u=t+i*n+o*n*n/2;return r.velocity=i+o*n,r.done=Math.abs(e-u)+Math.abs(i)<.002,r.done?e:u}}]),n}(Yn),{duration:qn("_duration",Un),overshoot:qn("_overshoot",Un)});var Vn=function(t){Mt(n,t);var e=Ct(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.01,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e3;return zt(this,n),(t=e.call(this)).p(r).i(i).d(o).windup(u),t}return Ht(n,[{key:"step",value:function(t,e,n,r){if("string"==typeof t)return t;if(r.done=n===1/0,n===1/0)return e;if(0===n)return t;var i=e-t,o=(r.integral||0)+i*n,u=(i-(r.error||0))/n,a=this._windup;return!1!==a&&(o=Math.max(-a,Math.min(o,a))),r.error=i,r.integral=o,r.done=Math.abs(i)<.001,r.done?e:t+(this.P*i+this.I*o+this.D*u)}}]),n}(Yn);xe(Vn,{windup:qn("_windup"),p:qn("P"),i:qn("I"),d:qn("D")});for(var Wn={M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7,Z:0},$n={M:function(t,e,n){return e.x=n.x=t[0],e.y=n.y=t[1],["M",e.x,e.y]},L:function(t,e){return e.x=t[0],e.y=t[1],["L",t[0],t[1]]},H:function(t,e){return e.x=t[0],["H",t[0]]},V:function(t,e){return e.y=t[0],["V",t[0]]},C:function(t,e){return e.x=t[4],e.y=t[5],["C",t[0],t[1],t[2],t[3],t[4],t[5]]},S:function(t,e){return e.x=t[2],e.y=t[3],["S",t[0],t[1],t[2],t[3]]},Q:function(t,e){return e.x=t[2],e.y=t[3],["Q",t[0],t[1],t[2],t[3]]},T:function(t,e){return e.x=t[0],e.y=t[1],["T",t[0],t[1]]},Z:function(t,e,n){return e.x=n.x,e.y=n.y,["Z"]},A:function(t,e){return e.x=t[5],e.y=t[6],["A",t[0],t[1],t[2],t[3],t[4],t[5],t[6]]}},Zn="mlhvqtcsaz".split(""),Qn=0,Jn=Zn.length;Qn<Jn;++Qn)$n[Zn[Qn]]=function(t){return function(e,n,r){if("H"===t)e[0]=e[0]+n.x;else if("V"===t)e[0]=e[0]+n.y;else if("A"===t)e[5]=e[5]+n.x,e[6]=e[6]+n.y;else for(var i=0,o=e.length;i<o;++i)e[i]=e[i]+(i%2?n.y:n.x);return $n[t](e,n,r)}}(Zn[Qn].toUpperCase());function Kn(t){return t.segment.length&&t.segment.length-1===Wn[t.segment[0].toUpperCase()]}function tr(t,e){t.inNumber&&er(t,!1);var n=Ge.test(e);if(n)t.segment=[e];else{var r=t.lastCommand,i=r.toLowerCase(),o=r===i;t.segment=["m"===i?o?"l":"L":r]}return t.inSegment=!0,t.lastCommand=t.segment[0],n}function er(t,e){if(!t.inNumber)throw new Error("Parser Error");t.number&&t.segment.push(parseFloat(t.number)),t.inNumber=e,t.number="",t.pointSeen=!1,t.hasExponent=!1,Kn(t)&&nr(t)}function nr(t){t.inSegment=!1,t.absolute&&(t.segment=function(t){var e=t.segment[0];return $n[e](t.segment.slice(1),t.p,t.p0)}(t)),t.segments.push(t.segment)}function rr(t){if(!t.segment.length)return!1;var e="A"===t.segment[0].toUpperCase(),n=t.segment.length;return e&&(4===n||5===n)}function ir(t){return"E"===t.lastToken.toUpperCase()}var or=function(t){Mt(n,t);var e=Ct(n);function n(){return zt(this,n),e.apply(this,arguments)}return Ht(n,[{key:"bbox",value:function(){return Xe().path.setAttribute("d",this.toString()),new Ue(Xe.nodes.path.getBBox())}},{key:"move",value:function(t,e){var n=this.bbox();if(t-=n.x,e-=n.y,!isNaN(t)&&!isNaN(e))for(var r,i=this.length-1;i>=0;i--)"M"===(r=this[i][0])||"L"===r||"T"===r?(this[i][1]+=t,this[i][2]+=e):"H"===r?this[i][1]+=t:"V"===r?this[i][1]+=e:"C"===r||"S"===r||"Q"===r?(this[i][1]+=t,this[i][2]+=e,this[i][3]+=t,this[i][4]+=e,"C"===r&&(this[i][5]+=t,this[i][6]+=e)):"A"===r&&(this[i][6]+=t,this[i][7]+=e);return this}},{key:"parse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"M0 0";return Array.isArray(t)&&(t=Array.prototype.concat.apply([],t).toString()),function(t){for(var e=0,n="",r={segment:[],inNumber:!1,number:"",lastToken:"",inSegment:!1,segments:[],pointSeen:!1,hasExponent:!1,absolute:!(arguments.length>1&&void 0!==arguments[1])||arguments[1],p0:new qe,p:new qe};r.lastToken=n,n=t.charAt(e++);)if(r.inSegment||!tr(r,n))if("."!==n)if(isNaN(parseInt(n)))if(" "!==n&&","!==n)if("-"!==n)if("E"!==n.toUpperCase()){if(Ge.test(n)){if(r.inNumber)er(r,!1);else{if(!Kn(r))throw new Error("parser Error");nr(r)}--e}}else r.number+=n,r.hasExponent=!0;else{if(r.inNumber&&!ir(r)){er(r,!1),--e;continue}r.number+=n,r.inNumber=!0}else r.inNumber&&er(r,!1);else{if("0"===r.number||rr(r)){r.inNumber=!0,r.number=n,er(r,!0);continue}r.inNumber=!0,r.number+=n}else{if(r.pointSeen||r.hasExponent){er(r,!1),--e;continue}r.inNumber=!0,r.pointSeen=!0,r.number+=n}return r.inNumber&&er(r,!1),r.inSegment&&Kn(r)&&nr(r),r.segments}(t)}},{key:"size",value:function(t,e){var n,r,i=this.bbox();for(i.width=0===i.width?1:i.width,i.height=0===i.height?1:i.height,n=this.length-1;n>=0;n--)"M"===(r=this[n][0])||"L"===r||"T"===r?(this[n][1]=(this[n][1]-i.x)*t/i.width+i.x,this[n][2]=(this[n][2]-i.y)*e/i.height+i.y):"H"===r?this[n][1]=(this[n][1]-i.x)*t/i.width+i.x:"V"===r?this[n][1]=(this[n][1]-i.y)*e/i.height+i.y:"C"===r||"S"===r||"Q"===r?(this[n][1]=(this[n][1]-i.x)*t/i.width+i.x,this[n][2]=(this[n][2]-i.y)*e/i.height+i.y,this[n][3]=(this[n][3]-i.x)*t/i.width+i.x,this[n][4]=(this[n][4]-i.y)*e/i.height+i.y,"C"===r&&(this[n][5]=(this[n][5]-i.x)*t/i.width+i.x,this[n][6]=(this[n][6]-i.y)*e/i.height+i.y)):"A"===r&&(this[n][1]=this[n][1]*t/i.width,this[n][2]=this[n][2]*e/i.height,this[n][6]=(this[n][6]-i.x)*t/i.width+i.x,this[n][7]=(this[n][7]-i.y)*e/i.height+i.y);return this}},{key:"toString",value:function(){return function(t){for(var e="",n=0,r=t.length;n<r;n++)e+=t[n][0],null!=t[n][1]&&(e+=t[n][1],null!=t[n][2]&&(e+=" ",e+=t[n][2],null!=t[n][3]&&(e+=" ",e+=t[n][3],e+=" ",e+=t[n][4],null!=t[n][5]&&(e+=" ",e+=t[n][5],e+=" ",e+=t[n][6],null!=t[n][7]&&(e+=" ",e+=t[n][7])))));return e+" "}(this)}}]),n}(cn),ur=function(t){var e=Yt(t);return"number"===e?fn:"string"===e?He.isColor(t)?He:De.test(t)?Ge.test(t)?or:cn:_e.test(t)?fn:sr:hr.indexOf(t.constructor)>-1?t.constructor:Array.isArray(t)?cn:"object"===e?fr:sr},ar=function(){function t(e){zt(this,t),this._stepper=e||new Xn("-"),this._from=null,this._to=null,this._type=null,this._context=null,this._morphObj=null}return Ht(t,[{key:"at",value:function(t){return this._morphObj.morph(this._from,this._to,t,this._stepper,this._context)}},{key:"done",value:function(){return this._context.map(this._stepper.done).reduce((function(t,e){return t&&e}),!0)}},{key:"from",value:function(t){return null==t?this._from:(this._from=this._set(t),this)}},{key:"stepper",value:function(t){return null==t?this._stepper:(this._stepper=t,this)}},{key:"to",value:function(t){return null==t?this._to:(this._to=this._set(t),this)}},{key:"type",value:function(t){return null==t?this._type:(this._type=t,this)}},{key:"_set",value:function(t){this._type||this.type(ur(t));var e=new this._type(t);return this._type===He&&(e=this._to?e[this._to[4]]():this._from?e[this._from[4]]():e),this._type===fr&&(e=this._to?e.align(this._to):this._from?e.align(this._from):e),e=e.toConsumable(),this._morphObj=this._morphObj||new this._type,this._context=this._context||Array.apply(null,Array(e.length)).map(Object).map((function(t){return t.done=!0,t})),e}}]),t}(),sr=function(){function t(){zt(this,t),this.init.apply(this,arguments)}return Ht(t,[{key:"init",value:function(t){return t=Array.isArray(t)?t[0]:t,this.value=t,this}},{key:"toArray",value:function(){return[this.value]}},{key:"valueOf",value:function(){return this.value}}]),t}(),lr=function(){function t(){zt(this,t),this.init.apply(this,arguments)}return Ht(t,[{key:"init",value:function(e){return Array.isArray(e)&&(e={scaleX:e[0],scaleY:e[1],shear:e[2],rotate:e[3],translateX:e[4],translateY:e[5],originX:e[6],originY:e[7]}),Object.assign(this,t.defaults,e),this}},{key:"toArray",value:function(){var t=this;return[t.scaleX,t.scaleY,t.shear,t.rotate,t.translateX,t.translateY,t.originX,t.originY]}}]),t}();lr.defaults={scaleX:1,scaleY:1,shear:0,rotate:0,translateX:0,translateY:0,originX:0,originY:0};var cr=function(t,e){return t[0]<e[0]?-1:t[0]>e[0]?1:0},fr=function(){function t(){zt(this,t),this.init.apply(this,arguments)}return Ht(t,[{key:"align",value:function(t){for(var e=this.values,n=0,r=e.length;n<r;++n)if(e[n+1]!==t[n+1]){if(!t[n+1])return this;var i=(new t[n+1]).toArray(),o=e[n+2]+3;e.splice.apply(e,[n,o,t[n],t[n+1],t[n+2]].concat(Xt(i))),n+=e[n+2]+2}else{if(e[n+1]===He&&t[n+7]!==e[n+7]){var u,a=t[n+7],s=new He(this.values.splice(n+3,5))[a]().toArray();(u=this.values).splice.apply(u,[n+3,0].concat(Xt(s)))}n+=e[n+2]+2}return this}},{key:"init",value:function(t){if(this.values=[],!Array.isArray(t)){t=t||{};var e=[];for(var n in t){var r=ur(t[n]),i=new r(t[n]).toArray();e.push([n,r,i.length].concat(Xt(i)))}return e.sort(cr),this.values=e.reduce((function(t,e){return t.concat(e)}),[]),this}this.values=t.slice()}},{key:"toArray",value:function(){return this.values}},{key:"valueOf",value:function(){for(var t={},e=this.values;e.length;){var n=e.shift(),r=e.shift(),i=e.shift(),o=e.splice(0,i);t[n]=new r(o)}return t}}]),t}(),hr=[sr,lr,fr],pr=function(t){Mt(n,t);var e=Ct(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),e.call(this,de("path",t),r)}return Ht(n,[{key:"array",value:function(){return this._array||(this._array=new or(this.attr("d")))}},{key:"clear",value:function(){return delete this._array,this}},{key:"height",value:function(t){return null==t?this.bbox().height:this.size(this.bbox().width,t)}},{key:"move",value:function(t,e){return this.attr("d",this.array().move(t,e))}},{key:"plot",value:function(t){return null==t?this.array():this.clear().attr("d","string"==typeof t?t:this._array=new or(t))}},{key:"size",value:function(t,e){var n=ie(this,t,e);return this.attr("d",this.array().size(n.width,n.height))}},{key:"width",value:function(t){return null==t?this.bbox().width:this.size(t,this.bbox().height)}},{key:"x",value:function(t){return null==t?this.bbox().x:this.move(t,this.bbox().y)}},{key:"y",value:function(t){return null==t?this.bbox().y:this.move(this.bbox().x,t)}}]),n}(mn);pr.prototype.MorphArray=or,Qt({Container:{path:Se((function(t){return this.put(new pr).plot(t||new or)}))}}),me(pr,"Path");var yr={__proto__:null,array:function(){return this._array||(this._array=new Ln(this.attr("points")))},clear:function(){return delete this._array,this},move:function(t,e){return this.attr("points",this.array().move(t,e))},plot:function(t){return null==t?this.array():this.clear().attr("points","string"==typeof t?t:this._array=new Ln(t))},size:function(t,e){var n=ie(this,t,e);return this.attr("points",this.array().size(n.width,n.height))}},dr=function(t){Mt(n,t);var e=Ct(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),e.call(this,de("polygon",t),r)}return Ht(n)}(mn);Qt({Container:{polygon:Se((function(t){return this.put(new dr).plot(t||new Ln)}))}}),xe(dr,In),xe(dr,yr),me(dr,"Polygon");var vr=function(t){Mt(n,t);var e=Ct(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),e.call(this,de("polyline",t),r)}return Ht(n)}(mn);Qt({Container:{polyline:Se((function(t){return this.put(new vr).plot(t||new Ln)}))}}),xe(vr,In),xe(vr,yr),me(vr,"Polyline");var br=function(t){Mt(n,t);var e=Ct(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),e.call(this,de("rect",t),r)}return Ht(n)}(mn);xe(br,{rx:gn,ry:wn}),Qt({Container:{rect:Se((function(t,e){return this.put(new br).size(t,e)}))}}),me(br,"Rect");var mr=function(){function t(){zt(this,t),this._first=null,this._last=null}return Ht(t,[{key:"first",value:function(){return this._first&&this._first.value}},{key:"last",value:function(){return this._last&&this._last.value}},{key:"push",value:function(t){var e=void 0!==t.next?t:{value:t,next:null,prev:null};return this._last?(e.prev=this._last,this._last.next=e,this._last=e):(this._last=e,this._first=e),e}},{key:"remove",value:function(t){t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t===this._last&&(this._last=t.prev),t===this._first&&(this._first=t.next),t.prev=null,t.next=null}},{key:"shift",value:function(){var t=this._first;return t?(this._first=t.next,this._first&&(this._first.prev=null),this._last=this._first?this._last:null,t.value):null}}]),t}(),gr={nextDraw:null,frames:new mr,timeouts:new mr,immediates:new mr,timer:function(){return le.window.performance||le.window.Date},transforms:[],frame:function(t){var e=gr.frames.push({run:t});return null===gr.nextDraw&&(gr.nextDraw=le.window.requestAnimationFrame(gr._draw)),e},timeout:function(t,e){e=e||0;var n=gr.timer().now()+e,r=gr.timeouts.push({run:t,time:n});return null===gr.nextDraw&&(gr.nextDraw=le.window.requestAnimationFrame(gr._draw)),r},immediate:function(t){var e=gr.immediates.push(t);return null===gr.nextDraw&&(gr.nextDraw=le.window.requestAnimationFrame(gr._draw)),e},cancelFrame:function(t){null!=t&&gr.frames.remove(t)},clearTimeout:function(t){null!=t&&gr.timeouts.remove(t)},cancelImmediate:function(t){null!=t&&gr.immediates.remove(t)},_draw:function(t){for(var e=null,n=gr.timeouts.last();(e=gr.timeouts.shift())&&(t>=e.time?e.run():gr.timeouts.push(e),e!==n););for(var r=null,i=gr.frames.last();r!==i&&(r=gr.frames.shift());)r.run(t);for(var o=null;o=gr.immediates.shift();)o();gr.nextDraw=gr.timeouts.first()||gr.frames.first()?le.window.requestAnimationFrame(gr._draw):null}},wr=function(t){var e=t.start,n=t.runner.duration();return{start:e,duration:n,end:e+n,runner:t.runner}},Or=function(){var t=le.window;return(t.performance||t.Date).now()},xr=function(t){Mt(n,t);var e=Ct(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Or;return zt(this,n),(t=e.call(this))._timeSource=r,t._startTime=0,t._speed=1,t._persist=0,t._nextFrame=null,t._paused=!0,t._runners=[],t._runnerIds=[],t._lastRunnerId=-1,t._time=0,t._lastSourceTime=0,t._lastStepTime=0,t._step=t._stepFn.bind(Rt(t),!1),t._stepImmediate=t._stepFn.bind(Rt(t),!0),t}return Ht(n,[{key:"active",value:function(){return!!this._nextFrame}},{key:"finish",value:function(){return this.time(this.getEndTimeOfTimeline()+1),this.pause()}},{key:"getEndTime",value:function(){var t=this.getLastRunnerInfo(),e=t?t.runner.duration():0;return(t?t.start:this._time)+e}},{key:"getEndTimeOfTimeline",value:function(){var t=this._runners.map((function(t){return t.start+t.runner.duration()}));return Math.max.apply(Math,[0].concat(Xt(t)))}},{key:"getLastRunnerInfo",value:function(){return this.getRunnerInfoById(this._lastRunnerId)}},{key:"getRunnerInfoById",value:function(t){return this._runners[this._runnerIds.indexOf(t)]||null}},{key:"pause",value:function(){return this._paused=!0,this._continue()}},{key:"persist",value:function(t){return null==t?this._persist:(this._persist=t,this)}},{key:"play",value:function(){return this._paused=!1,this.updateTime()._continue()}},{key:"reverse",value:function(t){var e=this.speed();if(null==t)return this.speed(-e);var n=Math.abs(e);return this.speed(t?-n:n)}},{key:"schedule",value:function(t,e,n){if(null==t)return this._runners.map(wr);var r=0,i=this.getEndTime();if(e=e||0,null==n||"last"===n||"after"===n)r=i;else if("absolute"===n||"start"===n)r=e,e=0;else if("now"===n)r=this._time;else if("relative"===n){var o=this.getRunnerInfoById(t.id);o&&(r=o.start+e,e=0)}else{if("with-last"!==n)throw new Error('Invalid value for the "when" parameter');var u=this.getLastRunnerInfo();r=u?u.start:this._time}t.unschedule(),t.timeline(this);var a=t.persist(),s={persist:null===a?this._persist:a,start:r+e,runner:t};return this._lastRunnerId=t.id,this._runners.push(s),this._runners.sort((function(t,e){return t.start-e.start})),this._runnerIds=this._runners.map((function(t){return t.runner.id})),this.updateTime()._continue(),this}},{key:"seek",value:function(t){return this.time(this._time+t)}},{key:"source",value:function(t){return null==t?this._timeSource:(this._timeSource=t,this)}},{key:"speed",value:function(t){return null==t?this._speed:(this._speed=t,this)}},{key:"stop",value:function(){return this.time(0),this.pause()}},{key:"time",value:function(t){return null==t?this._time:(this._time=t,this._continue(!0))}},{key:"unschedule",value:function(t){var e=this._runnerIds.indexOf(t.id);return e<0||(this._runners.splice(e,1),this._runnerIds.splice(e,1),t.timeline(null)),this}},{key:"updateTime",value:function(){return this.active()||(this._lastSourceTime=this._timeSource()),this}},{key:"_continue",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return gr.cancelFrame(this._nextFrame),this._nextFrame=null,t?this._stepImmediate():(this._paused||(this._nextFrame=gr.frame(this._step)),this)}},{key:"_stepFn",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this._timeSource(),n=e-this._lastSourceTime;t&&(n=0);var r=this._speed*n+(this._time-this._lastStepTime);this._lastSourceTime=e,t||(this._time+=r,this._time=this._time<0?0:this._time),this._lastStepTime=this._time,this.fire("time",this._time);for(var i=this._runners.length;i--;){var o=this._runners[i],u=o.runner;this._time-o.start<=0&&u.reset()}for(var a=!1,s=0,l=this._runners.length;s<l;s++){var c=this._runners[s],f=c.runner,h=r,p=this._time-c.start;p<=0?a=!0:(p<h&&(h=p),f.active()&&(f.step(h).done?!0!==c.persist&&f.duration()-f.time()+this._time+c.persist<this._time&&(f.unschedule(),--s,--l):a=!0))}return a&&!(this._speed<0&&0===this._time)||this._runnerIds.length&&this._speed<0&&this._time>0?this._continue():(this.pause(),this.fire("finished")),this}}]),n}(rn);Qt({Element:{timeline:function(t){return null==t?(this._timeline=this._timeline||new xr,this._timeline):(this._timeline=t,this)}}});var Sr=function(t){Mt(n,t);var e=Ct(n);function n(t){var r;return zt(this,n),(r=e.call(this)).id=n.id++,t="function"==typeof(t=null==t?un:t)?new Yn(t):t,r._element=null,r._timeline=null,r.done=!1,r._queue=[],r._duration="number"==typeof t&&t,r._isDeclarative=t instanceof Yn,r._stepper=r._isDeclarative?t:new Xn,r._history={},r.enabled=!0,r._time=0,r._lastTime=0,r._reseted=!0,r.transforms=new Fe,r.transformId=1,r._haveReversed=!1,r._reverse=!1,r._loopsDone=0,r._swing=!1,r._wait=0,r._times=1,r._frameId=null,r._persist=!!r._isDeclarative||null,r}return Ht(n,[{key:"active",value:function(t){return null==t?this.enabled:(this.enabled=t,this)}},{key:"addTransform",value:function(t,e){return this.transforms.lmultiplyO(t),this}},{key:"after",value:function(t){return this.on("finished",t)}},{key:"animate",value:function(t,e,r){var i=n.sanitise(t,e,r),o=new n(i.duration);return this._timeline&&o.timeline(this._timeline),this._element&&o.element(this._element),o.loop(i).schedule(i.delay,i.when)}},{key:"clearTransform",value:function(){return this.transforms=new Fe,this}},{key:"clearTransformsFromQueue",value:function(){this.done&&this._timeline&&this._timeline._runnerIds.includes(this.id)||(this._queue=this._queue.filter((function(t){return!t.isTransform})))}},{key:"delay",value:function(t){return this.animate(0,t)}},{key:"duration",value:function(){return this._times*(this._wait+this._duration)-this._wait}},{key:"during",value:function(t){return this.queue(null,t)}},{key:"ease",value:function(t){return this._stepper=new Xn(t),this}},{key:"element",value:function(t){return null==t?this._element:(this._element=t,t._prepareRunner(),this)}},{key:"finish",value:function(){return this.step(1/0)}},{key:"loop",value:function(t,e,n){return"object"===Yt(t)&&(e=t.swing,n=t.wait,t=t.times),this._times=t||1/0,this._swing=e||!1,this._wait=n||0,!0===this._times&&(this._times=1/0),this}},{key:"loops",value:function(t){var e=this._duration+this._wait;if(null==t){var n=Math.floor(this._time/e),r=(this._time-n*e)/this._duration;return Math.min(n+r,this._times)}var i=t%1,o=e*Math.floor(t)+this._duration*i;return this.time(o)}},{key:"persist",value:function(t){return null==t?this._persist:(this._persist=t,this)}},{key:"position",value:function(t){var e,n=this._time,r=this._duration,i=this._wait,o=this._times,u=this._swing,a=this._reverse;if(null==t){var s=function(t){var e=u*Math.floor(t%(2*(i+r))/(i+r)),n=e&&!a||!e&&a,o=Math.pow(-1,n)*(t%(i+r))/r+n;return Math.max(Math.min(o,1),0)},l=o*(i+r)-i;return e=n<=0?Math.round(s(1e-5)):n<l?s(n):Math.round(s(l-1e-5))}var c=Math.floor(this.loops()),f=u&&c%2==0;return e=c+(f&&!a||a&&f?t:1-t),this.loops(e)}},{key:"progress",value:function(t){return null==t?Math.min(1,this._time/this.duration()):this.time(t*this.duration())}},{key:"queue",value:function(t,e,n,r){return this._queue.push({initialiser:t||on,runner:e||on,retarget:n,isTransform:r,initialised:!1,finished:!1}),this.timeline()&&this.timeline()._continue(),this}},{key:"reset",value:function(){return this._reseted||(this.time(0),this._reseted=!0),this}},{key:"reverse",value:function(t){return this._reverse=null==t?!this._reverse:t,this}},{key:"schedule",value:function(t,e,n){if(t instanceof xr||(n=e,e=t,t=this.timeline()),!t)throw Error("Runner cannot be scheduled without timeline");return t.schedule(this,e,n),this}},{key:"step",value:function(t){if(!this.enabled)return this;t=null==t?16:t,this._time+=t;var e=this.position(),n=this._lastPosition!==e&&this._time>=0;this._lastPosition=e;var r=this.duration(),i=this._lastTime<=0&&this._time>0,o=this._lastTime<r&&this._time>=r;this._lastTime=this._time,i&&this.fire("start",this);var u=this._isDeclarative;this.done=!u&&!o&&this._time>=r,this._reseted=!1;var a=!1;return(n||u)&&(this._initialise(n),this.transforms=new Fe,a=this._run(u?t:e),this.fire("step",this)),this.done=this.done||a&&u,o&&this.fire("finished",this),this}},{key:"time",value:function(t){if(null==t)return this._time;var e=t-this._time;return this.step(e),this}},{key:"timeline",value:function(t){return void 0===t?this._timeline:(this._timeline=t,this)}},{key:"unschedule",value:function(){var t=this.timeline();return t&&t.unschedule(this),this}},{key:"_initialise",value:function(t){if(t||this._isDeclarative)for(var e=0,n=this._queue.length;e<n;++e){var r=this._queue[e],i=this._isDeclarative||!r.initialised&&t;t=!r.finished,i&&t&&(r.initialiser.call(this),r.initialised=!0)}}},{key:"_rememberMorpher",value:function(t,e){if(this._history[t]={morpher:e,caller:this._queue[this._queue.length-1]},this._isDeclarative){var n=this.timeline();n&&n.play()}}},{key:"_run",value:function(t){for(var e=!0,n=0,r=this._queue.length;n<r;++n){var i=this._queue[n],o=i.runner.call(this,t);i.finished=i.finished||!0===o,e=e&&i.finished}return e}},{key:"_tryRetarget",value:function(t,e,n){if(this._history[t]){if(!this._history[t].caller.initialised){var r=this._queue.indexOf(this._history[t].caller);return this._queue.splice(r,1),!1}this._history[t].caller.retarget?this._history[t].caller.retarget.call(this,e,n):this._history[t].morpher.to(e),this._history[t].caller.finished=!1;var i=this.timeline();return i&&i.play(),!0}return!1}}],[{key:"sanitise",value:function(t,e,n){var r=1,i=!1,o=0;return e=e||sn,n=n||"last","object"!==Yt(t=t||un)||t instanceof Fn||(e=t.delay||e,n=t.when||n,i=t.swing||i,r=t.times||r,o=t.wait||o,t=t.duration||un),{duration:t,delay:e,swing:i,times:r,wait:o,when:n}}}]),n}(rn);Sr.id=0;var _r=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Fe,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];zt(this,t),this.transforms=e,this.id=n,this.done=r}return Ht(t,[{key:"clearTransformsFromQueue",value:function(){}}]),t}();xe([Sr,_r],{mergeWith:function(t){return new _r(t.transforms.lmultiply(this.transforms),t.id)}});var kr=function(t,e){return t.lmultiplyO(e)},jr=function(t){return t.transforms};function Pr(){var t=this._transformationRunners.runners.map(jr).reduce(kr,new Fe);this.transform(t),this._transformationRunners.merge(),1===this._transformationRunners.length()&&(this._frameId=null)}var Ar=function(){function t(){zt(this,t),this.runners=[],this.ids=[]}return Ht(t,[{key:"add",value:function(t){if(!this.runners.includes(t)){var e=t.id+1;return this.runners.push(t),this.ids.push(e),this}}},{key:"clearBefore",value:function(t){var e=this.ids.indexOf(t+1)||1;return this.ids.splice(0,e,0),this.runners.splice(0,e,new _r).forEach((function(t){return t.clearTransformsFromQueue()})),this}},{key:"edit",value:function(t,e){var n=this.ids.indexOf(t+1);return this.ids.splice(n,1,t+1),this.runners.splice(n,1,e),this}},{key:"getByID",value:function(t){return this.runners[this.ids.indexOf(t+1)]}},{key:"length",value:function(){return this.ids.length}},{key:"merge",value:function(){for(var t=null,e=0;e<this.runners.length;++e){var n=this.runners[e];if(!(t&&n.done&&t.done)||n._timeline&&n._timeline._runnerIds.includes(n.id)||t._timeline&&t._timeline._runnerIds.includes(t.id))t=n;else{this.remove(n.id);var r=n.mergeWith(t);this.edit(t.id,r),t=r,--e}}return this}},{key:"remove",value:function(t){var e=this.ids.indexOf(t+1);return this.ids.splice(e,1),this.runners.splice(e,1),this}}]),t}();Qt({Element:{animate:function(t,e,n){var r=Sr.sanitise(t,e,n),i=this.timeline();return new Sr(r.duration).loop(r).element(this).timeline(i.play()).schedule(r.delay,r.when)},delay:function(t,e){return this.animate(0,t,e)},_clearTransformRunnersBefore:function(t){this._transformationRunners.clearBefore(t.id)},_currentTransform:function(t){return this._transformationRunners.runners.filter((function(e){return e.id<=t.id})).map(jr).reduce(kr,new Fe)},_addRunner:function(t){this._transformationRunners.add(t),gr.cancelImmediate(this._frameId),this._frameId=gr.immediate(Pr.bind(this))},_prepareRunner:function(){null==this._frameId&&(this._transformationRunners=(new Ar).add(new _r(new Fe(this))))}}}),xe(Sr,{attr:function(t,e){return this.styleAttr("attr",t,e)},css:function(t,e){return this.styleAttr("css",t,e)},styleAttr:function(t,e,n){if("string"==typeof e)return this.styleAttr(t,Et({},e,n));var r=e;if(this._tryRetarget(t,r))return this;var i=new ar(this._stepper).to(r),o=Object.keys(r);return this.queue((function(){i=i.from(this.element()[t](o))}),(function(e){return this.element()[t](i.at(e).valueOf()),i.done()}),(function(e){var n,u=Object.keys(e),a=(n=o,u.filter((function(t){return!n.includes(t)})));if(a.length){var s=this.element()[t](a),l=new fr(i.from()).valueOf();Object.assign(l,s),i.from(l)}var c=new fr(i.to()).valueOf();Object.assign(c,e),i.to(c),o=u,r=e})),this._rememberMorpher(t,i),this},zoom:function(t,e){if(this._tryRetarget("zoom",t,e))return this;var n=new ar(this._stepper).to(new fn(t));return this.queue((function(){n=n.from(this.element().zoom())}),(function(t){return this.element().zoom(n.at(t),e),n.done()}),(function(t,r){e=r,n.to(t)})),this._rememberMorpher("zoom",n),this},transform:function(t,e,n){if(e=t.relative||e,this._isDeclarative&&!e&&this._tryRetarget("transform",t))return this;var r=Fe.isMatrixLike(t);n=null!=t.affine?t.affine:null!=n?n:!r;var i,o,u,a,s,l=new ar(this._stepper).type(n?lr:Fe);return this.queue((function(){o=o||this.element(),i=i||oe(t,o),s=new Fe(e?void 0:o),o._addRunner(this),e||o._clearTransformRunnersBefore(this)}),(function(c){e||this.clearTransform();var f=new qe(i).transform(o._currentTransform(this)),h=f.x,p=f.y,y=new Fe(At(At({},t),{},{origin:[h,p]})),d=this._isDeclarative&&u?u:s;if(n){y=y.decompose(h,p),d=d.decompose(h,p);var v=y.rotate,b=d.rotate,m=[v-360,v,v+360],g=m.map((function(t){return Math.abs(t-b)})),w=Math.min.apply(Math,Xt(g)),O=g.indexOf(w);y.rotate=m[O]}e&&(r||(y.rotate=t.rotate||0),this._isDeclarative&&a&&(d.rotate=a)),l.from(d),l.to(y);var x=l.at(c);return a=x.rotate,u=new Fe(x),this.addTransform(u),o._addRunner(this),l.done()}),(function(e){(e.origin||"center").toString()!==(t.origin||"center").toString()&&(i=oe(e,o)),t=At(At({},e),{},{origin:i})}),!0),this._isDeclarative&&this._rememberMorpher("transform",l),this},x:function(t,e){return this._queueNumber("x",t)},y:function(t){return this._queueNumber("y",t)},dx:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._queueNumberDelta("x",t)},dy:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._queueNumberDelta("y",t)},dmove:function(t,e){return this.dx(t).dy(e)},_queueNumberDelta:function(t,e){if(e=new fn(e),this._tryRetarget(t,e))return this;var n=new ar(this._stepper).to(e),r=null;return this.queue((function(){r=this.element()[t](),n.from(r),n.to(r+e)}),(function(e){return this.element()[t](n.at(e)),n.done()}),(function(t){n.to(r+new fn(t))})),this._rememberMorpher(t,n),this},_queueObject:function(t,e){if(this._tryRetarget(t,e))return this;var n=new ar(this._stepper).to(e);return this.queue((function(){n.from(this.element()[t]())}),(function(e){return this.element()[t](n.at(e)),n.done()})),this._rememberMorpher(t,n),this},_queueNumber:function(t,e){return this._queueObject(t,new fn(e))},cx:function(t){return this._queueNumber("cx",t)},cy:function(t){return this._queueNumber("cy",t)},move:function(t,e){return this.x(t).y(e)},center:function(t,e){return this.cx(t).cy(e)},size:function(t,e){var n;return t&&e||(n=this._element.bbox()),t||(t=n.width/n.height*e),e||(e=n.height/n.width*t),this.width(t).height(e)},width:function(t){return this._queueNumber("width",t)},height:function(t){return this._queueNumber("height",t)},plot:function(t,e,n,r){if(4===arguments.length)return this.plot([t,e,n,r]);if(this._tryRetarget("plot",t))return this;var i=new ar(this._stepper).type(this._element.MorphArray).to(t);return this.queue((function(){i.from(this._element.array())}),(function(t){return this._element.plot(i.at(t)),i.done()})),this._rememberMorpher("plot",i),this},leading:function(t){return this._queueNumber("leading",t)},viewbox:function(t,e,n,r){return this._queueObject("viewbox",new Ue(t,e,n,r))},update:function(t){return"object"!==Yt(t)?this.update({offset:arguments[0],color:arguments[1],opacity:arguments[2]}):(null!=t.opacity&&this.attr("stop-opacity",t.opacity),null!=t.color&&this.attr("stop-color",t.color),null!=t.offset&&this.attr("offset",t.offset),this)}}),xe(Sr,{rx:gn,ry:wn,from:Mn,to:Cn}),me(Sr,"Runner");var Er=function(t){Mt(n,t);var e=Ct(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),(r=e.call(this,de("svg",t),i)).namespace(),r}return Ht(n,[{key:"defs",value:function(){return this.isRoot()?ve(this.node.querySelector("defs"))||this.put(new bn):this.root().defs()}},{key:"isRoot",value:function(){return!this.node.parentNode||!(this.node.parentNode instanceof le.window.SVGElement)&&"#document-fragment"!==this.node.parentNode.nodeName}},{key:"namespace",value:function(){return this.isRoot()?this.attr({xmlns:ue,version:"1.1"}).attr("xmlns:xlink",se,ae).attr("xmlns:svgjs","http://svgjs.dev/svgjs",ae):this.root().namespace()}},{key:"removeNamespace",value:function(){return this.attr({xmlns:null,version:null}).attr("xmlns:xlink",null,ae).attr("xmlns:svgjs",null,ae)}},{key:"root",value:function(){return this.isRoot()?this:jt(It(n.prototype),"root",this).call(this)}}]),n}(vn);Qt({Container:{nested:Se((function(){return this.put(new Er)}))}}),me(Er,"Svg",!0);var Mr=function(t){Mt(n,t);var e=Ct(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),e.call(this,de("symbol",t),r)}return Ht(n)}(vn);Qt({Container:{symbol:Se((function(){return this.put(new Mr)}))}}),me(Mr,"Symbol");var Cr={__proto__:null,plain:function(t){return!1===this._build&&this.clear(),this.node.appendChild(le.document.createTextNode(t)),this},length:function(){return this.node.getComputedTextLength()},x:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.bbox();return null==t?e.x:this.attr("x",this.attr("x")+t-e.x)},y:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.bbox();return null==t?e.y:this.attr("y",this.attr("y")+t-e.y)},move:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.bbox();return this.x(t,n).y(e,n)},cx:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.bbox();return null==t?e.cx:this.attr("x",this.attr("x")+t-e.cx)},cy:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.bbox();return null==t?e.cy:this.attr("y",this.attr("y")+t-e.cy)},center:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.bbox();return this.cx(t,n).cy(e,n)},ax:function(t){return this.attr("x",t)},ay:function(t){return this.attr("y",t)},amove:function(t,e){return this.ax(t).ay(e)},build:function(t){return this._build=!!t,this}},Tr=function(t){Mt(n,t);var e=Ct(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),(r=e.call(this,de("text",t),i)).dom.leading=new fn(1.3),r._rebuild=!0,r._build=!1,r}return Ht(n,[{key:"leading",value:function(t){return null==t?this.dom.leading:(this.dom.leading=new fn(t),this.rebuild())}},{key:"rebuild",value:function(t){if("boolean"==typeof t&&(this._rebuild=t),this._rebuild){var e=this,n=0,r=this.dom.leading;this.each((function(t){var i=le.window.getComputedStyle(this.node).getPropertyValue("font-size"),o=r*new fn(i);this.dom.newLined&&(this.attr("x",e.attr("x")),"\n"===this.text()?n+=o:(this.attr("dy",t?o+n:0),n=0))})),this.fire("rebuild")}return this}},{key:"setData",value:function(t){return this.dom=t,this.dom.leading=new fn(t.leading||1.3),this}},{key:"text",value:function(t){if(void 0===t){var e=this.node.childNodes,n=0;t="";for(var r=0,i=e.length;r<i;++r)"textPath"!==e[r].nodeName?(r!==n&&3!==e[r].nodeType&&!0===ve(e[r]).dom.newLined&&(t+="\n"),t+=e[r].textContent):0===r&&(n=1);return t}if(this.clear().build(!0),"function"==typeof t)t.call(this,this);else for(var o=0,u=(t=(t+"").split("\n")).length;o<u;o++)this.newLine(t[o]);return this.build(!1).rebuild()}}]),n}(mn);xe(Tr,Cr),Qt({Container:{text:Se((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.put(new Tr).text(t)})),plain:Se((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.put(new Tr).plain(t)}))}}),me(Tr,"Text");var Rr=function(t){Mt(n,t);var e=Ct(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),(r=e.call(this,de("tspan",t),i))._build=!1,r}return Ht(n,[{key:"dx",value:function(t){return this.attr("dx",t)}},{key:"dy",value:function(t){return this.attr("dy",t)}},{key:"newLine",value:function(){this.dom.newLined=!0;var t=this.parent();if(!(t instanceof Tr))return this;var e=t.index(this),n=le.window.getComputedStyle(this.node).getPropertyValue("font-size"),r=t.dom.leading*new fn(n);return this.dy(e?r:0).attr("x",t.x())}},{key:"text",value:function(t){return null==t?this.node.textContent+(this.dom.newLined?"\n":""):("function"==typeof t?(this.clear().build(!0),t.call(this,this),this.build(!1)):this.plain(t),this)}}]),n}(mn);xe(Rr,Cr),Qt({Tspan:{tspan:Se((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=new Rr;return this._build||this.clear(),this.put(e).text(t)}))},Text:{newLine:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.tspan(t).newLine()}}}),me(Rr,"Tspan");var Nr=function(t){Mt(n,t);var e=Ct(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),e.call(this,de("circle",t),r)}return Ht(n,[{key:"radius",value:function(t){return this.attr("r",t)}},{key:"rx",value:function(t){return this.attr("r",t)}},{key:"ry",value:function(t){return this.rx(t)}},{key:"size",value:function(t){return this.radius(new fn(t).divide(2))}}]),n}(mn);xe(Nr,{x:On,y:xn,cx:Sn,cy:_n,width:kn,height:jn}),Qt({Container:{circle:Se((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.put(new Nr).size(t).move(0,0)}))}}),me(Nr,"Circle");var Dr=function(t){Mt(n,t);var e=Ct(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),e.call(this,de("clipPath",t),r)}return Ht(n,[{key:"remove",value:function(){return this.targets().forEach((function(t){t.unclip()})),jt(It(n.prototype),"remove",this).call(this)}},{key:"targets",value:function(){return Ze('svg [clip-path*="'+this.id()+'"]')}}]),n}(vn);Qt({Container:{clip:Se((function(){return this.defs().put(new Dr)}))},Element:{clipper:function(){return this.reference("clip-path")},clipWith:function(t){var e=t instanceof Dr?t:this.parent().clip().add(t);return this.attr("clip-path",'url("#'+e.id()+'")')},unclip:function(){return this.attr("clip-path",null)}}}),me(Dr,"ClipPath");var Gr=function(t){Mt(n,t);var e=Ct(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),e.call(this,de("foreignObject",t),r)}return Ht(n)}(yn);Qt({Container:{foreignObject:Se((function(t,e){return this.put(new Gr).size(t,e)}))}}),me(Gr,"ForeignObject");var Lr={__proto__:null,dmove:function(t,e){return this.children().forEach((function(n,r){var i;try{i=n.bbox()}catch(t){return}var o=new Fe(n),u=o.translate(t,e).transform(o.inverse()),a=new qe(i.x,i.y).transform(u);n.move(a.x,a.y)})),this},dx:function(t){return this.dmove(t,0)},dy:function(t){return this.dmove(0,t)},height:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.bbox();return null==t?e.height:this.size(e.width,t,e)},move:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.bbox(),r=t-n.x,i=e-n.y;return this.dmove(r,i)},size:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.bbox(),r=ie(this,t,e,n),i=r.width/n.width,o=r.height/n.height;return this.children().forEach((function(t,e){var r=new qe(n).transform(new Fe(t).inverse());t.scale(i,o,r.x,r.y)})),this},width:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.bbox();return null==t?e.width:this.size(t,e.height,e)},x:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.bbox();return null==t?e.x:this.move(t,e.y,e)},y:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.bbox();return null==t?e.y:this.move(e.x,t,e)}},Ir=function(t){Mt(n,t);var e=Ct(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),e.call(this,de("g",t),r)}return Ht(n)}(vn);xe(Ir,Lr),Qt({Container:{group:Se((function(){return this.put(new Ir)}))}}),me(Ir,"G");var Br=function(t){Mt(n,t);var e=Ct(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),e.call(this,de("a",t),r)}return Ht(n,[{key:"target",value:function(t){return this.attr("target",t)}},{key:"to",value:function(t){return this.attr("href",t,se)}}]),n}(vn);xe(Br,Lr),Qt({Container:{link:Se((function(t){return this.put(new Br).to(t)}))},Element:{unlink:function(){var t=this.linker();if(!t)return this;var e=t.parent();if(!e)return this.remove();var n=e.index(t);return e.add(this,n),t.remove(),this},linkTo:function(t){var e=this.linker();return e||(e=new Br,this.wrap(e)),"function"==typeof t?t.call(e,e):e.to(t),this},linker:function(){var t=this.parent();return t&&"a"===t.node.nodeName.toLowerCase()?t:null}}}),me(Br,"A");var Hr=function(t){Mt(n,t);var e=Ct(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),e.call(this,de("mask",t),r)}return Ht(n,[{key:"remove",value:function(){return this.targets().forEach((function(t){t.unmask()})),jt(It(n.prototype),"remove",this).call(this)}},{key:"targets",value:function(){return Ze('svg [mask*="'+this.id()+'"]')}}]),n}(vn);Qt({Container:{mask:Se((function(){return this.defs().put(new Hr)}))},Element:{masker:function(){return this.reference("mask")},maskWith:function(t){var e=t instanceof Hr?t:this.parent().mask().add(t);return this.attr("mask",'url("#'+e.id()+'")')},unmask:function(){return this.attr("mask",null)}}}),me(Hr,"Mask");var qr=function(t){Mt(n,t);var e=Ct(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),e.call(this,de("stop",t),r)}return Ht(n,[{key:"update",value:function(t){return("number"==typeof t||t instanceof fn)&&(t={offset:arguments[0],color:arguments[1],opacity:arguments[2]}),null!=t.opacity&&this.attr("stop-opacity",t.opacity),null!=t.color&&this.attr("stop-color",t.color),null!=t.offset&&this.attr("offset",new fn(t.offset)),this}}]),n}(yn);Qt({Gradient:{stop:function(t,e,n){return this.put(new qr).update(t,e,n)}}}),me(qr,"Stop");var zr=function(t){Mt(n,t);var e=Ct(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),e.call(this,de("style",t),r)}return Ht(n,[{key:"addText",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.node.textContent+=t,this}},{key:"font",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.rule("@font-face",At({fontFamily:t,src:e},n))}},{key:"rule",value:function(t,e){return this.addText(function(t,e){if(!t)return"";if(!e)return t;var n=t+"{";for(var r in e)n+=r.replace(/([A-Z])/g,(function(t,e){return"-"+e.toLowerCase()}))+":"+e[r]+";";return n+"}"}(t,e))}}]),n}(yn);Qt("Dom",{style:function(t,e){return this.put(new zr).rule(t,e)},fontface:function(t,e,n){return this.put(new zr).font(t,e,n)}}),me(zr,"Style");var Fr=function(t){Mt(n,t);var e=Ct(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),e.call(this,de("textPath",t),r)}return Ht(n,[{key:"array",value:function(){var t=this.track();return t?t.array():null}},{key:"plot",value:function(t){var e=this.track(),n=null;return e&&(n=e.plot(t)),null==t?n:this}},{key:"track",value:function(){return this.reference("href")}}]),n}(Tr);Qt({Container:{textPath:Se((function(t,e){return t instanceof Tr||(t=this.text(t)),t.path(e)}))},Text:{path:Se((function(t){var e,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=new Fr;if(t instanceof pr||(t=this.defs().path(t)),r.attr("href","#"+t,se),n)for(;e=this.node.firstChild;)r.node.appendChild(e);return this.put(r)})),textPath:function(){return this.findOne("textPath")}},Path:{text:Se((function(t){return t instanceof Tr||(t=(new Tr).addTo(this.parent()).text(t)),t.path(this)})),targets:function(){var t=this;return Ze("svg textPath").filter((function(e){return(e.attr("href")||"").includes(t.id())}))}}}),Fr.prototype.MorphArray=or,me(Fr,"TextPath");var Xr=function(t){Mt(n,t);var e=Ct(n);function n(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return zt(this,n),e.call(this,de("use",t),r)}return Ht(n,[{key:"use",value:function(t,e){return this.attr("href",(e||"")+"#"+t,se)}}]),n}(mn);Qt({Container:{use:Se((function(t,e){return this.put(new Xr).use(t,e)}))}}),me(Xr,"Use");var Yr=ye;xe([Er,Mr,Gn,Nn,Hn],Jt("viewbox")),xe([Bn,vr,dr,pr],Jt("marker")),xe(Tr,Jt("Text")),xe(pr,Jt("Path")),xe(bn,Jt("Defs")),xe([Tr,Rr],Jt("Tspan")),xe([br,An,Rn,Sr],Jt("radius")),xe(rn,Jt("EventTarget")),xe(pn,Jt("Dom")),xe(yn,Jt("Element")),xe(mn,Jt("Shape")),xe([vn,En],Jt("Container")),xe(Rn,Jt("Gradient")),xe(Sr,Jt("Runner")),We.extend(Xt(new Set(Zt))),function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];hr.push.apply(hr,Xt([].concat(t)))}([fn,He,Ue,Fe,cn,Ln,or,qe]),xe(hr,{to:function(t){return(new ar).type(this.constructor).from(this.toArray()).to(t)},fromArray:function(t){return this.init(t),this},toConsumable:function(){return this.toArray()},morph:function(t,e,n,r,i){return this.fromArray(t.map((function(t,o){return r.step(t,e[o],n,i[o],i)})))}});var Ur=function(t,e){for(var n=t.getTotalLength(),r=t.getPointAtLength(0),i="M".concat(r.x," ").concat(r.y),o=n/e;o<=n;o+=n/e)r=t.getPointAtLength(o),i+="L".concat(r.x," ").concat(r.y);t.setAttribute("d",i+"z")};function Vr(t){return Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vr(t)}function Wr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function $r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Wr(Object(n),!0).forEach((function(e){Qr(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Wr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Zr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Jr(r.key),r)}}function Qr(t,e,n){return(e=Jr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jr(t){var e=function(t,e){if("object"!==Vr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Vr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Vr(e)?e:String(e)}var Kr=function(){function t(e,n,r,i){var u=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Qr(this,"dragTo",(function(t,e){var n=u.env.image,r=n.naturalWidth,i=n.naturalHeight;u.group.style.display=null;var o=t-u.anchor[0],a=e-u.anchor[1],s=Math.max(1,Math.pow(Math.pow(o,2)+Math.pow(a,2),.5)/2),l=u.anchor[0]+o/2,c=u.anchor[1]+a/2;l-s<0||l+s>r||c-s<0||c+s>i||(function(t,e,n,r){var i=t.querySelector(".a9s-inner"),o=t.querySelector(".a9s-outer"),u=Yr(i).move(e,n),a=Yr(o).move(e,n);i.setAttribute("d",u.node.getAttribute("d")),o.setAttribute("d",a.node.getAttribute("d"))}(u.pinpoint,l,c),u.anchor=[l,c])})),Qr(this,"getBoundingClientRect",(function(){return u.pinpoint.getBoundingClientRect()})),Qr(this,"toSelection",(function(){return new A($r($r({},kt(u.group,u.env.image)),{},{renderedVia:{name:"pinpoint"},body:[{purpose:"position",value:"xywh=pixel:".concat(u.anchor[0],",").concat(u.anchor[1],",47,56")}]}))})),Qr(this,"destroy",(function(){u.group.parentNode.removeChild(u.group),u.pinpoint=null,u.group=null})),this.anchor=[e,n],this.env=i,this.group=document.createElementNS(o,"g"),this.pinpoint=function(t,e){var n=document.createElementNS(o,"g"),r=Yr().path("M356.36,202.77c-3.45,201.59-303.3,201.56-306.72,0C53.09,1.19,352.94,1.22,356.36,202.77Z").attr("class","a9s-outer").stroke({color:"white",width:1.5}).size(47).move(t,e);r.move(t-r.width()/4,e-r.height());var i=Yr().path("M 4637 -4760.267 C 4127.9 -4704.567 3574.7 -4479.767 3142.4 -4155.167 C 2235.7 -3477.067 1761.2 -2259.167 1982.1 -1177.567 C 2070.5 -747.267 2220.3 -407.267 2794.7 676.233 C 3207.7 1458.133 4250.8 3525.133 4758 4568.233 C 4882.9 4825.633 4992.4 5029.233 5000.1 5019.633 C 5007.8 5011.933 5215.3 4593.133 5461.1 4091.733 C 5997.1 2994.833 6623.3 1767.333 7074.8 931.633 C 7687.6 -203.667 7885.5 -632.067 7985.3 -1037.367 C 8102.5 -1519.567 8100.6 -1961.367 7977.6 -2451.267 C 7599.2 -3955.367 6187.3 -4933.167 4637 -4760.267 Z M 5240.2 -3744.067 C 5722.4 -3684.467 6150.8 -3467.467 6488.9 -3110.167 C 7111.3 -2451.267 7226.6 -1467.667 6773.2 -683.967 C 6300.6 126.733 5328.6 518.633 4431.4 257.433 C 3766.7 65.333 3225 -474.467 3032.9 -1137.267 C 2890.7 -1630.967 2936.9 -2155.367 3167.4 -2622.267 C 3369.1 -3035.267 3755.2 -3404.167 4172.1 -3584.667 C 4523.7 -3736.367 4873.3 -3788.267 5240.2 -3744.067 Z").attr("class","a9s-inner").attr("data-type","pinpoint").attr("data-position","xywh=pixel:".concat(t,",").concat(e,",47,56")).size(47).move(t,e);return i.move(t-i.width()/4,e-i.height()),Ur(r.node,100),Ur(i.node,500),n.appendChild(r.node),n.appendChild(i.node),n}(e,n),this.pinpoint.setAttribute("class","a9s-selection"),this.group.style.pointerEvents="none",this.group.style.display="none",this.group.appendChild(this.pinpoint),r.appendChild(this.group)}var e,n;return e=t,(n=[{key:"element",get:function(){return this.pinpoint}}])&&Zr(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ti(t){return function(t){if(Array.isArray(t))return ei(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ei(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ei(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ei(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var ni=/firefox/i.test(navigator.userAgent),ri=function(t,e,n,r,i){t.setAttribute("width",r),t.setAttribute("height",i),ni?(t.setAttribute("x",0),t.setAttribute("y",0),t.setAttribute("transform","translate(".concat(e,", ").concat(n,")"))):(t.setAttribute("x",e),t.setAttribute("y",n))},ii=function(t,e,n){if(!n)return t;var r=n.reduce((function(t,n){var r=n(e);if(!r)return t;if("string"==typeof r||r instanceof String)t.className=t.className?"".concat(t.className," ").concat(r):r;else if(r.nodeType===Node.ELEMENT_NODE)t.elements=t.elements?[].concat(ti(t.elements),[r]):[r];else{var i=r.className,o=r.style,u=r.element;i&&(t.className=t.className?"".concat(t.className," ").concat(i):i),o&&(t.style=t.style?"".concat(t.style," ").concat(o):o),u&&(t.elements=t.elements?[].concat(ti(t.elements),[u]):[u])}for(var a in r)r.hasOwnProperty(a)&&a.startsWith("data-")&&(t[a]=r[a]);return t}),{}),i=r.className,u=r.style,a=r.elements;if(i&&function(t,e){var n=function(t){var e=t.getAttribute("class");return e?new Set(e.split(" ")):new Set}(t);n.add(e),t.setAttribute("class",Array.from(n).join(" "))}(t,i),u){var s=t.querySelector(".a9s-outer"),l=t.querySelector(".a9s-inner");s&&l?(s.setAttribute("style","display:none"),l.setAttribute("style",u)):t.setAttribute("style",u)}for(var c in a&&a.forEach((function(e){return function(t,e){var n=e.getBBox(),r=n.x,i=n.y,u=n.width,a=n.height,s=document.createElementNS(o,"svg");s.setAttribute("class","a9s-formatter-el"),ri(s,r,i,u,a);var l=document.createElementNS(o,"g");l.appendChild(t),s.appendChild(l),e.append(s)}(e,t)})),r)r.hasOwnProperty(c)&&c.startsWith("data-")&&t.setAttribute(c,r[c])},oi=function(t,e,n,r,i){var o=t.querySelector(".a9s-formatter-el");o&&ri(o,e,n,r,i)};function ui(t){return ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ui(t)}function ai(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function si(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,yi(r.key),r)}}function li(t,e){return li=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},li(t,e)}function ci(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fi(){return fi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=hi(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},fi.apply(this,arguments)}function hi(t){return hi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},hi(t)}function pi(t,e,n){return(e=yi(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yi(t){var e=function(t,e){if("object"!==ui(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ui(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===ui(e)?e:String(e)}var di=function(t){var e=t.getAttribute("d").split("L"),n=[];if(e.length>0){var r=e[0].substring(1).trim().split(" ");n.push({x:parseFloat(r[0]),y:parseFloat(r[1])});for(var i=1;i<e.length;i++)r=e[i].trim().split(" "),n.push({x:parseFloat(r[0]),y:parseFloat(r[1])})}return n},vi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&li(t,e)}(a,t);var e,n,r,i,u=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=hi(r);if(i){var n=hi(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===ui(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ci(t)}(this,t)});function a(t,e,n,r){var i,s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),pi(ci(s=u.call(this,t,e,n,r)),"setPoints",(function(t){var e=function(t){return Math.round(10*t)/10},n=t.map((function(t){return"L".concat(e(t.x)," ").concat(e(t.y))})).join(" ");n="M"+n.substring(1),s.shape.querySelector(".a9s-inner").setAttribute("d",n);var r=s.shape.querySelector(".a9s-outer");r.setAttribute("d",n);var i=r.getBBox(),o=i.x,u=i.y,a=i.width,l=i.height;oi(s.elementGroup,o,u,a,l)})),pi(ci(s),"onGrab",(function(t){return function(e){s.grabbedElem=t;var n=s.getSVGPoint(e);s.grabbedAt={x:n.x,y:n.y}}})),pi(ci(s),"onMouseMove",(function(t){var e=function(t,e,n){return t+e<0?-t:t+e>n?n-t:e};if(s.grabbedElem){var n=s.getSVGPoint(t),r=s.shape.querySelector(".a9s-inner").getBBox(),i=r.x,o=r.y,u=r.width,a=r.height;if(s.grabbedElem===s.shape){var l=s.env.image,c=l.naturalWidth,f=l.naturalHeight,h=e(i,n.x-s.grabbedAt.x,c-u),p=e(o,n.y-s.grabbedAt.y,f-a),y=s.shape.querySelector(".a9s-inner"),d=di(y).map((function(t){return{x:t.x+h,y:t.y+p}}));s.grabbedAt=n,s.setPoints(d),s.emit("update",kt(s.shape,s.env.image))}}})),pi(ci(s),"onMouseUp",(function(t){s.grabbedElem=null,s.grabbedAt=null})),pi(ci(s),"updateState",(function(t){var e=di(St(t));s.setPoints(e)})),pi(ci(s),"destroy",(function(){s.containerGroup.parentNode.removeChild(s.containerGroup),fi((i=ci(s),hi(a.prototype)),"destroy",i).call(i)})),pi(ci(s),"getAnnotationPosition",(function(t){var e,n,r,i=null===(e=t.targets)||void 0===e||null===(n=e.find((function(t){var e;return"pinpoint"===(null===(e=t.renderedVia)||void 0===e?void 0:e.name)})))||void 0===n||null===(r=n.body)||void 0===r?void 0:r.find((function(t){return"position"===t.purpose}));if(i){var o=i.value,u=o.includes(":")?o.substring(o.indexOf("=")+1,o.indexOf(":")):"pixel",a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,u,a=[],s=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);s=!0);}catch(t){l=!0,i=t}finally{try{if(!s&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(l)throw i}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ai(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ai(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((o.includes(":")?o.substring(o.indexOf(":")+1):o.substring(o.indexOf("=")+1)).split(",").map(parseFloat),4),l=a[0],c=a[1],f=a[2],h=a[3];return"percent"===u.toLowerCase()&&(l=l*s.env.image.naturalWidth/100,c=c*s.env.image.naturalHeight/100,f=f*s.env.image.naturalWidth/100,h=h*s.env.image.naturalHeight/100),{x:l,y:c,w:f,h}}return null})),s.svg.addEventListener("mousemove",s.onMouseMove),s.svg.addEventListener("mouseup",s.onMouseUp),s.containerGroup=document.createElementNS(o,"g"),s.shape=_t(t),s.elementGroup=document.createElementNS(o,"g"),s.elementGroup.setAttribute("class","a9s-annotation editable selected"),s.elementGroup.appendChild(s.shape),s.containerGroup.appendChild(s.elementGroup),e.appendChild(s.containerGroup),ii(s.shape,t,n.formatter),s.shape.querySelector(".a9s-inner").addEventListener("mousedown",s.onGrab(s.shape)),s.grabbedElem=null,s.grabbedAt=null,s}return e=a,(n=[{key:"element",get:function(){return this.elementGroup}}])&&si(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Q);function bi(t){return bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bi(t)}function mi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Si(r.key),r)}}function gi(t,e){return gi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},gi(t,e)}function wi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Oi(t){return Oi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Oi(t)}function xi(t,e,n){return(e=Si(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Si(t){var e=function(t,e){if("object"!==bi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==bi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===bi(e)?e:String(e)}var _i=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gi(t,e)}(u,t);var e,n,r,i,o=(r=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Oi(r);if(i){var n=Oi(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===bi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return wi(t)}(this,t)});function u(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),xi(wi(r=o.call(this,t,e,n)),"startDrawing",(function(t,e,n,i){var o;if(null===(o=i.target.closest(".a9s-annotation"))||void 0===o?void 0:o.annotation)r.emit("cancel");else{r.pinpoint=new Kr(t,e,r.g,r.env);var u=r.pinpoint.element;u.annotation=r.pinpoint.toSelection(),u.body=[{purpose:"position",value:"xywh=pixel:".concat(t,",").concat(e,",47,56")}],r.emit("complete",u)}})),xi(wi(r),"stop",(function(){r.pinpoint&&(r.pinpoint.destroy(),r.pinpoint=null)})),xi(wi(r),"onMouseMove",(function(t,e){r.pinpoint.dragTo(t,e)})),xi(wi(r),"createEditableShape",(function(t){return new vi(t,r.g,r.config,r.env)})),r.pinpoint=null,r}return e=u,(n=[{key:"isDrawing",get:function(){return null!=this.pinpoint}}])&&mi(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(F);_i.identifier="pinpoint",_i.supports=function(t){return!1};var ki=function(t,e,n,r){t.setAttribute("cx",e),t.setAttribute("cy",n),t.setAttribute("r",r)},ji=function(t,e,n,r){var i=t.querySelector(".a9s-inner"),o=t.querySelector(".a9s-outer");ki(i,e,n,r),ki(o,e,n,r)},Pi=function(t){var e=t.querySelector(".a9s-outer");return{cx:parseFloat(e.getAttribute("cx")),cy:parseFloat(e.getAttribute("cy")),r:parseFloat(e.getAttribute("r"))}};function Ai(t){return Ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ai(t)}function Ei(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ci(r.key),r)}}function Mi(t,e,n){return(e=Ci(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ci(t){var e=function(t,e){if("object"!==Ai(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Ai(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Ai(e)?e:String(e)}var Ti=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Mi(this,"redraw",(function(){var t=Pi(r.circle),e=t.cx,n=t.cy,i=t.r,o=e+i>r.w?r.w-i:e,u=n+i>r.h?r.h-i:n+i;r.mask.setAttribute("d","M0 0 h".concat(r.w," v").concat(r.h," h-").concat(r.w," z M").concat(o," ").concat(u," a ").concat(i," ").concat(i," 0 1 1 1 0"))})),Mi(this,"destroy",(function(){return r.mask.parentNode.removeChild(r.mask)})),this.w=e.naturalWidth,this.h=e.naturalHeight,this.circle=n;var i=Pi(this.circle),u=i.cx,a=i.cy,s=i.r,l=u+s>this.w?this.w-s:u,c=a+s>this.h?this.h-s:a+s;this.mask=document.createElementNS(o,"path"),this.mask.setAttribute("fill-rule","evenodd"),this.mask.setAttribute("class","a9s-selection-mask"),this.mask.setAttribute("d","M0 0 h".concat(this.w," v").concat(this.h," h-").concat(this.w," z M").concat(l," ").concat(c," a ").concat(s," ").concat(s," 0 1 1 1 0"))}var e,n;return e=t,(n=[{key:"element",get:function(){return this.mask}}])&&Ei(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ri(t){return Ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ri(t)}function Ni(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Gi(r.key),r)}}function Di(t,e,n){return(e=Gi(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gi(t){var e=function(t,e){if("object"!==Ri(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Ri(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Ri(e)?e:String(e)}var Li=function(){function t(e,n,r,i){var u=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Di(this,"dragTo",(function(t,e){var n=u.env.image,r=n.naturalWidth,i=n.naturalHeight;u.group.style.display=null;var o=t-u.anchor[0],a=e-u.anchor[1],s=Math.max(1,Math.pow(Math.pow(o,2)+Math.pow(a,2),.5)/2),l=u.anchor[0]+o/2,c=u.anchor[1]+a/2;l-s<0||l+s>r||c-s<0||c+s>i||(ji(u.circle,l,c,s),u.mask.redraw())})),Di(this,"getBoundingClientRect",(function(){return u.circle.getBoundingClientRect()})),Di(this,"toSelection",(function(){return new A(kt(u.group,u.env.image))})),Di(this,"destroy",(function(){u.group.parentNode.removeChild(u.group),u.mask=null,u.circle=null,u.group=null})),this.anchor=[e,n],this.env=i,this.group=document.createElementNS(o,"g"),this.circle=function(t,e,n){var r=document.createElementNS(o,"g"),i=document.createElementNS(o,"circle"),u=document.createElementNS(o,"circle");return u.setAttribute("class","a9s-inner"),ki(u,t,e,2),i.setAttribute("class","a9s-outer"),ki(i,t,e,2),r.appendChild(i),r.appendChild(u),r}(e,n),this.circle.setAttribute("class","a9s-selection"),this.mask=new Ti(i.image,this.circle),this.group.style.pointerEvents="none",this.group.style.display="none",this.group.appendChild(this.mask.element),this.group.appendChild(this.circle),r.appendChild(this.group)}var e,n;return e=t,(n=[{key:"element",get:function(){return this.circle}}])&&Ni(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ii(t){return Ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ii(t)}function Bi(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,u,a=[],s=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);s=!0);}catch(t){l=!0,i=t}finally{try{if(!s&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(l)throw i}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Hi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hi(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function qi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Vi(r.key),r)}}function zi(){return zi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Yi(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},zi.apply(this,arguments)}function Fi(t,e){return Fi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Fi(t,e)}function Xi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Yi(t){return Yi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Yi(t)}function Ui(t,e,n){return(e=Vi(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vi(t){var e=function(t,e){if("object"!==Ii(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Ii(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Ii(e)?e:String(e)}var Wi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fi(t,e)}(a,t);var e,n,r,i,u=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Yi(r);if(i){var n=Yi(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Ii(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Xi(t)}(this,t)});function a(t,e,n,r){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),Ui(Xi(i=u.call(this,t,e,n,r)),"setSize",(function(t,e,n){ji(i.circle,t,e,n),i.mask.redraw(),oi(i.elementGroup,t,e,n,n);var r=Bi(i.handles,4),o=r[0],u=r[1],a=r[2],s=r[3];i.setHandleXY(o,t,e-n),i.setHandleXY(u,t+n,e),i.setHandleXY(a,t,e+n),i.setHandleXY(s,t-n,e)})),Ui(Xi(i),"stretchCorners",(function(t,e,n){var r,o=i.getHandleXY(e),u=n.x,a=n.y,s=0,l=0;0==t||2==t?(u=o.x,l=a-o.y,r=Math.abs(l)/2):(a=o.y,s=u-o.x,r=Math.abs(s)/2);var c=s>0?o.x:u,f=l>0?o.y:a,h=c+Math.abs(s)/2,p=f+Math.abs(l)/2;if(ji(i.circle,h,p,r),i.mask.redraw(),oi(i.elementGroup,h,p,r,r),0==t||2==t){var y=0,d=2;(0==t&&l>0||2==t&&l<0)&&(y=2,d=0),i.setHandleXY(i.handles[y],h,p-r),i.setHandleXY(i.handles[d],h,p+r),i.setHandleXY(i.handles[1],h+r,p),i.setHandleXY(i.handles[3],h-r,p)}else{var v=3,b=1;(1==t&&s>0||3==t&&s<0)&&(v=1,b=3),i.setHandleXY(i.handles[v],h+r,p),i.setHandleXY(i.handles[b],h-r,p),i.setHandleXY(i.handles[0],h,p-r),i.setHandleXY(i.handles[2],h,p+r)}})),Ui(Xi(i),"onGrab",(function(t){return function(e){i.grabbedElem=t;var n=i.getSVGPoint(e),r=Pi(i.circle),o=r.cx,u=r.cy;i.grabbedAt={x:n.x-o,y:n.y-u}}})),Ui(Xi(i),"onMouseMove",(function(t){var e=function(t,e){return t<0?0:t>e?e:t};if(i.grabbedElem){var n=i.getSVGPoint(t);if(i.grabbedElem===i.circle){var r=Pi(i.circle).r,o=i.env.image,u=o.naturalWidth,a=o.naturalHeight,s=Math.max(e(n.x-i.grabbedAt.x,u-r),r),l=Math.max(e(n.y-i.grabbedAt.y,a-r),r);i.setSize(s,l,r),i.emit("update",kt(i.circle,i.env.image))}else{var c=i.handles.indexOf(i.grabbedElem),f=c<2?i.handles[c+2]:i.handles[c-2];i.stretchCorners(c,f,n),i.emit("update",kt(i.circle,i.env.image))}}})),Ui(Xi(i),"onMouseUp",(function(){i.grabbedElem=null,i.grabbedAt=null})),Ui(Xi(i),"onScaleChanged",(function(t){return i.handles.map(i.scaleHandle)})),Ui(Xi(i),"updateState",(function(t){var e=St(t),n=parseFloat(e.getAttribute("cx")),r=parseFloat(e.getAttribute("cy")),o=parseFloat(e.getAttribute("r"));i.setSize(n,r,o)})),i.svg.addEventListener("mousemove",i.onMouseMove),i.svg.addEventListener("mouseup",i.onMouseUp),i.containerGroup=document.createElementNS(o,"g"),i.circle=_t(t),i.circle.querySelector(".a9s-inner").addEventListener("mousedown",i.onGrab(i.circle)),i.mask=new Ti(r.image,i.circle),i.containerGroup.appendChild(i.mask.element),i.elementGroup=document.createElementNS(o,"g"),i.elementGroup.setAttribute("class","a9s-annotation editable selected"),i.elementGroup.appendChild(i.circle);var s=Pi(i.circle),l=s.cx,c=s.cy,f=s.r;return i.handles=[[l,c-f],[l+f,c],[l,c+f],[l-f,c]].map((function(t){var e=Bi(t,2),n=e[0],r=e[1],o=i.drawHandle(n,r);return o.addEventListener("mousedown",i.onGrab(o)),i.elementGroup.appendChild(o),o})),i.containerGroup.appendChild(i.elementGroup),e.appendChild(i.containerGroup),ii(i.circle,t,n.formatter),i.grabbedElem=null,i.grabbedAt=null,i}return e=a,(n=[{key:"element",get:function(){return this.elementGroup}},{key:"destroy",value:function(){this.containerGroup.parentNode.removeChild(this.containerGroup),zi(Yi(a.prototype),"destroy",this).call(this)}}])&&qi(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Q);function $i(t){return $i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$i(t)}function Zi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,eo(r.key),r)}}function Qi(t,e){return Qi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Qi(t,e)}function Ji(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ki(t){return Ki=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ki(t)}function to(t,e,n){return(e=eo(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eo(t){var e=function(t,e){if("object"!==$i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==$i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===$i(e)?e:String(e)}var no=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Qi(t,e)}(u,t);var e,n,r,i,o=(r=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ki(r);if(i){var n=Ki(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===$i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ji(t)}(this,t)});function u(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),to(Ji(r=o.call(this,t,e,n)),"startDrawing",(function(t,e){r.attachListeners({mouseMove:r.onMouseMove,mouseUp:r.onMouseUp}),r.rubberband=new Li(t,e,r.g,r.env)})),to(Ji(r),"stop",(function(){r.rubberband&&(r.rubberband.destroy(),r.rubberband=null)})),to(Ji(r),"onMouseMove",(function(t,e){return r.rubberband.dragTo(t,e)})),to(Ji(r),"onMouseUp",(function(){r.detachListeners(),r.started=!1;var t=r.rubberband.getBoundingClientRect(),e=t.width,n=t.height,i=r.config.minSelectionWidth||4,o=r.config.minSelectionHeight||4;if(e>=i&&n>=o){var u=r.rubberband.element;u.annotation=r.rubberband.toSelection(),r.emit("complete",u)}else r.emit("cancel");r.stop()})),to(Ji(r),"createEditableShape",(function(t){return new Wi(t,r.g,r.config,r.env)})),r.rubberband=null,r}return e=u,(n=[{key:"isDrawing",get:function(){return null!=this.rubberband}}])&&Zi(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(F);no.identifier="circle",no.supports=function(t){var e,n=t.selector("SvgSelector");if(n)return null===(e=n.value)||void 0===e?void 0:e.match(/^<svg.*<circle/g)};var ro=function(t,e,n,r,i){t.setAttribute("cx",e),t.setAttribute("cy",n),t.setAttribute("rx",r),t.setAttribute("ry",i)},io=function(t,e,n,r,i){var o=t.querySelector(".a9s-inner"),u=t.querySelector(".a9s-outer");ro(o,e,n,r,i),ro(u,e,n,r,i)},oo=function(t){var e=t.querySelector(".a9s-outer");return{cx:parseFloat(e.getAttribute("cx")),cy:parseFloat(e.getAttribute("cy")),rx:parseFloat(e.getAttribute("rx")),ry:parseFloat(e.getAttribute("ry"))}};function uo(t){return uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uo(t)}function ao(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,lo(r.key),r)}}function so(t,e,n){return(e=lo(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lo(t){var e=function(t,e){if("object"!==uo(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==uo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===uo(e)?e:String(e)}var co=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),so(this,"redraw",(function(){var t=oo(r.ellipse),e=t.cx,n=t.cy,i=t.rx,o=t.ry,u=n+o;r.mask.setAttribute("d","M0 0 h".concat(r.w," v").concat(r.h," h-").concat(r.w," z M").concat(e," ").concat(u," a ").concat(i," ").concat(o," 0 1 1 1 0"))})),so(this,"destroy",(function(){return r.mask.parentNode.removeChild(r.mask)})),this.w=e.naturalWidth,this.h=e.naturalHeight,this.ellipse=n;var i=oo(this.ellipse),u=i.cx,a=i.cy,s=i.rx,l=i.ry,c=a+l;this.mask=document.createElementNS(o,"path"),this.mask.setAttribute("fill-rule","evenodd"),this.mask.setAttribute("class","a9s-selection-mask"),this.mask.setAttribute("d","M0 0 h".concat(this.w," v").concat(this.h," h-").concat(this.w," z M").concat(u," ").concat(c," a ").concat(s," ").concat(l," 0 1 1 1 0"))}var e,n;return e=t,(n=[{key:"element",get:function(){return this.mask}}])&&ao(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function fo(t){return fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fo(t)}function ho(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,yo(r.key),r)}}function po(t,e,n){return(e=yo(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yo(t){var e=function(t,e){if("object"!==fo(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==fo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===fo(e)?e:String(e)}var vo=function(){function t(e,n,r,i){var u=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),po(this,"dragTo",(function(t,e){u.group.style.display=null;var n=t-u.anchor[0],r=e-u.anchor[1],i=n>0?u.anchor[0]+n/2:t+n/2,o=r>0?u.anchor[1]+r/2:e+r/2,a=Math.abs(n/2),s=Math.abs(r/2);io(u.ellipse,i,o,a,s),u.mask.redraw()})),po(this,"getBoundingClientRect",(function(){return u.ellipse.getBoundingClientRect()})),po(this,"toSelection",(function(){return new A(kt(u.group,u.env.image))})),po(this,"destroy",(function(){u.group.parentNode.removeChild(u.group),u.mask=null,u.ellipse=null,u.group=null})),this.anchor=[e,n],this.env=i,this.group=document.createElementNS(o,"g"),this.ellipse=function(t,e,n,r){var i=document.createElementNS(o,"g"),u=document.createElementNS(o,"ellipse"),a=document.createElementNS(o,"ellipse");return u.setAttribute("class","a9s-inner"),ro(u,t,e,2,r),a.setAttribute("class","a9s-outer"),ro(a,t,e,2,r),i.appendChild(a),i.appendChild(u),i}(e,n),this.ellipse.setAttribute("class","a9s-selection"),this.mask=new co(i.image,this.ellipse),this.group.style.pointerEvents="none",this.group.style.display="none",this.group.appendChild(this.mask.element),this.group.appendChild(this.ellipse),r.appendChild(this.group)}var e,n;return e=t,(n=[{key:"element",get:function(){return this.ellipse}}])&&ho(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function bo(t){return bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bo(t)}function mo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,u,a=[],s=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);s=!0);}catch(t){l=!0,i=t}finally{try{if(!s&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(l)throw i}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return go(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?go(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function go(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function wo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,jo(r.key),r)}}function Oo(){return Oo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_o(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Oo.apply(this,arguments)}function xo(t,e){return xo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},xo(t,e)}function So(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _o(t){return _o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_o(t)}function ko(t,e,n){return(e=jo(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jo(t){var e=function(t,e){if("object"!==bo(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==bo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===bo(e)?e:String(e)}var Po=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xo(t,e)}(a,t);var e,n,r,i,u=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=_o(r);if(i){var n=_o(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===bo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return So(t)}(this,t)});function a(t,e,n,r){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),ko(So(i=u.call(this,t,e,n,r)),"setSize",(function(t,e,n,r){io(i.ellipse,t,e,n,r),i.mask.redraw(),oi(i.elementGroup,t,e,n,r);var o=mo(i.handles,4),u=o[0],a=o[1],s=o[2],l=o[3];i.setHandleXY(u,t,e-r),i.setHandleXY(a,t+n,e),i.setHandleXY(s,t,e+r),i.setHandleXY(l,t-n,e)})),ko(So(i),"stretchCorners",(function(t,e,n,r){var o=i.getHandleXY(e),u=i.getHandleXY(n),a=r.x,s=r.y,l=0,c=0;0==t||2==t?a=o.x:s=o.y;var f=a-o.x,h=s-o.y,p=f>0?o.x:a,y=h>0?o.y:s,d=Math.abs(f),v=Math.abs(h),b=p+d/2,m=y+v/2;if(l=d/2,c=v/2,0==t||2==t?l=Math.abs(o.x-u.x):c=Math.abs(o.y-u.y),io(i.ellipse,b,m,l,c),i.mask.redraw(),oi(i.elementGroup,b,m,l,c),0==t||2==t){var g=0,w=2;(0==t&&h>0||2==t&&h<0)&&(g=2,w=0),i.setHandleXY(i.handles[g],b,m-c),i.setHandleXY(i.handles[w],b,m+c),i.setHandleXY(i.handles[1],b+l,m),i.setHandleXY(i.handles[3],b-l,m)}else{var O=3,x=1;(1==t&&f>0||3==t&&f<0)&&(O=1,x=3),i.setHandleXY(i.handles[O],b+l,m),i.setHandleXY(i.handles[x],b-l,m),i.setHandleXY(i.handles[0],b,m-c),i.setHandleXY(i.handles[2],b,m+c)}})),ko(So(i),"onGrab",(function(t){return function(e){i.grabbedElem=t;var n=i.getSVGPoint(e),r=oo(i.ellipse),o=r.cx,u=r.cy;i.grabbedAt={x:n.x-o,y:n.y-u}}})),ko(So(i),"onMouseMove",(function(t){var e=function(t,e){return t<0?0:t>e?e:t};if(i.grabbedElem){var n=i.getSVGPoint(t);if(i.grabbedElem===i.ellipse){var r=oo(i.ellipse),o=r.rx,u=r.ry,a=i.env.image,s=a.naturalWidth,l=a.naturalHeight,c=e(n.x-i.grabbedAt.x,s-o),f=e(n.y-i.grabbedAt.y,l-u);i.setSize(c,f,o,u),i.emit("update",kt(i.ellipse,i.env.image))}else{var h=i.handles.indexOf(i.grabbedElem),p=h<2?i.handles[h+2]:i.handles[h-2],y=i.handles[(h+3)%4];i.stretchCorners(h,p,y,n),i.emit("update",kt(i.ellipse,i.env.image))}}})),ko(So(i),"onMouseUp",(function(){i.grabbedElem=null,i.grabbedAt=null})),ko(So(i),"onScaleChanged",(function(t){return i.handles.map(i.scaleHandle)})),ko(So(i),"updateState",(function(t){var e=St(t),n=parseFloat(e.getAttribute("cx")),r=parseFloat(e.getAttribute("cy")),o=parseFloat(e.getAttribute("rx")),u=parseFloat(e.getAttribute("ry"));i.setSize(n,r,o,u)})),i.svg.addEventListener("mousemove",i.onMouseMove),i.svg.addEventListener("mouseup",i.onMouseUp),i.containerGroup=document.createElementNS(o,"g"),i.ellipse=_t(t),i.ellipse.querySelector(".a9s-inner").addEventListener("mousedown",i.onGrab(i.ellipse)),i.mask=new co(r.image,i.ellipse),i.containerGroup.appendChild(i.mask.element),i.elementGroup=document.createElementNS(o,"g"),i.elementGroup.setAttribute("class","a9s-annotation editable selected"),i.elementGroup.appendChild(i.ellipse);var s=oo(i.ellipse),l=s.cx,c=s.cy,f=s.rx,h=s.ry;return i.handles=[[l,c-h],[l+f,c],[l,c+h],[l-f,c]].map((function(t){var e=mo(t,2),n=e[0],r=e[1],o=i.drawHandle(n,r);return o.addEventListener("mousedown",i.onGrab(o)),i.elementGroup.appendChild(o),o})),i.containerGroup.appendChild(i.elementGroup),e.appendChild(i.containerGroup),ii(i.ellipse,t,n.formatter),i.grabbedElem=null,i.grabbedAt=null,i}return e=a,(n=[{key:"element",get:function(){return this.elementGroup}},{key:"destroy",value:function(){this.containerGroup.parentNode.removeChild(this.containerGroup),Oo(_o(a.prototype),"destroy",this).call(this)}}])&&wo(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Q);function Ao(t){return Ao="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ao(t)}function Eo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,No(r.key),r)}}function Mo(t,e){return Mo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Mo(t,e)}function Co(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function To(t){return To=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},To(t)}function Ro(t,e,n){return(e=No(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function No(t){var e=function(t,e){if("object"!==Ao(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Ao(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Ao(e)?e:String(e)}var Do=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Mo(t,e)}(u,t);var e,n,r,i,o=(r=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=To(r);if(i){var n=To(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Ao(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Co(t)}(this,t)});function u(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),Ro(Co(r=o.call(this,t,e,n)),"startDrawing",(function(t,e){r.attachListeners({mouseMove:r.onMouseMove,mouseUp:r.onMouseUp}),r.rubberband=new vo(t,e,r.g,r.env)})),Ro(Co(r),"stop",(function(){r.rubberband&&(r.rubberband.destroy(),r.rubberband=null)})),Ro(Co(r),"onMouseMove",(function(t,e){return r.rubberband.dragTo(t,e)})),Ro(Co(r),"onMouseUp",(function(){r.detachListeners(),r.started=!1;var t=r.rubberband.getBoundingClientRect(),e=t.width,n=t.height,i=r.config.minSelectionWidth||4,o=r.config.minSelectionHeight||4;if(e>=i&&n>=o){var u=r.rubberband.element;u.annotation=r.rubberband.toSelection(),r.emit("complete",u)}else r.emit("cancel");r.stop()})),Ro(Co(r),"createEditableShape",(function(t){return new Po(t,r.g,r.config,r.env)})),r.rubberband=null,r}return e=u,(n=[{key:"isDrawing",get:function(){return null!=this.rubberband}}])&&Eo(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(F);function Go(t){return Go="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Go(t)}function Lo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Io(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ho(r.key),r)}}function Bo(t,e,n){return(e=Ho(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ho(t){var e=function(t,e){if("object"!==Go(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Go(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Go(e)?e:String(e)}Do.identifier="ellipse",Do.supports=function(t){var e,n=t.selector("SvgSelector");if(n)return null===(e=n.value)||void 0===e?void 0:e.match(/^<svg.*<ellipse/g)};var qo=function(){function t(e,n,r){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Bo(this,"setPoints",(function(t){var e=t.map((function(t){return"L".concat(t[0]," ").concat(t[1])})).join(" ");e="M"+e.substring(1),i.outer.setAttribute("d",e),i.inner.setAttribute("d",e)})),Bo(this,"getBoundingClientRect",(function(){return i.outer.getBoundingClientRect()})),Bo(this,"dragTo",(function(t){i.group.style.display=null,i.addPoint(t)})),Bo(this,"addPoint",(function(t){var e;i.points=[].concat(function(t){if(Array.isArray(t))return Lo(t)}(e=i.points)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return Lo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lo(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[t]),i.setPoints(i.points)})),Bo(this,"destroy",(function(){i.group.parentNode.removeChild(i.group),i.freehand=null,i.group=null})),Bo(this,"toSelection",(function(){return new A(kt(i.group,i.env.image))})),this.points=[e],this.env=r,this.group=document.createElementNS(o,"g"),this.freehand=document.createElementNS(o,"g"),this.freehand.setAttribute("class","a9s-selection"),this.outer=document.createElementNS(o,"path"),this.outer.setAttribute("class","a9s-outer"),this.inner=document.createElementNS(o,"path"),this.inner.setAttribute("class","a9s-inner"),this.setPoints(this.points),this.freehand.appendChild(this.outer),this.freehand.appendChild(this.inner),this.group.style.display="none",this.group.appendChild(this.freehand),n.appendChild(this.group)}var e,n;return e=t,(n=[{key:"element",get:function(){return this.freehand}}])&&Io(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function zo(t){return zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zo(t)}function Fo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$o(r.key),r)}}function Xo(t,e){return Xo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xo(t,e)}function Yo(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Uo(){return Uo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Vo(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Uo.apply(this,arguments)}function Vo(t){return Vo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Vo(t)}function Wo(t,e,n){return(e=$o(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $o(t){var e=function(t,e){if("object"!==zo(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==zo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===zo(e)?e:String(e)}var Zo=function(t){var e=t.getAttribute("d").split("L"),n=[];if(e.length>0){var r=e[0].substring(1).trim().split(" ");n.push({x:parseFloat(r[0]),y:parseFloat(r[1])});for(var i=1;i<e.length;i++)r=e[i].trim().split(" "),n.push({x:parseFloat(r[0]),y:parseFloat(r[1])})}return n},Qo=function(t){return t.querySelector(".a9s-inner").getBBox()},Jo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xo(t,e)}(a,t);var e,n,r,i,u=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Vo(r);if(i){var n=Vo(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===zo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Yo(t)}(this,t)});function a(t,e,n,r){var i,s;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),Wo(Yo(s=u.call(this,t,e,n,r)),"setPoints",(function(t){var e=function(t){return Math.round(10*t)/10},n=t.map((function(t){return"L".concat(e(t.x)," ").concat(e(t.y))})).join(" ");n="M"+n.substring(1),s.shape.querySelector(".a9s-inner").setAttribute("d",n);var r=s.shape.querySelector(".a9s-outer");r.setAttribute("d",n);var i=r.getBBox(),o=i.x,u=i.y,a=i.width,l=i.height;oi(s.elementGroup,o,u,a,l)})),Wo(Yo(s),"onGrab",(function(t){return function(e){s.grabbedElem=t;var n=s.getSVGPoint(e);s.grabbedAt={x:n.x,y:n.y}}})),Wo(Yo(s),"onMouseMove",(function(t){var e=function(t,e,n){return t+e<0?-t:t+e>n?n-t:e};if(s.grabbedElem){var n=s.getSVGPoint(t),r=Qo(s.shape),i=r.x,o=r.y,u=r.width,a=r.height;if(s.grabbedElem===s.shape){var l=s.env.image,c=l.naturalWidth,f=l.naturalHeight,h=e(i,n.x-s.grabbedAt.x,c-u),p=e(o,n.y-s.grabbedAt.y,f-a),y=s.shape.querySelector(".a9s-inner"),d=Zo(y).map((function(t){return{x:t.x+h,y:t.y+p}}));s.grabbedAt=n,s.setPoints(d),s.emit("update",kt(s.shape,s.env.image))}}})),Wo(Yo(s),"onMouseUp",(function(t){s.grabbedElem=null,s.grabbedAt=null})),Wo(Yo(s),"updateState",(function(t){var e=Zo(St(t));s.setPoints(e)})),Wo(Yo(s),"destroy",(function(){s.containerGroup.parentNode.removeChild(s.containerGroup),Uo((i=Yo(s),Vo(a.prototype)),"destroy",i).call(i)})),s.svg.addEventListener("mousemove",s.onMouseMove),s.svg.addEventListener("mouseup",s.onMouseUp),s.containerGroup=document.createElementNS(o,"g"),s.shape=_t(t),s.elementGroup=document.createElementNS(o,"g"),s.elementGroup.setAttribute("class","a9s-annotation editable selected"),s.elementGroup.appendChild(s.shape),s.containerGroup.appendChild(s.elementGroup),e.appendChild(s.containerGroup),ii(s.shape,t,n.formatter),s.shape.querySelector(".a9s-inner").addEventListener("mousedown",s.onGrab(s.shape));var l=Qo(s.shape);return l.x,l.y,l.width,l.height,s.grabbedElem=null,s.grabbedAt=null,s}return e=a,(n=[{key:"element",get:function(){return this.elementGroup}}])&&Fo(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Q);function Ko(t){return Ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ko(t)}function tu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ou(r.key),r)}}function eu(t,e){return eu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},eu(t,e)}function nu(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ru(t){return ru=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ru(t)}function iu(t,e,n){return(e=ou(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ou(t){var e=function(t,e){if("object"!==Ko(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Ko(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Ko(e)?e:String(e)}var uu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eu(t,e)}(u,t);var e,n,r,i,o=(r=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ru(r);if(i){var n=ru(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Ko(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return nu(t)}(this,t)});function u(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),iu(nu(r=o.call(this,t,e,n)),"startDrawing",(function(t,e){r._isDrawing=!0,r.attachListeners({mouseMove:r.onMouseMove,mouseUp:r.onMouseUp,dblClick:r.onDblClick}),r.rubberband=new qo([t,e],r.g,r.env)})),iu(nu(r),"stop",(function(){r.detachListeners(),r._isDrawing=!1,r.rubberband&&(r.rubberband.destroy(),r.rubberband=null)})),iu(nu(r),"onMouseMove",(function(t,e){return r.rubberband.dragTo([t,e])})),iu(nu(r),"onMouseUp",(function(t,e){r.onDblClick(t,e)})),iu(nu(r),"onDblClick",(function(t,e){r._isDrawing=!1,r.rubberband.addPoint([t,e]),r.detachListeners();var n=r.rubberband.getBoundingClientRect(),i=n.width,o=n.height,u=r.config.minSelectionWidth||4,a=r.config.minSelectionHeight||4;if(i>=u||o>=a){var s=r.rubberband.element;s.annotation=r.rubberband.toSelection(),r.emit("complete",s)}else r.emit("cancel");r.stop()})),iu(nu(r),"createEditableShape",(function(t){return new Jo(t,r.g,r.config,r.env)})),r._isDrawing=!1,r}return e=u,(n=[{key:"isDrawing",get:function(){return this._isDrawing}}])&&tu(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(F);function au(t){return au="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},au(t)}function su(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,cu(r.key),r)}}function lu(t,e,n){return(e=cu(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cu(t){var e=function(t,e){if("object"!==au(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==au(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===au(e)?e:String(e)}uu.identifier="freehand",uu.supports=function(t){var e=t.selector("SvgSelector");if(e)return e.value.match(/^<svg.*<path*/g)&&!e.value.toUpperCase().includes("Z")};var fu=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),lu(this,"redraw",(function(){r.mask.setAttribute("d","M0 0 h".concat(r.w," v").concat(r.h," h-").concat(r.w," z M").concat(r.polygon.getAttribute("points")," z"))})),lu(this,"destroy",(function(){return r.mask.parentNode.removeChild(r.mask)})),this.w=e.naturalWidth,this.h=e.naturalHeight,this.polygon=n,this.mask=document.createElementNS(o,"path"),this.mask.setAttribute("fill-rule","evenodd"),this.mask.setAttribute("class","a9s-selection-mask"),this.mask.setAttribute("d","M0 0 h".concat(this.w," v").concat(this.h," h-").concat(this.w," z M").concat(this.polygon.getAttribute("points")," z"))}var e,n;return e=t,(n=[{key:"element",get:function(){return this.mask}}])&&su(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function hu(t){return hu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hu(t)}function pu(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function yu(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pu(Object(n),!0).forEach((function(e){wu(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pu(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function du(t){return function(t){if(Array.isArray(t))return mu(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||bu(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vu(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=bu(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return u=t.done,t},e:function(t){a=!0,o=t},f:function(){try{u||null==n.return||n.return()}finally{if(a)throw o}}}}function bu(t,e){if(t){if("string"==typeof t)return mu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mu(t,e):void 0}}function mu(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function gu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ou(r.key),r)}}function wu(t,e,n){return(e=Ou(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ou(t){var e=function(t,e){if("object"!==hu(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==hu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===hu(e)?e:String(e)}var xu=function(){function t(e,n,r){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),wu(this,"setPoints",(function(t){var e,n="",r=vu(t);try{for(r.s();!(e=r.n()).done;){var o=e.value,u="";if(o.length>0){var a,s=vu(o);try{for(s.s();!(a=s.n()).done;){var l=a.value;l&&(u+=""===u?"M".concat(l[0],",").concat(l[1]):" L".concat(l[0],",").concat(l[1]))}}catch(t){s.e(t)}finally{s.f()}n+=u}}}catch(t){r.e(t)}finally{r.f()}n+=" Z",i.outer.setAttribute("d",n),i.inner.setAttribute("d",n)})),wu(this,"getBoundingClientRect",(function(){return i.outer.getBoundingClientRect()})),wu(this,"dragTo",(function(t){i.group.style.display=null;var e=i.points[i.points.length-1].slice(0,i.points[i.points.length-1].length-1),n=i.points.slice(0,-1),r=[].concat(du(e),[t,e[0]]);n.push(r),i.setPoints(n),i.mask.redraw()})),wu(this,"addPoint",(function(t){if(i.points[i.points.length-1].length>0){var e=i.points[i.points.length-1].slice(0,i.points[i.points.length-1].length-1),n=e[e.length-1];Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2)>4&&(i.points[i.points.length-1]=[].concat(du(e),[t,e[0]]),i.setPoints(i.points),i.mask.redraw())}else i.points[i.points.length-1]=[t,t],i.setPoints(i.points)})),wu(this,"undo",(function(){i.points[i.points.length-1].length>2?i.points[i.points.length-1].pop():i.points.length>1&&i.points.pop()})),wu(this,"newPart",(function(){i.points.push([])})),wu(this,"destroy",(function(){i.group.parentNode.removeChild(i.group),i.multipolygon=null,i.group=null})),wu(this,"toSelection",(function(){return new A(yu(yu({},kt(i.group,i.env.image)),{},{renderedVia:{name:"multipolygon"}}))})),this.points=[],this.points.push([e,e]),this.env=r,this.group=document.createElementNS(o,"g"),this.multipolygon=document.createElementNS(o,"g"),this.multipolygon.setAttribute("class","a9s-selection"),this.outer=document.createElementNS(o,"path"),this.outer.setAttribute("class","a9s-outer"),this.inner=document.createElementNS(o,"path"),this.inner.setAttribute("class","a9s-inner"),this.setPoints(this.points),this.mask=new fu(r.image,this.inner),this.multipolygon.appendChild(this.outer),this.multipolygon.appendChild(this.inner),this.group.style.display="none",this.group.appendChild(this.mask.element),this.group.appendChild(this.multipolygon),n.appendChild(this.group)}var e,n;return e=t,(n=[{key:"element",get:function(){return this.multipolygon}}])&&gu(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Su(t){return Su="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Su(t)}function _u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ku(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_u(Object(n),!0).forEach((function(e){Cu(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ju(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Tu(r.key),r)}}function Pu(t,e){return Pu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Pu(t,e)}function Au(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Eu(){return Eu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Mu(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Eu.apply(this,arguments)}function Mu(t){return Mu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Mu(t)}function Cu(t,e,n){return(e=Tu(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tu(t){var e=function(t,e){if("object"!==Su(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Su(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Su(e)?e:String(e)}function Ru(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Nu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nu(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return u=t.done,t},e:function(t){a=!0,o=t},f:function(){try{u||null==n.return||n.return()}finally{if(a)throw o}}}}function Nu(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Du=function(t){var e,n=[],r=Ru(Gu(t.querySelector(".a9s-inner").attributes.d.nodeValue));try{for(r.s();!(e=r.n()).done;){var i,o=e.value,u=[],a=Ru(o);try{for(a.s();!(i=a.n()).done;){var s=i.value,l={x:parseFloat(s[0]),y:parseFloat(s[1])};u.push(l)}}catch(t){a.e(t)}finally{a.f()}n.push(u)}}catch(t){r.e(t)}finally{r.f()}return n},Gu=function(t){var e=t.split("M"),n=[];return e.forEach((function(t,e){if(t.length>0){var r=[];(t=(t=(t=(t=(t=t.replace(/ Z/g,"Z")).replace(/Z /g,"Z")).replace(/Z/g,"")).replace(/L /g,"L")).replace(/ L/g,"L")).split("L").forEach((function(t,e){r.push([parseFloat(t.split(",")[0]).toFixed(2).toString(),parseFloat(t.split(",")[1]).toFixed(2).toString()])})),r[0]!==r[r.length-1]&&r.push(r[0]),n.push(r)}})),n},Lu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pu(t,e)}(a,t);var e,n,r,i,u=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Mu(r);if(i){var n=Mu(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Su(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Au(t)}(this,t)});function a(t,e,n,r){var i,s;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),Cu(Au(s=u.call(this,t,e,n,r)),"setPoints",(function(t){var e,n=function(t){return Math.round(10*t)/10},r="",i=Ru(t);try{for(i.s();!(e=i.n()).done;){var o=e.value;r+="M";var u,a=!0,l=Ru(o);try{for(l.s();!(u=l.n()).done;){var c=u.value;a?(a=!1,r+=c.x.toString()+","+c.y.toString()):r+=" L"+n(c.x).toString()+","+n(c.y).toString()}}catch(t){l.e(t)}finally{l.f()}r+=" Z"}}catch(t){i.e(t)}finally{i.f()}s.shape.querySelector(".a9s-inner").setAttribute("d",r);var f=s.shape.querySelector(".a9s-outer");f.setAttribute("d",r);var h=f.getBBox(),p=h.x,y=h.y,d=h.width,v=h.height;oi(s.elementGroup,p,y,d,v)})),Cu(Au(s),"onGrab",(function(t){return function(e){s.grabbedElem=t;var n=s.getSVGPoint(e);s.grabbedAt={x:n.x,y:n.y}}})),Cu(Au(s),"onMouseMove",(function(t){if(s.grabbedElem){var e=s.getSVGPoint(t);if(s.grabbedElem===s.shape){var n,r=e.x-s.grabbedAt.x,i=e.y-s.grabbedAt.y,o=[],u=Ru(Du(s.shape));try{for(u.s();!(n=u.n()).done;){var a=n.value;o.push(a.map((function(t){return{x:t.x+r,y:t.y+i}})))}}catch(t){u.e(t)}finally{u.f()}s.grabbedAt=e,s.setPoints(o);for(var l=0,c=0,f=o;c<f.length;c++)f[c].forEach((function(t,e){void 0!==s.handles[l][e]&&s.setHandleXY(s.handles[l][e],t.x,t.y)})),l+=1;s.emit("update",ku(ku({},kt(s.shape,s.env.image)),{},{renderedVia:{name:"multipolygon"}}))}else{var h,p=-1,y=0,d=!1,v=Ru(s.handles);try{for(v.s();!(h=v.n()).done;){var b=h.value;b.indexOf(s.grabbedElem)>0?(p=b.indexOf(s.grabbedElem),d=!0):d||(y+=1)}}catch(t){v.e(t)}finally{v.f()}var m,g=Du(s.shape),w=[],O=0,x=Ru(g);try{var S=function(){var t=m.value;if(O===y){var n=[];t.forEach((function(t,r){r===p?n.push(e):n.push(t)})),w.push(n)}else w.push(t);O+=1};for(x.s();!(m=x.n()).done;)S()}catch(t){x.e(t)}finally{x.f()}s.setPoints(w),O=0;var _,k=Ru(s.handles);try{for(k.s();!(_=k.n()).done;){var j=_.value;O===y&&s.setHandleXY(j[p],e.x,e.y),O+=1}}catch(t){k.e(t)}finally{k.f()}s.emit("update",ku(ku({},kt(s.shape,s.env.image)),{},{renderedVia:{name:"multipolygon"}}))}}})),Cu(Au(s),"onMouseUp",(function(t){s.grabbedElem=null,s.grabbedAt=null})),Cu(Au(s),"updateState",(function(t){var e=Du(St(t));s.setPoints(e)})),Cu(Au(s),"destroy",(function(){s.containerGroup.parentNode.removeChild(s.containerGroup),Eu((i=Au(s),Mu(a.prototype)),"destroy",i).call(i)})),s.svg.addEventListener("mousemove",s.onMouseMove),s.svg.addEventListener("mouseup",s.onMouseUp),s.containerGroup=document.createElementNS(o,"g"),s.shape=function(t){var e=St(t);!function(t){var e=St(t).getAttribute("d");Gu(e)}(t);var n=document.createElementNS(o,"g"),r=e.cloneNode(!0);r.setAttribute("class","a9s-inner");var i=e.cloneNode(!0);return i.setAttribute("class","a9s-outer"),n.appendChild(i),n.appendChild(r),n}(t),s.elementGroup=document.createElementNS(o,"g"),s.elementGroup.setAttribute("class","a9s-annotation editable selected"),s.elementGroup.appendChild(s.shape);var l=Du(s.shape);s.handles=[];var c,f=Ru(l);try{for(f.s();!(c=f.n()).done;){var h=c.value;s.handles.push(h.map((function(t){var e=s.drawHandle(t.x,t.y);return e.addEventListener("mousedown",s.onGrab(e)),s.elementGroup.appendChild(e),e})))}}catch(t){f.e(t)}finally{f.f()}s.containerGroup.appendChild(s.elementGroup),e.appendChild(s.containerGroup),ii(s.shape,t,n.formatter),s.shape.querySelector(".a9s-inner").addEventListener("mousedown",s.onGrab(s.shape));var p=s.shape.querySelector(".a9s-inner").getBBox();return p.x,p.y,p.width,p.height,s.grabbedElem=null,s.grabbedAt=null,s}return e=a,(n=[{key:"element",get:function(){return this.elementGroup}}])&&ju(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Q);function Iu(t){return Iu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iu(t)}function Bu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Xu(r.key),r)}}function Hu(t,e){return Hu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Hu(t,e)}function qu(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zu(t){return zu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},zu(t)}function Fu(t,e,n){return(e=Xu(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xu(t){var e=function(t,e){if("object"!==Iu(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Iu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Iu(e)?e:String(e)}var Yu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Hu(t,e)}(u,t);var e,n,r,i,o=(r=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=zu(r);if(i){var n=zu(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Iu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return qu(t)}(this,t)});function u(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),Fu(qu(r=o.call(this,t,e,n)),"startDrawing",(function(t,e){r._isDrawing=!0,r.attachListeners({mouseMove:r.onMouseMove,mouseUp:r.onMouseUp,dblClick:r.onDblClick}),r.rubberband=new xu([t,e],r.g,r.env)})),Fu(qu(r),"stop",(function(){r.detachListeners(),r._isDrawing=!1,r.rubberband&&(r.rubberband.destroy(),r.rubberband=null)})),Fu(qu(r),"undo",(function(){r.rubberband&&r.rubberband.undo()})),Fu(qu(r),"newPart",(function(){r.rubberband&&r.rubberband.newPart()})),Fu(qu(r),"onMouseMove",(function(t,e){return r.rubberband.dragTo([t,e])})),Fu(qu(r),"onMouseUp",(function(t,e,n){if(n.altKey)r.onDblClick(n);else if(n.ctrlKey)r.rubberband.undo();else{var i=r.rubberband.getBoundingClientRect(),o=i.width,u=i.height,a=r.config.minSelectionWidth||4,s=r.config.minSelectionHeight||4;o>=a||u>=s?r.rubberband.addPoint([t,e]):(r.emit("cancel"),r.stop())}})),Fu(qu(r),"onDblClick",(function(t,e){r._isDrawing=!1,r.rubberband.addPoint([t,e]);var n=r.rubberband.element;n.annotation=r.rubberband.toSelection(),r.emit("complete",n),r.stop()})),Fu(qu(r),"createEditableShape",(function(t){return new Lu(t,r.g,r.config,r.env)})),r._isDrawing=!1,document.addEventListener("keydown",(function(t){"z"==t.key&&t.ctrlKey&&r.undo(),"n"==t.key&&r.newPart()})),r}return e=u,(n=[{key:"isDrawing",get:function(){return this._isDrawing}}])&&Bu(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(F);function Uu(t){return Uu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uu(t)}function Vu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$u(r.key),r)}}function Wu(t,e,n){return(e=$u(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $u(t){var e=function(t,e){if("object"!==Uu(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Uu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Uu(e)?e:String(e)}Yu.identifier="multipolygon",Yu.supports=function(t){return!1};var Zu=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Wu(this,"redraw",(function(){r.mask.setAttribute("d","M0 0 h".concat(r.w," v").concat(r.h," h-").concat(r.w," z M").concat(r.line.getAttribute("x1")," ").concat(r.line.getAttribute("y1")," ").concat(r.line.getAttribute("x2")," ").concat(r.line.getAttribute("y2"),"z"))})),Wu(this,"destroy",(function(){return r.mask.parentNode.removeChild(r.mask)})),this.w=e.naturalWidth,this.h=e.naturalHeight,this.line=n,this.mask=document.createElementNS(o,"path"),this.mask.setAttribute("fill-rule","evenodd"),this.mask.setAttribute("class","a9s-selection-mask"),this.mask.setAttribute("d","M0 0 h".concat(this.w," v").concat(this.h," h-").concat(this.w," z M").concat(this.line.getAttribute("x1")," ").concat(this.line.getAttribute("y1")," z"))}var e,n;return e=t,(n=[{key:"element",get:function(){return this.mask}}])&&Vu(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Qu(t){return Qu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qu(t)}function Ju(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ku(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ju(Object(n),!0).forEach((function(e){na(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ju(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ta(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ea(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ra(r.key),r)}}function na(t,e,n){return(e=ra(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ra(t){var e=function(t,e){if("object"!==Qu(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Qu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Qu(e)?e:String(e)}var ia=function(){function t(e,n,r){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),na(this,"setPoints",(function(t){var e=t;i.outer.setAttribute("x1",e[0]),i.inner.setAttribute("x1",e[0]),i.outer.setAttribute("y1",e[1]),i.inner.setAttribute("y1",e[1]),e.length>2&&(i.outer.setAttribute("x2",e[2]),i.inner.setAttribute("x2",e[2]),i.outer.setAttribute("y2",e[3]),i.inner.setAttribute("y2",e[3]))})),na(this,"getBoundingClientRect",(function(){return i.outer.getBoundingClientRect()})),na(this,"dragTo",(function(t){i.group.style.display=null,i.mousepos=t;var e,n=[].concat(function(t){if(Array.isArray(t))return ta(t)}(e=i.points)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return ta(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ta(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[t[0],t[1]]);i.setPoints(n),i.mask.redraw()})),na(this,"addPoint",(function(t){i.points.length<=2&&(i.points[2]=t[0],i.points[3]=t[1],i.setPoints(i.points))})),na(this,"undo",(function(){i.points[i.points.length-1].length>2?i.points[i.points.length-1].pop():i.points.length>1&&i.points.pop()})),na(this,"newPart",(function(){i.points.push([])})),na(this,"destroy",(function(){i.group.parentNode.removeChild(i.group),i.Line=null,i.group=null})),na(this,"toSelection",(function(){return new A(Ku(Ku({},kt(i.group,i.env.image)),{},{renderedVia:{name:"line"}}))})),this.points=e,this.env=r,this.group=document.createElementNS(o,"g"),this.Line=document.createElementNS(o,"g"),this.Line.setAttribute("class","a9s-selection"),this.outer=document.createElementNS(o,"line"),this.outer.setAttribute("class","a9s-outer"),this.inner=document.createElementNS(o,"line"),this.inner.setAttribute("class","a9s-inner"),this.setPoints(this.points),this.mask=new Zu(r.image,this.inner),this.Line.appendChild(this.outer),this.Line.appendChild(this.inner),this.group.style.display="none",this.group.appendChild(this.mask.element),this.group.appendChild(this.Line),n.appendChild(this.group)}var e,n;return e=t,(n=[{key:"element",get:function(){return this.Line}}])&&ea(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function oa(t){return oa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oa(t)}function ua(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function aa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,pa(r.key),r)}}function sa(t,e){return sa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},sa(t,e)}function la(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ca(){return ca="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=fa(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ca.apply(this,arguments)}function fa(t){return fa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fa(t)}function ha(t,e,n){return(e=pa(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pa(t){var e=function(t,e){if("object"!==oa(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==oa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===oa(e)?e:String(e)}var ya=function(t){var e=t.querySelector(".a9s-inner");return[[e.x1.baseVal,e.y1.baseVal],[e.x2.baseVal,e.y2.baseVal]]},da=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sa(t,e)}(a,t);var e,n,r,i,u=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=fa(r);if(i){var n=fa(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===oa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return la(t)}(this,t)});function a(t,e,n,r){var i,s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),ha(la(s=u.call(this,t,e,n,r)),"onScaleChanged",(function(){return s.handles.map(s.scaleHandle)})),ha(la(s),"setPoints",(function(t){var e=t[0].x,n=t[0].y,r=t[1].x,i=t[1].y,o=s.shape.querySelector(".a9s-inner");o.setAttribute("x1",e),o.setAttribute("y1",n),o.setAttribute("x2",r),o.setAttribute("y2",i);var u=s.shape.querySelector(".a9s-outer");u.setAttribute("x1",e),u.setAttribute("y1",n),u.setAttribute("x2",r),u.setAttribute("y2",i),s.mask.redraw();var a=u.getBBox(),l=a.x,c=a.y,f=a.width,h=a.height;oi(s.elementGroup,l,c,f,h)})),ha(la(s),"onGrab",(function(t){return function(e){0===e.button&&(s.grabbedElem=t,s.grabbedAt=s.getSVGPoint(e))}})),ha(la(s),"onMouseMove",(function(t){var e=function(t,e,n){return t+e<0?-t:t+e>n?n-t:e};if(s.grabbedElem){var n=s.getSVGPoint(t);if(s.grabbedElem===s.shape){var r=s.shape.querySelector(".a9s-inner").getBBox(),i=r.x,o=r.y,u=r.width,a=r.height,l=s.env.image,c=l.naturalWidth,f=l.naturalHeight,h=e(i,n.x-s.grabbedAt.x,c-u),p=e(o,n.y-s.grabbedAt.y,f-a),y=ya(s.shape).map((function(t){return{x:t[0].value+h,y:t[1].value+p}}));s.grabbedAt=n,s.setPoints(y),y.forEach((function(t,e){return s.setHandleXY(s.handles[e],t.x,t.y)})),s.emit("update",kt(s.shape,s.env.image))}else{var d=s.handles.indexOf(s.grabbedElem),v=ya(s.shape).map((function(t,e){return e===d?n:{x:t[0].value,y:t[1].value}}));s.setPoints(v),s.setHandleXY(s.handles[d],n.x,n.y),s.emit("update",kt(s.shape,s.env.image))}}})),ha(la(s),"onMouseUp",(function(t){s.grabbedElem=null,s.grabbedAt=null})),ha(la(s),"updateState",(function(t){var e=St(t).getAttribute("points").split(" ").map((function(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,u,a=[],s=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);s=!0);}catch(t){l=!0,i=t}finally{try{if(!s&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(l)throw i}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ua(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ua(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t.split(",").map((function(t){return parseFloat(t.trim())})),2);return{x:e[0],y:e[1]}}));s.setPoints(e),e.forEach((function(t,e){return s.setHandleXY(s.handles[e],t.x,t.y)}))})),ha(la(s),"destroy",(function(){s.containerGroup.parentNode.removeChild(s.containerGroup),ca((i=la(s),fa(a.prototype)),"destroy",i).call(i)})),s.svg.addEventListener("mousemove",s.onMouseMove),s.svg.addEventListener("mouseup",s.onMouseUp),s.containerGroup=document.createElementNS(o,"g"),s.shape=_t(t),s.shape.querySelector(".a9s-inner").addEventListener("mousedown",s.onGrab(s.shape)),s.mask=new Zu(r.image,s.shape.querySelector(".a9s-inner")),s.containerGroup.appendChild(s.mask.element),s.elementGroup=document.createElementNS(o,"g"),s.elementGroup.setAttribute("class","a9s-annotation editable selected"),s.elementGroup.setAttribute("data-id",t.id),s.elementGroup.appendChild(s.shape),s.handles=ya(s.shape).map((function(t){var e=s.drawHandle(t[0].value,t[1].value);return e.addEventListener("mousedown",s.onGrab(e)),s.elementGroup.appendChild(e),e})),s.containerGroup.appendChild(s.elementGroup),e.appendChild(s.containerGroup),ii(s.shape,t,n.formatters),s.grabbedElem=null,s.grabbedAt=null,s}return e=a,(n=[{key:"element",get:function(){return this.elementGroup}}])&&aa(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Q);function va(t){return va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},va(t)}function ba(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,xa(r.key),r)}}function ma(t,e){return ma=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ma(t,e)}function ga(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wa(t){return wa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wa(t)}function Oa(t,e,n){return(e=xa(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xa(t){var e=function(t,e){if("object"!==va(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==va(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===va(e)?e:String(e)}var Sa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ma(t,e)}(u,t);var e,n,r,i,o=(r=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=wa(r);if(i){var n=wa(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===va(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ga(t)}(this,t)});function u(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),Oa(ga(r=o.call(this,t,e,n)),"startDrawing",(function(t,e){r._isDrawing=!0,r.attachListeners({mouseMove:r.onMouseMove,mouseUp:r.onMouseUp}),r.rubberband=new ia([t,e],r.g,r.env)})),Oa(ga(r),"stop",(function(){r.detachListeners(),r._isDrawing=!1,r.rubberband&&(r.rubberband.destroy(),r.rubberband=null)})),Oa(ga(r),"undo",(function(){r.rubberband&&r.rubberband.undo()})),Oa(ga(r),"newPart",(function(){r.rubberband&&r.rubberband.newPart()})),Oa(ga(r),"onMouseMove",(function(t,e){return r.rubberband.dragTo([t,e])})),Oa(ga(r),"onMouseUp",(function(t,e,n){if(n.altKey)r.onDblClick(n);else if(n.ctrlKey)r.rubberband.undo();else if(2==r.rubberband.points.length)if(r.rubberband.addPoint([t,e]),r.rubberband.points[0]==r.rubberband.points[2]&&r.rubberband.points[1]==r.rubberband.points[3])r.emit("cancel"),r.stop();else{r._isDrawing=!1;var i=r.rubberband.element;i.annotation=r.rubberband.toSelection(),r.emit("complete",i),r.stop()}})),Oa(ga(r),"createEditableShape",(function(t){return new da(t,r.g,r.config,r.env)})),r._isDrawing=!1,document.addEventListener("keydown",(function(t){"z"==t.key&&t.ctrlKey&&r.undo(),"n"==t.key&&r.newPart()})),r}return e=u,(n=[{key:"isDrawing",get:function(){return this._isDrawing}}])&&ba(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(F);Sa.identifier="line",Sa.supports=function(t){var e,n=t.selector("SvgSelector");if(n)return null===(e=n.value)||void 0===e?void 0:e.match(/^<svg.*<line/g)};var _a=new Set(["point","circle","ellipse","freehand","line","pinpoint"]);const ka=function(t,e){(null!=e&&e.tools?e.tools.map((function(t){return t.toLowerCase()})):_a).forEach((function(e){"point"===e&&t.addDrawingTool(Ot),"pinpoint"===e&&t.addDrawingTool(_i),"circle"===e&&t.addDrawingTool(no),"ellipse"===e&&t.addDrawingTool(Do),"freehand"===e&&t.addDrawingTool(uu),"multipolygon"===e&&t.addDrawingTool(Yu),"line"===e&&t.addDrawingTool(Sa)}))}})(),r.default})()));
//# sourceMappingURL=annotorious-selector-pack.js.map