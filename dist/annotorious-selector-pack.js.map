{"version":3,"file":"annotorious-selector-pack.js","mappings":"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","sources":["webpack://Annotorious.SelectorPack/webpack/universalModuleDefinition","webpack://Annotorious.SelectorPack/./node_modules/fast-deep-equal/index.js","webpack://Annotorious.SelectorPack/./node_modules/tiny-emitter/index.js","webpack://Annotorious.SelectorPack/webpack/bootstrap","webpack://Annotorious.SelectorPack/webpack/runtime/compat get default export","webpack://Annotorious.SelectorPack/webpack/runtime/define property getters","webpack://Annotorious.SelectorPack/webpack/runtime/hasOwnProperty shorthand","webpack://Annotorious.SelectorPack/./node_modules/uuid/dist/esm-browser/rng.js","webpack://Annotorious.SelectorPack/./node_modules/@recogito/annotorious/src/util/SVG.js","webpack://Annotorious.SelectorPack/./node_modules/uuid/dist/esm-browser/regex.js","webpack://Annotorious.SelectorPack/./node_modules/uuid/dist/esm-browser/stringify.js","webpack://Annotorious.SelectorPack/./node_modules/uuid/dist/esm-browser/validate.js","webpack://Annotorious.SelectorPack/./node_modules/uuid/dist/esm-browser/v4.js","webpack://Annotorious.SelectorPack/./node_modules/@recogito/recogito-client-core/src/WebAnnotation.js","webpack://Annotorious.SelectorPack/./node_modules/@recogito/recogito-client-core/src/Selection.js","webpack://Annotorious.SelectorPack/./node_modules/@recogito/annotorious/src/tools/Tool.js","webpack://Annotorious.SelectorPack/./node_modules/@recogito/annotorious/src/util/Touch.js","webpack://Annotorious.SelectorPack/./node_modules/@recogito/annotorious/src/tools/EditableShape.js","webpack://Annotorious.SelectorPack/./node_modules/@recogito/annotorious/src/selectors/RectFragment.js","webpack://Annotorious.SelectorPack/./src/point/Point.js","webpack://Annotorious.SelectorPack/./src/point/EditablePoint.js","webpack://Annotorious.SelectorPack/./src/point/PointTool.js","webpack://Annotorious.SelectorPack/./node_modules/@recogito/annotorious/src/selectors/EmbeddedSVG.js","webpack://Annotorious.SelectorPack/../src/utils/methods.js","webpack://Annotorious.SelectorPack/../src/utils/utils.js","webpack://Annotorious.SelectorPack/../src/modules/core/namespaces.js","webpack://Annotorious.SelectorPack/../src/utils/window.js","webpack://Annotorious.SelectorPack/../src/types/Base.js","webpack://Annotorious.SelectorPack/../src/utils/adopter.js","webpack://Annotorious.SelectorPack/../src/modules/optional/arrange.js","webpack://Annotorious.SelectorPack/../src/modules/core/regex.js","webpack://Annotorious.SelectorPack/../src/types/Color.js","webpack://Annotorious.SelectorPack/../src/modules/optional/class.js","webpack://Annotorious.SelectorPack/../src/modules/optional/css.js","webpack://Annotorious.SelectorPack/../src/modules/optional/data.js","webpack://Annotorious.SelectorPack/../src/modules/optional/memory.js","webpack://Annotorious.SelectorPack/../src/types/Point.js","webpack://Annotorious.SelectorPack/../src/types/Matrix.js","webpack://Annotorious.SelectorPack/../src/modules/core/parser.js","webpack://Annotorious.SelectorPack/../src/types/Box.js","webpack://Annotorious.SelectorPack/../src/types/List.js","webpack://Annotorious.SelectorPack/../src/modules/core/selector.js","webpack://Annotorious.SelectorPack/../src/modules/core/event.js","webpack://Annotorious.SelectorPack/../src/types/EventTarget.js","webpack://Annotorious.SelectorPack/../src/modules/core/defaults.js","webpack://Annotorious.SelectorPack/../src/types/SVGArray.js","webpack://Annotorious.SelectorPack/../src/types/SVGNumber.js","webpack://Annotorious.SelectorPack/../src/modules/core/attr.js","webpack://Annotorious.SelectorPack/../src/elements/Dom.js","webpack://Annotorious.SelectorPack/../src/elements/Element.js","webpack://Annotorious.SelectorPack/../src/modules/optional/sugar.js","webpack://Annotorious.SelectorPack/../src/modules/optional/transform.js","webpack://Annotorious.SelectorPack/../src/elements/Container.js","webpack://Annotorious.SelectorPack/../src/elements/Defs.js","webpack://Annotorious.SelectorPack/../src/elements/Shape.js","webpack://Annotorious.SelectorPack/../src/modules/core/circled.js","webpack://Annotorious.SelectorPack/../src/elements/Ellipse.js","webpack://Annotorious.SelectorPack/../src/elements/Fragment.js","webpack://Annotorious.SelectorPack/../src/modules/core/gradiented.js","webpack://Annotorious.SelectorPack/../src/elements/Gradient.js","webpack://Annotorious.SelectorPack/../src/elements/Pattern.js","webpack://Annotorious.SelectorPack/../src/elements/Image.js","webpack://Annotorious.SelectorPack/../src/types/PointArray.js","webpack://Annotorious.SelectorPack/../src/modules/core/pointed.js","webpack://Annotorious.SelectorPack/../src/elements/Line.js","webpack://Annotorious.SelectorPack/../src/elements/Marker.js","webpack://Annotorious.SelectorPack/../src/animation/Controller.js","webpack://Annotorious.SelectorPack/../src/utils/pathParser.js","webpack://Annotorious.SelectorPack/../src/types/PathArray.js","webpack://Annotorious.SelectorPack/../src/animation/Morphable.js","webpack://Annotorious.SelectorPack/../src/elements/Path.js","webpack://Annotorious.SelectorPack/../src/modules/core/poly.js","webpack://Annotorious.SelectorPack/../src/elements/Polygon.js","webpack://Annotorious.SelectorPack/../src/elements/Polyline.js","webpack://Annotorious.SelectorPack/../src/elements/Rect.js","webpack://Annotorious.SelectorPack/../src/animation/Queue.js","webpack://Annotorious.SelectorPack/../src/animation/Animator.js","webpack://Annotorious.SelectorPack/../src/animation/Timeline.js","webpack://Annotorious.SelectorPack/../src/animation/Runner.js","webpack://Annotorious.SelectorPack/../src/elements/Svg.js","webpack://Annotorious.SelectorPack/../src/elements/Symbol.js","webpack://Annotorious.SelectorPack/../src/modules/core/textable.js","webpack://Annotorious.SelectorPack/../src/elements/Text.js","webpack://Annotorious.SelectorPack/../src/elements/Tspan.js","webpack://Annotorious.SelectorPack/../src/elements/Circle.js","webpack://Annotorious.SelectorPack/../src/elements/ClipPath.js","webpack://Annotorious.SelectorPack/../src/elements/ForeignObject.js","webpack://Annotorious.SelectorPack/../src/modules/core/containerGeometry.js","webpack://Annotorious.SelectorPack/../src/elements/G.js","webpack://Annotorious.SelectorPack/../src/elements/A.js","webpack://Annotorious.SelectorPack/../src/elements/Mask.js","webpack://Annotorious.SelectorPack/../src/elements/Stop.js","webpack://Annotorious.SelectorPack/../src/elements/Style.js","webpack://Annotorious.SelectorPack/../src/elements/TextPath.js","webpack://Annotorious.SelectorPack/../src/elements/Use.js","webpack://Annotorious.SelectorPack/../src/main.js","webpack://Annotorious.SelectorPack/./src/pinpoint/Pin.js","webpack://Annotorious.SelectorPack/./src/pinpoint/Pinpoint.js","webpack://Annotorious.SelectorPack/./node_modules/@recogito/annotorious/src/util/Formatting.js","webpack://Annotorious.SelectorPack/./src/pinpoint/EditablePinpoint.js","webpack://Annotorious.SelectorPack/./src/pinpoint/PinpointTool.js","webpack://Annotorious.SelectorPack/./src/circle/Circle.js","webpack://Annotorious.SelectorPack/./src/circle/CircleMask.js","webpack://Annotorious.SelectorPack/./src/circle/RubberbandCircle.js","webpack://Annotorious.SelectorPack/./src/circle/EditableCircle.js","webpack://Annotorious.SelectorPack/./src/circle/RubberbandCircleTool.js","webpack://Annotorious.SelectorPack/./src/ellipse/Ellipse.js","webpack://Annotorious.SelectorPack/./src/ellipse/EllipseMask.js","webpack://Annotorious.SelectorPack/./src/ellipse/RubberbandEllipse.js","webpack://Annotorious.SelectorPack/./src/ellipse/EditableEllipse.js","webpack://Annotorious.SelectorPack/./src/ellipse/RubberbandEllipseTool.js","webpack://Annotorious.SelectorPack/./src/freehand/RubberbandFreehand.js","webpack://Annotorious.SelectorPack/./src/freehand/EditableFreehand.js","webpack://Annotorious.SelectorPack/./src/freehand/RubberbandFreehandTool.js","webpack://Annotorious.SelectorPack/./node_modules/@recogito/annotorious/src/tools/polygon/PolygonMask.js","webpack://Annotorious.SelectorPack/./src/multipolygon/RubberbandMultipolygon.js","webpack://Annotorious.SelectorPack/./src/multipolygon/EditableMultipolygon.js","webpack://Annotorious.SelectorPack/./src/multipolygon/RubberbandMultipolygonTool.js","webpack://Annotorious.SelectorPack/./src/line/LineMask.js","webpack://Annotorious.SelectorPack/./src/line/RubberbandLine.js","webpack://Annotorious.SelectorPack/./src/line/EditableLine.js","webpack://Annotorious.SelectorPack/./src/line/RubberbandLineTool.js","webpack://Annotorious.SelectorPack/./src/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Annotorious\"] = factory();\n\telse\n\t\troot[\"Annotorious\"] = root[\"Annotorious\"] || {}, root[\"Annotorious\"][\"SelectorPack\"] = factory();\n})(self, () => {\nreturn ","'use strict';\n\n// do not edit .js files directly - edit src/index.jst\n\n\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;)\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  // true if both NaN, false otherwise\n  return a!==a && b!==b;\n};\n","function E () {\n  // Keep this empty so it's easier to inherit from\n  // (via https://github.com/lipsmack from https://github.com/scottcorgan/tiny-emitter/issues/3)\n}\n\nE.prototype = {\n  on: function (name, callback, ctx) {\n    var e = this.e || (this.e = {});\n\n    (e[name] || (e[name] = [])).push({\n      fn: callback,\n      ctx: ctx\n    });\n\n    return this;\n  },\n\n  once: function (name, callback, ctx) {\n    var self = this;\n    function listener () {\n      self.off(name, listener);\n      callback.apply(ctx, arguments);\n    };\n\n    listener._ = callback\n    return this.on(name, listener, ctx);\n  },\n\n  emit: function (name) {\n    var data = [].slice.call(arguments, 1);\n    var evtArr = ((this.e || (this.e = {}))[name] || []).slice();\n    var i = 0;\n    var len = evtArr.length;\n\n    for (i; i < len; i++) {\n      evtArr[i].fn.apply(evtArr[i].ctx, data);\n    }\n\n    return this;\n  },\n\n  off: function (name, callback) {\n    var e = this.e || (this.e = {});\n    var evts = e[name];\n    var liveEvents = [];\n\n    if (evts && callback) {\n      for (var i = 0, len = evts.length; i < len; i++) {\n        if (evts[i].fn !== callback && evts[i].fn._ !== callback)\n          liveEvents.push(evts[i]);\n      }\n    }\n\n    // Remove event from queue to prevent memory leak\n    // Suggested by https://github.com/lazd\n    // Ref: https://github.com/scottcorgan/tiny-emitter/commit/c6ebfaa9bc973b33d110a84a307742b7cf94c953#commitcomment-5024910\n\n    (liveEvents.length)\n      ? e[name] = liveEvents\n      : delete e[name];\n\n    return this;\n  }\n};\n\nmodule.exports = E;\nmodule.exports.TinyEmitter = E;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nvar getRandomValues;\nvar rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n    // find the complete implementation of crypto (msCrypto) on IE11.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","export const SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\n\nconst getClassNames = el => {\n  const attr = el.getAttribute('class');\n  return attr ? new Set(attr.split(' ')) : new Set();\n}\n\n// IE11 doesn't support adding/removing classes to SVG elements except \n// via .setAttribute\nexport const addClass = (el, className) => {\n  const classNames = getClassNames(el);\n  classNames.add(className);\n  el.setAttribute('class', Array.from(classNames).join(' '));\n}\n\nexport const removeClass = (el, className) => {\n  const classNames = getClassNames(el);\n  classNames.delete(className);\n\n  if (classNames.size === 0)\n    el.removeAttribute('class');\n  else\n    el.setAttribute('class', Array.from(classNames).join(' '));\n}\n\nexport const hasClass = (el, className) =>\n  getClassNames(el).has(className);","export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).substr(1));\n}\n\nfunction stringify(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  var uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","import REGEX from './regex.js';\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\nexport default validate;","import rng from './rng.js';\nimport stringify from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return stringify(rnds);\n}\n\nexport default v4;","import { v4 as uuid } from 'uuid';\nimport equals from 'fast-deep-equal';\n\nexport default class WebAnnotation {\n\n  constructor(annotation, opts) {\n    this.underlying = annotation;\n    this.opts = opts;\n  }\n\n  /** For convenience - creates an empty web annotation **/\n  static create = args => {\n    const stub = {\n      '@context': 'http://www.w3.org/ns/anno.jsonld',\n      'type': 'Annotation',\n      'id': `#${uuid()}`,\n      'body': []\n    };\n\n    return new WebAnnotation({ ...stub, ...args });\n  }\n\n  /** Creates a copy of this annotation **/\n  clone = (opt_props, opt_opts) => {\n    return new WebAnnotation({ ...this.underlying, ...opt_props}, { ...this.opts, ...opt_opts });\n  }\n\n  /** An equality check based on the underlying object **/\n  isEqual(other) {\n    if (other?.type !== 'Annotation') {\n      return false;\n    } else if (this.underlying === other.underlying) {\n      return true;\n    } else if (!this.underlying.id || !other.underlying.id) {\n      return false;\n    } else {\n      return equals(this.underlying, other.underlying);\n    }\n  }\n\n  get readOnly() {\n    return this.opts?.readOnly;\n  }\n\n  /*************************************/\n  /* Getters to forward properties of  */\n  /* the underlying annotation         */\n  /*************************************/\n\n  get id() {\n    return this.underlying.id;\n  }\n\n  get context() {\n    return this.underlying['@context'];\n  }\n\n  get type() {\n    return this.underlying.type;\n  }\n\n  get motivation() {\n    return this.underlying.motivation;\n  }\n\n  get body() {\n    return this.underlying.body;\n  }\n\n  get target() {\n    return this.underlying.target;\n  }\n\n  /** Same as .body, but guaranteed to return an array **/\n  get bodies() {\n    return (Array.isArray(this.underlying.body)) ?\n      this.underlying.body : [ this.underlying.body ];\n  }\n\n  /** Only bodies are meant to be mutated by the application **/\n  set bodies(bodies) {\n    this.underlying.body = bodies;\n  }\n\n  /** Same as .target, but guaranteed to return an array **/\n  get targets() {\n    return (Array.isArray(this.underlying.target)) ?\n      this.underlying.target : [ this.underlying.target ];\n  }\n\n  /*****************************************/\n  /* Various access helpers and shorthands */\n  /*****************************************/\n\n  /** Selector of the given type **/\n  selector = type => {\n    const { target } = this.underlying;\n\n    if (target.selector) {\n      // Normalize to array\n      const selectors = Array.isArray(target.selector) ?\n        target.selector : [ target.selector ];\n\n      return selectors.find(s => s.type === type);\n    }\n  }\n\n  /** Shorthand for the 'exact' field of the TextQuoteSelector **/\n  get quote() {\n    return this.selector('TextQuoteSelector')?.exact;\n  }\n\n  /** Shorthand for the 'start' field of the TextPositionSelector **/\n  get start() {\n    return this.selector('TextPositionSelector')?.start;\n  }\n\n  /** Shorthand for the 'end' field of the TextPositionSelector **/\n  get end() {\n    return this.selector('TextPositionSelector')?.end;\n  }\n\n}\n","import WebAnnotation from './WebAnnotation';\nimport { v4 as uuid } from 'uuid';\nimport equals from 'fast-deep-equal';\n\n/**\n * An \"annotation in draft mode\". Really the same\n * data structure, but as a separate class so we can\n * tell things apart properly.\n */\nexport default class Selection {\n\n  constructor(target, body) {\n    this.underlying = {\n      '@context': 'http://www.w3.org/ns/anno.jsonld',\n      type: 'Selection',\n      body: body || [],\n      target\n    }\n  }\n\n  /** Creates a copy of this selection **/\n  clone = opt_props => {\n    // Deep-clone\n    const cloned = new Selection();\n    cloned.underlying = JSON.parse(JSON.stringify(this.underlying));\n\n    if (opt_props)\n      cloned.underlying = { ...cloned.underlying, ...opt_props };\n\n    return cloned;\n  }\n\n  get context() {\n    return this.underlying['@context'];\n  }\n\n  get type() {\n    return this.underlying.type;\n  }\n\n  get body() {\n    return this.underlying.body;\n  }\n\n  get target() {\n    return this.underlying.target;\n  }\n\n  get targets() {\n    return (Array.isArray(this.underlying.target)) ?\n      this.underlying.target : [ this.underlying.target ];\n  }\n\n  /** For consistency with WebAnnotation **/\n  isEqual(other) {\n    if (!other) {\n      return false;\n    } else {\n      return equals(this.underlying, other.underlying);\n    }\n  }\n\n  get bodies() {\n    return (Array.isArray(this.underlying.body)) ?\n      this.underlying.body : [ this.underlying.body ];\n  }\n\n  selector = type => {\n    const { target } = this.underlying;\n\n    if (target.selector) {\n      // Normalize to array\n      const selectors = Array.isArray(target.selector) ?\n        target.selector : [ target.selector ];\n\n      return selectors.find(s => s.type === type);\n    }\n  }\n\n  /** Shorthand for the 'exact' field of the TextQuoteSelector **/\n  get quote() {\n    return this.selector('TextQuoteSelector')?.exact;\n  }\n\n  /*******************************************/\n  /* Selection-specific properties & methods */\n  /*******************************************/\n\n  get isSelection() {\n    return true;\n  }\n\n  toAnnotation = () => {\n    const a = Object.assign({}, this.underlying, {\n      'type': 'Annotation',\n      'id': `#${uuid()}`\n    });\n\n    return new WebAnnotation(a);\n  }\n\n}\n","import EventEmitter from 'tiny-emitter';\nimport { isTouchDevice } from '../util/Touch';\nimport { SVG_NAMESPACE } from '../util/SVG';\n\nconst IMPLEMENTATION_MISSING = \"An implementation is missing\";\n\nconst isTouch = isTouchDevice();\n\n/**\n * A commmon base class for Tools and EditableShapes\n */\nexport class ToolLike extends EventEmitter {\n\n  constructor(g, config, env) {\n    super();\n\n    this.svg = g.closest('svg');\n\n    this.g = g;\n    this.config = config;\n    this.env = env;\n\n    // Default image scale\n    this.scale = 1;\n\n    // Bit of a hack. If we are dealing with a 'real' image, we enable\n    // reponsive mode. OpenSeadragon handles scaling in a different way,\n    // so we don't need responsive mode.\n    const { image } = env;\n    if (image instanceof Element || image instanceof HTMLDocument)\n      this.enableResponsive();\n  }\n\n  /**\n   * Implementations MAY extend this (calling super),\n   * to destroy SVG elements, mask, etc.\n   */\n  destroy() {\n    if (this.resizeObserver)\n      this.resizeObserver.disconnect();\n\n    this.resizeObserver = null;\n  }\n\n  enableResponsive = () => {\n    if (window.ResizeObserver) {\n      this.resizeObserver = new ResizeObserver(() => {\n        const svgBounds = this.svg.getBoundingClientRect();\n        const { width, height } = this.svg.viewBox.baseVal;\n\n        this.scale = Math.max(\n          width / svgBounds.width,\n          height / svgBounds.height\n        );\n\n        if (this.onScaleChanged)\n          this.onScaleChanged(this.scale);\n      });\n\n      this.resizeObserver.observe(this.svg.parentNode);\n    }\n  }\n\n  getSVGPoint = evt => {\n    const pt = this.svg.createSVGPoint();\n\n    if (isTouch) {\n      const bbox = this.svg.getBoundingClientRect();\n\n      const x = evt.clientX - bbox.x;\n      const y = evt.clientY - bbox.y;\n\n      const { left, top } = this.svg.getBoundingClientRect();\n      pt.x = x + left;\n      pt.y = y + top;\n\n      return pt.matrixTransform(this.g.getScreenCTM().inverse());\n    } else {\n      pt.x = evt.offsetX;\n      pt.y = evt.offsetY;\n\n      return pt.matrixTransform(this.g.getCTM().inverse());\n    }\n  }\n\n  /*********************************/\n  /*  Helpers for drawing handles  */\n  /*********************************/\n\n  drawHandle = (x, y) => {\n    const containerGroup = document.createElementNS(SVG_NAMESPACE, 'g');\n    containerGroup.setAttribute('class', 'a9s-handle');\n\n    const group = document.createElementNS(SVG_NAMESPACE, 'g');\n\n    const drawCircle = r => {\n      const c = document.createElementNS(SVG_NAMESPACE, 'circle');\n      c.setAttribute('cx', x);\n      c.setAttribute('cy', y);\n      c.setAttribute('r', r);\n      c.setAttribute('transform-origin', `${x} ${y}`);\n      return c;\n    }\n\n    const radius = this.config.handleRadius || 6;\n\n    const inner = drawCircle(radius);\n    inner.setAttribute('class', 'a9s-handle-inner')\n\n    const outer = drawCircle(radius + 1);\n    outer.setAttribute('class', 'a9s-handle-outer')\n\n    group.appendChild(outer);\n    group.appendChild(inner);\n\n    containerGroup.appendChild(group);\n    return containerGroup;\n  }\n\n  setHandleXY = (handle, x, y) => {\n    const inner = handle.querySelector('.a9s-handle-inner');\n    inner.setAttribute('cx', x);\n    inner.setAttribute('cy', y);\n    inner.setAttribute('transform-origin', `${x} ${y}`);\n\n    const outer = handle.querySelector('.a9s-handle-outer');\n    outer.setAttribute('cx', x);\n    outer.setAttribute('cy', y);\n    outer.setAttribute('transform-origin', `${x} ${y}`);\n  }\n\n  getHandleXY = handle => {\n    const outer = handle.querySelector('.a9s-handle-outer');\n    return {\n      x: parseFloat(outer.getAttribute('cx')),\n      y: parseFloat(outer.getAttribute('cy'))\n    }\n  }\n\n  scaleHandle = handle => {\n    const inner = handle.querySelector('.a9s-handle-inner');\n    const outer = handle.querySelector('.a9s-handle-outer');\n\n    const radius = this.scale * (this.config.handleRadius || 6);\n\n    inner.setAttribute('r', radius);\n    outer.setAttribute('r', radius);\n  }\n\n}\n\n/**\n * Base class that adds some convenience stuff for tool plugins.\n */\nexport default class Tool extends ToolLike {\n\n  constructor(g, config, env) {\n    super(g, config, env);\n\n    // We'll keep a flag set to false until\n    // the user has started moving, so we can\n    // fire the startSelection event\n    this.started = false;\n  }\n\n  attachListeners = ({ mouseMove, mouseUp, dblClick }) => {\n    // Handle SVG conversion on behalf of tool implementations\n    if (mouseMove) {\n      this.mouseMove = evt => {\n        const { x , y } = this.getSVGPoint(evt);\n\n        if (!this.started) {\n          this.emit('startSelection', { x, y });\n          this.started = true;\n        }\n\n        mouseMove(x, y, evt);\n      }\n\n      // Mouse move goes on SVG element\n      this.svg.addEventListener('mousemove', this.mouseMove);\n    }\n\n    if (mouseUp) {\n      this.mouseUp = evt => {\n        if (evt.button !== 0) return;  // left click\n        const { x , y } = this.getSVGPoint(evt);\n        mouseUp(x, y, evt);\n      }\n\n      // Mouse up goes on doc, so we capture events outside, too\n      document.addEventListener('mouseup', this.mouseUp);\n    }\n\n    if (dblClick) {\n      this.dblClick = evt => {\n        const { x , y } = this.getSVGPoint(evt);\n        dblClick(x, y, evt);\n      }\n\n      document.addEventListener('dblclick', this.dblClick);\n    }\n\n  }\n\n  detachListeners = () => {\n    if (this.mouseMove)\n      this.svg.removeEventListener('mousemove', this.mouseMove);\n\n    if (this.mouseUp)\n      document.removeEventListener('mouseup', this.mouseUp);\n\n    if (this.dblClick)\n      document.removeEventListener('dblclick', this.dblClick);\n  }\n\n  /**\n   * If startOnSingleClick is true, the tool starts on single click\n   * as well as drag. If false, starting strictly requires drag!\n   */\n  start = (evt, startOnSingleClick) => {\n    // Handle SVG conversion on behalf of tool implementations\n    const { x , y } = this.getSVGPoint(evt);\n    this.startDrawing(x, y, startOnSingleClick, evt);\n  }\n\n  /**\n   * Tool implementations MUST override these\n   */\n\n  get isDrawing() {\n    throw new Error(IMPLEMENTATION_MISSING);\n  }\n\n  startDrawing = evt => {\n    throw new Error(IMPLEMENTATION_MISSING);\n  }\n\n  createEditableShape = (annotation, formatters) => {\n    throw new Error(IMPLEMENTATION_MISSING);\n  }\n\n}\n\n// In addition, Tool implementations need to implement the following static methods\n\n// Tool.identifier = '...'\n\nTool.supports = annotation => {\n  throw new Error(IMPLEMENTATION_MISSING);\n}\n\n// Just some convenience shortcuts to client-core, for quicker\n// importing in plugins. (In a way, the intention is to make the\n// Tool class serve as a kind of mini-SDK).\nexport { default as Selection } from '@recogito/recogito-client-core/src/Selection';\nexport { default as WebAnnotation } from '@recogito/recogito-client-core/src/WebAnnotation';\n","const SIM_EVENTS = {\n  touchstart: 'mousedown',\n  touchmove: 'mousemove',\n  touchend: 'mouseup'\n}\n\nexport const isTouchDevice = () =>\n  'ontouchstart' in window ||\n    navigator.maxTouchPoints > 0 ||\n      navigator.msMaxTouchPoints > 0;\n\nexport const enableTouchTranslation = el => {\n\n  let pressAndHoldTrigger = null;\n\n  const simulateEvent = (type, e) => new MouseEvent(type, {\n    screenX: e.screenX,\n    screenY: e.screenY,\n    clientX: e.clientX,\n    clientY: e.clientY,\n    pageX: e.pageX,\n    pageY: e.pageY,\n    bubbles: true\n  });\n\n  const touchHandler = evt => {\n    const touch = evt.changedTouches[0];\n    const simulatedEvent = simulateEvent(SIM_EVENTS[evt.type], touch);\n\n    touch.target.dispatchEvent(simulatedEvent);\n    evt.preventDefault();\n\n    if (evt.type === 'touchstart' || evt.type === 'touchmove') {\n      pressAndHoldTrigger && clearTimeout(pressAndHoldTrigger);\n\n      pressAndHoldTrigger = setTimeout(() => {\n        const simulatedEvent = simulateEvent('dblclick', touch);\n        touch.target.dispatchEvent(simulatedEvent);\n      }, 800);\n    }\n\n    if (evt.type === 'touchend')\n      pressAndHoldTrigger && clearTimeout(pressAndHoldTrigger);\n  }\n\n  el.addEventListener('touchstart', touchHandler, true);\n  el.addEventListener('touchmove', touchHandler, true);\n  el.addEventListener('touchend', touchHandler, true);\n  el.addEventListener('touchcancel', touchHandler, true);\n\n}","import { ToolLike } from './Tool';\n\nconst IMPLEMENTATION_MISSING = \"An implementation is missing\";\n\nexport default class EditableShape extends ToolLike {\n\n  constructor(annotation, g, config, env) {\n    super(g, config, env);\n\n    this.annotation = annotation;\n  }\n  \n  /**\n   * Implementations MUST override this method!\n   * \n   * Must return the 'g' element with the a9s-annotation class.\n   */\n  get element() {\n    throw new Error(IMPLEMENTATION_MISSING);\n  }\n\n  /**\n   * Implementations MUST override this method!\n   * \n   * The annotation argument MUST be used to update\n   * the current state of the shape. It MUST NOT\n   * be stored as 'this.annotation'! 'this.annotation'\n   * MUST remain the original annotation at the time\n   * this EditableShape was created, because we will\n   * need it again in case the user cancels editing.\n   * \n   * Thinking of it in React terms, 'this.annotation'\n   * has the same purpose as props.annotation, whereas\n   * this method affects state.\n   */\n  updateState = annotation => {\n    throw new Error(IMPLEMENTATION_MISSING);\n  }\n\n}\n","import { SVG_NAMESPACE, addClass } from '../util/SVG';\n\n/** \n * Parses a W3C Web Annotation FragmentSelector conforming\n * to the Media Fragments spec. Supports (well-formed) xywh=pixel\n * and xywh=percent fragments. \n */\nexport const parseRectFragment = (annotation, image) => {\n  const selector = annotation.selector('FragmentSelector');\n\n  if (selector?.conformsTo.startsWith('http://www.w3.org/TR/media-frags')) {\n    const { value } = selector;\n  \n    const format = value.includes(':') ? value.substring(value.indexOf('=') + 1, value.indexOf(':')) : 'pixel';\n    const coords = value.includes(':') ? value.substring(value.indexOf(':') + 1) : value.substring(value.indexOf('=') + 1);\n\n    let [ x, y, w, h ] = coords.split(',').map(parseFloat);\n\n    if (format.toLowerCase() === 'percent') {\n      x = x * image.naturalWidth  / 100;\n      y = y * image.naturalHeight / 100;\n      w = w * image.naturalWidth  / 100;\n      h = h * image.naturalHeight / 100;\n    }\n\n    return { x, y, w, h };\n  }\n}\n\n/** \n * Serializes a (x, y, w, h)-tuple as Media Fragment selector\n * using pixel coordinates.\n */\nconst toPixelRectFragment = (x, y, w, h, image) => ({\n  source: image?.src,\n  selector: {\n    type: \"FragmentSelector\",\n    conformsTo: \"http://www.w3.org/TR/media-frags/\",\n    value: `xywh=pixel:${x},${y},${w},${h}`\n  }\n});\n\n/** \n * Serializes a (x, y, w, h)-tuple as Media Fragment selector \n * using percent coordinates.\n */\nconst toPercentRectFragment = (x, y, w, h, image) => {\n  const px = x / image.naturalWidth  * 100;\n  const py = y / image.naturalHeight * 100;\n  const pw = w / image.naturalWidth  * 100;\n  const ph = h / image.naturalHeight * 100;\n\n  return {\n    source: image.src,\n    selector: {\n      type: \"FragmentSelector\",\n      conformsTo: \"http://www.w3.org/TR/media-frags/\",\n      value: `xywh=percent:${px},${py},${pw},${ph}`\n    }\n  }\n}\n\nexport const toRectFragment = (x, y, w, h, image, fragmentUnit) =>\n  fragmentUnit?.toLowerCase() === 'percent' ?\n    toPercentRectFragment(x, y, w, h, image) :\n    toPixelRectFragment(x, y, w, h, image);\n\n/** Shorthand to apply the given (x, y, w, h) to the SVG shape **/\nconst setXYWH = (shape, x, y, w, h) => {\n  shape.setAttribute('x', x);\n  shape.setAttribute('y', y);\n  shape.setAttribute('width', w);\n  shape.setAttribute('height', h);\n}\n\n\nconst setPointXY = (shape, x, y) => {\n  shape.setAttribute('cx', x);\n  shape.setAttribute('cy', y);\n  shape.setAttribute('r', 7); // TODO make configurable\n}\n\nexport const drawRectMask = (imageDimensions, x, y, w, h) => {\n  const mask = document.createElementNS(SVG_NAMESPACE, 'path');\n  mask.setAttribute('fill-rule', 'evenodd');\n\n  const { naturalWidth, naturalHeight } = imageDimensions;\n  mask.setAttribute('d', `M0 0 h${naturalWidth} v${naturalHeight} h-${naturalWidth} z M${x} ${y} h${w} v${h} h-${w} z`);\n\n  return mask;\n}\n\nexport const setRectMaskSize = (mask, imageDimensions, x, y, w, h) => {\n  const { naturalWidth, naturalHeight } = imageDimensions;\n  mask.setAttribute('d', `M0 0 h${naturalWidth} v${naturalHeight} h-${naturalWidth} z M${x} ${y} h${w} v${h} h-${w} z`);\n}\n\n/** \n * Draws an SVG rectangle, either from an annotation, or an\n * (x, y, w, h)-tuple.\n */\nexport const drawRect = (arg1, arg2, arg3, arg4) => {\n  const { x, y, w, h } = arg1.type === 'Annotation' || arg1.type === 'Selection' ?\n    parseRectFragment(arg1, arg2) : { x: arg1, y: arg2, w: arg3, h: arg4 };\n\n  const g = document.createElementNS(SVG_NAMESPACE, 'g');\n\n  if (w === 0 && h === 0) {\n    // Edge case: rect is actually a point\n    addClass(g, 'a9s-point');\n    addClass(g, 'a9s-non-scaling');\n    g.setAttribute('transform-origin', `${x} ${y}`);\n\n    const outerPoint  = document.createElementNS(SVG_NAMESPACE, 'circle');\n    const innerPoint  = document.createElementNS(SVG_NAMESPACE, 'circle');\n\n    innerPoint.setAttribute('class', 'a9s-inner');\n    setPointXY(innerPoint, x, y);\n\n    outerPoint.setAttribute('class', 'a9s-outer');\n    setPointXY(outerPoint, x, y);\n\n    g.appendChild(outerPoint);\n    g.appendChild(innerPoint);  \n  } else {\n    const outerRect = document.createElementNS(SVG_NAMESPACE, 'rect');\n    const innerRect = document.createElementNS(SVG_NAMESPACE, 'rect');\n\n    innerRect.setAttribute('class', 'a9s-inner');\n    setXYWH(innerRect, x, y, w, h);\n\n    outerRect.setAttribute('class', 'a9s-outer');\n    setXYWH(outerRect, x, y, w, h);\n\n    g.appendChild(outerRect);\n    g.appendChild(innerRect);\n  }\n\n  return g;\n}\n\n/** Gets the (x, y, w, h)-values from the attributes of the SVG group **/\nexport const getRectSize = g => {\n  const outer = g.querySelector('.a9s-outer');\n\n  if (outer.nodeName === 'rect') {\n    const x = parseFloat(outer.getAttribute('x'));\n    const y = parseFloat(outer.getAttribute('y'));\n    const w = parseFloat(outer.getAttribute('width'));\n    const h = parseFloat(outer.getAttribute('height'));\n\n    return { x, y, w, h };\n  } else {\n    const x = parseFloat(outer.getAttribute('cx'));\n    const y = parseFloat(outer.getAttribute('cy'));\n\n    return { x, y, w: 0, h: 0 };\n  }\n}\n\n/** Applies the (x, y, w, h)-values to the rects in the SVG group **/\nexport const setRectSize = (g, x, y, w, h) => {\n  const inner = g.querySelector('.a9s-inner');\n  const outer = g.querySelector('.a9s-outer');\n\n  if (outer.nodeName === 'rect') {\n    setXYWH(inner, x, y, w, h);\n    setXYWH(outer, x, y, w, h);  \n  } else {\n    setPointXY(inner, x, y);\n    setPointXY(outer, x, y);\n  }\n}\n\n/** \n * Shorthand to get the area (rectangle w x h) from the \n * annotation's fragment selector. \n */\nexport const rectArea = (annotation, image) => {\n  const { w, h } = parseRectFragment(annotation, image);\n  return w * h;\n}\n\n","import { toRectFragment } from '@recogito/annotorious/src/selectors/RectFragment';\n\nexport const isPoint = annotation =>\n  annotation.target.renderedVia?.name === 'point';\n\nexport const toFragment = (x, y, image, fragmentUnit) => ({\n  ...toRectFragment(x, y, 0, 0, image, fragmentUnit),\n  renderedVia: {\n    name: 'point'\n  }\n});","import EditableShape from '@recogito/annotorious/src/tools/EditableShape';\nimport { parseRectFragment } from '@recogito/annotorious/src/selectors/RectFragment';\nimport { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\nimport { toFragment } from './Point';\n\nexport default class EditablePoint extends EditableShape {\n\n  constructor(annotation, g, config, env) {\n    super(annotation, g, config, env);\n\n    this.svg.addEventListener('mousemove', this.onMouseMove);\n    this.svg.addEventListener('mouseup', this.onMouseUp);\n\n    const { x, y } = parseRectFragment(annotation, env.image);\n\n    this.container = document.createElementNS(SVG_NAMESPACE, 'g');\n\n    this.elementGroup = document.createElementNS(SVG_NAMESPACE, 'g');\n    this.elementGroup.setAttribute('class', 'a9s-annotation editable selected');\n\n    this.point = this.drawHandle(x, y);\n    this.point.addEventListener('mousedown', this.onGrab);\n    \n    this.elementGroup.appendChild(this.point);\n\n    this.container.appendChild(this.elementGroup);\n    g.appendChild(this.container);\n\n    // true if te mouse has grabbed the point\n    this.isGrabbed = false;\n  }\n\n  onScaleChanged = () => \n    this.scaleHandle(this.point);\n\n  get element() {\n    return this.elementGroup;\n  }\n\n  onGrab = () => {\n    this.isGrabbed = true;\n  }\n\n  onMouseMove = evt => {\n    if (evt.button !== 0) return;  // left click\n\n    if (this.isGrabbed) {\n      const {x, y} = this.getSVGPoint(evt);\n\n      this.setHandleXY(this.point, x, y);\n\n      const target = toFragment(x, y, this.env.image, this.config.fragmentUnit);\n      this.emit('update', target);\n    }\n  }\n\n  onMouseUp = () => {\n    this.isGrabbed = false;\n  }\n\n  updateState = annotation => {\n    const { x, y } = parseRectFragment(annotation, this.env.image);\n    this.setHandleXY(this.point, x, y);\n  }\n\n  destroy() {\n    this.svg.removeEventListener('mousemove', this.onMouseMove);\n    this.svg.removeEventListener('mouseup', this.onMouseUp);\n\n    this.container.parentNode.removeChild(this.container);\n    super.destroy();\n  }\n\n}","import Tool, { Selection } from '@recogito/annotorious/src/tools/Tool';\nimport EditablePoint from './EditablePoint';\nimport { toFragment, isPoint } from './Point';\n\nexport default class PointTool extends Tool {\n\n  constructor(g, config, env) {\n    super(g, config, env);\n  }\n\n  startDrawing = (x, y, _, evt) => {\n    // The top-most existing annotation at this position (if any) \n    const annotation = evt.target.closest('.a9s-annotation')?.annotation;\n\n    // The point drawing tool will ALWAYS create a point annotation,\n    // regardless of whether there's already an annotation underneath.\n    // UNLESS the annotation underneath is itself a point!\n    if (!annotation || !isPoint(annotation)) {\n      const element = this.drawHandle(x, y);\n      this.scaleHandle(element);\n\n      this.g.appendChild(element);\n\n      element.annotation = new Selection(toFragment(x, y, this.env.image, this.config.fragmentUnit));\n\n      this.emit('complete', element);\n    } else {\n      this.emit('cancel')\n    }\n  }\n\n  stop = () => {\n    // Nothing to do\n  }\n\n  get isDrawing() {\n    // Point selection is an instant action - the\n    // tool is never an 'drawing' state\n    return false;\n  }\n  \n  createEditableShape = annotation =>\n    new EditablePoint(annotation, this.g, this.config, this.env);\n\n}\n\nPointTool.identifier = 'point';\n\nPointTool.supports = annotation => {\n  // Not needed, since the target.renderedVia property will be evaluated first\n  return false;\n}","import { SVG_NAMESPACE } from '../util/SVG';\nimport { polygonArea, polygonInPolygon, svgPathToPolygons } from '../util/Geom2D';\n\n/** Helper that forces an un-namespaced node to SVG **/\nconst insertSVGNamespace = originalDoc => {\n  // Serialize and parse for the namespace to take effect on every node\n  const serializer = new XMLSerializer();\n  const str = serializer.serializeToString(originalDoc.documentElement);\n\n  // Doesn't seem that there's a clean cross-browser way for this...\n  const namespaced = str.replace('<svg>', `<svg xmlns=\"${SVG_NAMESPACE}\">`);\n\n  const parser = new DOMParser();\n  const namespacedDoc = parser.parseFromString(namespaced, \"image/svg+xml\");\n  return namespacedDoc.documentElement;\n}\n\nconst sanitize = doc => {\n  // Cf. https://github.com/mattkrick/sanitize-svg#readme  \n  // for the basic approach\n  const cleanEl = el => {\n    Array.from(el.attributes).forEach(attr => {\n      if (attr.name.startsWith('on'))\n        el.removeAttribute(attr.name)\n    });\n  }\n\n  // Remove script tags\n  const scripts = doc.getElementsByTagName('script');\n  Array.from(scripts).reverse().forEach(el =>\n    el.parentNode.removeChild(el));\n\n  // Remove on... attributes\n  cleanEl(doc);\n  Array.from(doc.querySelectorAll('*')).forEach(cleanEl);\n\n  return doc;\n}\n\nexport const svgFragmentToShape = annotation => {\n  const selector = annotation.selector('SvgSelector');\n  if (selector) {\n    const parser = new DOMParser();\n\n    // Parse the XML document, assuming SVG\n    const { value } = selector;\n    const doc = parser.parseFromString(value, \"image/svg+xml\");\n\n    // SVG needs a namespace declaration - check if it's set or insert if not\n    const isPrefixDeclared = doc.lookupPrefix(SVG_NAMESPACE); // SVG declared via prefix\n    const isDefaultNamespaceSVG = doc.lookupNamespaceURI(null); // SVG declared as default namespace\n\n    if (isPrefixDeclared || isDefaultNamespaceSVG) {\n      return sanitize(doc).firstChild;\n    } else {\n      return sanitize(insertSVGNamespace(doc)).firstChild;\n    }\n  }\n}\n\nexport const drawEmbeddedSVG = annotation => {\n  const shape = svgFragmentToShape(annotation);\n\n  // Because we're nitpicky, we don't just draw the shape,\n  // but duplicate it, so we can have inner and an outer lines\n  const g = document.createElementNS(SVG_NAMESPACE, 'g');\n\n  const inner = shape.cloneNode(true);\n  inner.setAttribute('class', 'a9s-inner');\n\n  const outer = shape.cloneNode(true);\n  outer.setAttribute('class', 'a9s-outer');\n\n  g.appendChild(outer);\n  g.appendChild(inner);\n\n  return g;\n}\n\nexport const toSVGTarget = (shape, image) => {\n  const inner = shape.querySelector('.a9s-inner').cloneNode(true);\n  inner.removeAttribute('class');\n  inner.removeAttribute('xmlns');\n\n  let serialized = inner.outerHTML || new XMLSerializer().serializeToString(inner);\n  serialized = serialized.replace(` xmlns=\"${SVG_NAMESPACE}\"`, '');\n\n  return {\n    source: image?.src,\n    selector: {\n      type: \"SvgSelector\",\n      value: `<svg>${serialized}</svg>`\n    }\n  }\n}\n\nexport const svgArea = annotation => {\n  const shape = svgFragmentToShape(annotation);\n  const nodeName = shape.nodeName.toLowerCase();\n\n  if (nodeName === 'polygon') \n    return svgPolygonArea(shape);\n  else if (nodeName === 'circle')\n    return svgCircleArea(shape);\n  else if (nodeName === 'ellipse')\n    return svgEllipseArea(shape);\n  else if (nodeName == 'path')\n    return svgPathArea(shape);\n  else if (nodeName == 'line')\n    return 0;\n  else\n    throw `Unsupported SVG shape type: ${nodeName}`;\n}\n\nconst svgPolygonArea = polygon => {\n  const points = polygon.getAttribute('points')\n    .trim()\n    .split(' ') // Split x/y tuples\n    .map(xy => xy.split(',').map(str => parseFloat(str.trim())));\n\n  return polygonArea(points)\n}\n\nconst svgCircleArea = circle => {\n  const r = circle.getAttribute('r');\n  return r * r * Math.PI;\n}\n\nconst svgEllipseArea = ellipse => {\n  const rx = ellipse.getAttribute('rx');\n  const ry = ellipse.getAttribute('ry');\n  return rx * ry * Math.PI;\n}\n\nconst svgPathArea = path => {\n  const polygons = svgPathToPolygons(path);\n\n  if (polygons.length == 1) {\n    return polygonArea(polygons[0]);\n  } else {\n    // Helper to check if a polygon is a hole\n    const isHole = p => polygons.find(other => {\n      if (p !== other)\n        return polygonInPolygon(p, other); \n    })\n\n    let area = 0\n\n    for (let poly of polygons) {\n      if (isHole(poly))\n        area -= polygonArea(poly);\n      else \n        area += polygonArea(poly);\n    }\n\n    return area;\n  }\n}","const methods = {}\r\nconst names = []\r\n\r\nexport function registerMethods (name, m) {\r\n  if (Array.isArray(name)) {\r\n    for (const _name of name) {\r\n      registerMethods(_name, m)\r\n    }\r\n    return\r\n  }\r\n\r\n  if (typeof name === 'object') {\r\n    for (const _name in name) {\r\n      registerMethods(_name, name[_name])\r\n    }\r\n    return\r\n  }\r\n\r\n  addMethodNames(Object.getOwnPropertyNames(m))\r\n  methods[name] = Object.assign(methods[name] || {}, m)\r\n}\r\n\r\nexport function getMethodsFor (name) {\r\n  return methods[name] || {}\r\n}\r\n\r\nexport function getMethodNames () {\r\n  return [ ...new Set(names) ]\r\n}\r\n\r\nexport function addMethodNames (_names) {\r\n  names.push(..._names)\r\n}\r\n","// Map function\r\nexport function map (array, block) {\r\n  let i\r\n  const il = array.length\r\n  const result = []\r\n\r\n  for (i = 0; i < il; i++) {\r\n    result.push(block(array[i]))\r\n  }\r\n\r\n  return result\r\n}\r\n\r\n// Filter function\r\nexport function filter (array, block) {\r\n  let i\r\n  const il = array.length\r\n  const result = []\r\n\r\n  for (i = 0; i < il; i++) {\r\n    if (block(array[i])) {\r\n      result.push(array[i])\r\n    }\r\n  }\r\n\r\n  return result\r\n}\r\n\r\n// Degrees to radians\r\nexport function radians (d) {\r\n  return d % 360 * Math.PI / 180\r\n}\r\n\r\n// Radians to degrees\r\nexport function degrees (r) {\r\n  return r * 180 / Math.PI % 360\r\n}\r\n\r\n// Convert dash-separated-string to camelCase\r\nexport function camelCase (s) {\r\n  return s.toLowerCase().replace(/-(.)/g, function (m, g) {\r\n    return g.toUpperCase()\r\n  })\r\n}\r\n\r\n// Convert camel cased string to dash separated\r\nexport function unCamelCase (s) {\r\n  return s.replace(/([A-Z])/g, function (m, g) {\r\n    return '-' + g.toLowerCase()\r\n  })\r\n}\r\n\r\n// Capitalize first letter of a string\r\nexport function capitalize (s) {\r\n  return s.charAt(0).toUpperCase() + s.slice(1)\r\n}\r\n\r\n// Calculate proportional width and height values when necessary\r\nexport function proportionalSize (element, width, height, box) {\r\n  if (width == null || height == null) {\r\n    box = box || element.bbox()\r\n\r\n    if (width == null) {\r\n      width = box.width / box.height * height\r\n    } else if (height == null) {\r\n      height = box.height / box.width * width\r\n    }\r\n  }\r\n\r\n  return {\r\n    width: width,\r\n    height: height\r\n  }\r\n}\r\n\r\n/**\r\n * This function adds support for string origins.\r\n * It searches for an origin in o.origin o.ox and o.originX.\r\n * This way, origin: {x: 'center', y: 50} can be passed as well as ox: 'center', oy: 50\r\n**/\r\nexport function getOrigin (o, element) {\r\n  const origin = o.origin\r\n  // First check if origin is in ox or originX\r\n  let ox = o.ox != null\n    ? o.ox\r\n    : o.originX != null\n      ? o.originX\r\n      : 'center'\r\n  let oy = o.oy != null\n    ? o.oy\r\n    : o.originY != null\n      ? o.originY\r\n      : 'center'\r\n\r\n  // Then check if origin was used and overwrite in that case\r\n  if (origin != null) {\r\n    [ ox, oy ] = Array.isArray(origin)\n      ? origin\r\n      : typeof origin === 'object'\n        ? [ origin.x, origin.y ]\r\n        : [ origin, origin ]\r\n  }\r\n\r\n  // Make sure to only call bbox when actually needed\r\n  const condX = typeof ox === 'string'\r\n  const condY = typeof oy === 'string'\r\n  if (condX || condY) {\r\n    const { height, width, x, y } = element.bbox()\r\n\r\n    // And only overwrite if string was passed for this specific axis\r\n    if (condX) {\r\n      ox = ox.includes('left')\n        ? x\r\n        : ox.includes('right')\n          ? x + width\r\n          : x + width / 2\r\n    }\r\n\r\n    if (condY) {\r\n      oy = oy.includes('top')\n        ? y\r\n        : oy.includes('bottom')\n          ? y + height\r\n          : y + height / 2\r\n    }\r\n  }\r\n\r\n  // Return the origin as it is if it wasn't a string\r\n  return [ ox, oy ]\r\n}\r\n","// Default namespaces\nexport const svg = 'http://www.w3.org/2000/svg'\nexport const html = 'http://www.w3.org/1999/xhtml'\nexport const xmlns = 'http://www.w3.org/2000/xmlns/'\nexport const xlink = 'http://www.w3.org/1999/xlink'\nexport const svgjs = 'http://svgjs.dev/svgjs'\n","export const globals = {\r\n  window: typeof window === 'undefined' ? null : window,\r\n  document: typeof document === 'undefined' ? null : document\r\n}\r\n\r\nexport function registerWindow (win = null, doc = null) {\r\n  globals.window = win\r\n  globals.document = doc\r\n}\r\n\r\nconst save = {}\r\n\r\nexport function saveWindow () {\r\n  save.window = globals.window\r\n  save.document = globals.document\r\n}\r\n\r\nexport function restoreWindow () {\r\n  globals.window = save.window\r\n  globals.document = save.document\r\n}\r\n\r\nexport function withWindow (win, fn) {\r\n  saveWindow()\r\n  registerWindow(win, win.document)\r\n  fn(win, win.document)\r\n  restoreWindow()\r\n}\r\n\r\nexport function getWindow () {\r\n  return globals.window\r\n}\r\n","export default class Base {\r\n  // constructor (node/*, {extensions = []} */) {\r\n  //   // this.tags = []\r\n  //   //\r\n  //   // for (let extension of extensions) {\r\n  //   //   extension.setup.call(this, node)\r\n  //   //   this.tags.push(extension.name)\r\n  //   // }\r\n  // }\r\n}\r\n","import { addMethodNames } from './methods.js'\nimport { capitalize } from './utils.js'\nimport { svg } from '../modules/core/namespaces.js'\nimport { globals } from '../utils/window.js'\nimport Base from '../types/Base.js'\n\nconst elements = {}\nexport const root = '___SYMBOL___ROOT___'\n\n// Method for element creation\nexport function create (name, ns = svg) {\n  // create element\n  return globals.document.createElementNS(ns, name)\n}\n\nexport function makeInstance (element, isHTML = false) {\n  if (element instanceof Base) return element\n\n  if (typeof element === 'object') {\n    return adopter(element)\n  }\n\n  if (element == null) {\n    return new elements[root]()\n  }\n\n  if (typeof element === 'string' && element.charAt(0) !== '<') {\n    return adopter(globals.document.querySelector(element))\n  }\n\n  // Make sure, that HTML elements are created with the correct namespace\n  const wrapper = isHTML ? globals.document.createElement('div') : create('svg')\n  wrapper.innerHTML = element\n\n  // We can use firstChild here because we know,\n  // that the first char is < and thus an element\n  element = adopter(wrapper.firstChild)\n\n  // make sure, that element doesnt have its wrapper attached\n  wrapper.removeChild(wrapper.firstChild)\n  return element\n}\n\nexport function nodeOrNew (name, node) {\n  return (node && node.ownerDocument && node instanceof node.ownerDocument.defaultView.Node) ? node : create(name)\n}\n\n// Adopt existing svg elements\nexport function adopt (node) {\n  // check for presence of node\n  if (!node) return null\n\n  // make sure a node isn't already adopted\n  if (node.instance instanceof Base) return node.instance\n\n  if (node.nodeName === '#document-fragment') {\n    return new elements.Fragment(node)\n  }\n\n  // initialize variables\n  let className = capitalize(node.nodeName || 'Dom')\n\n  // Make sure that gradients are adopted correctly\n  if (className === 'LinearGradient' || className === 'RadialGradient') {\n    className = 'Gradient'\n\n  // Fallback to Dom if element is not known\n  } else if (!elements[className]) {\n    className = 'Dom'\n  }\n\n  return new elements[className](node)\n}\n\nlet adopter = adopt\n\nexport function mockAdopt (mock = adopt) {\n  adopter = mock\n}\n\nexport function register (element, name = element.name, asRoot = false) {\n  elements[name] = element\n  if (asRoot) elements[root] = element\n\n  addMethodNames(Object.getOwnPropertyNames(element.prototype))\n\n  return element\n}\n\nexport function getClass (name) {\n  return elements[name]\n}\n\n// Element id sequence\nlet did = 1000\n\n// Get next named element id\nexport function eid (name) {\n  return 'Svgjs' + capitalize(name) + (did++)\n}\n\n// Deep new id assignment\nexport function assignNewId (node) {\n  // do the same for SVG child nodes as well\n  for (let i = node.children.length - 1; i >= 0; i--) {\n    assignNewId(node.children[i])\n  }\n\n  if (node.id) {\n    node.id = eid(node.nodeName)\n    return node\n  }\n\n  return node\n}\n\n// Method for extending objects\nexport function extend (modules, methods) {\n  let key, i\n\n  modules = Array.isArray(modules) ? modules : [ modules ]\n\n  for (i = modules.length - 1; i >= 0; i--) {\n    for (key in methods) {\n      modules[i].prototype[key] = methods[key]\n    }\n  }\n}\n\nexport function wrapWithAttrCheck (fn) {\n  return function (...args) {\n    const o = args[args.length - 1]\n\n    if (o && o.constructor === Object && !(o instanceof Array)) {\n      return fn.apply(this, args.slice(0, -1)).attr(o)\n    } else {\n      return fn.apply(this, args)\n    }\n  }\n}\n","import { makeInstance } from '../../utils/adopter.js'\r\nimport { registerMethods } from '../../utils/methods.js'\r\n\r\n// Get all siblings, including myself\r\nexport function siblings () {\r\n  return this.parent().children()\r\n}\r\n\r\n// Get the current position siblings\r\nexport function position () {\r\n  return this.parent().index(this)\r\n}\r\n\r\n// Get the next element (will return null if there is none)\r\nexport function next () {\r\n  return this.siblings()[this.position() + 1]\r\n}\r\n\r\n// Get the next element (will return null if there is none)\r\nexport function prev () {\r\n  return this.siblings()[this.position() - 1]\r\n}\r\n\r\n// Send given element one step forward\r\nexport function forward () {\r\n  const i = this.position()\r\n  const p = this.parent()\r\n\r\n  // move node one step forward\r\n  p.add(this.remove(), i + 1)\r\n\r\n  return this\r\n}\r\n\r\n// Send given element one step backward\r\nexport function backward () {\r\n  const i = this.position()\r\n  const p = this.parent()\r\n\r\n  p.add(this.remove(), i ? i - 1 : 0)\r\n\r\n  return this\r\n}\r\n\r\n// Send given element all the way to the front\r\nexport function front () {\r\n  const p = this.parent()\r\n\r\n  // Move node forward\r\n  p.add(this.remove())\r\n\r\n  return this\r\n}\r\n\r\n// Send given element all the way to the back\r\nexport function back () {\r\n  const p = this.parent()\r\n\r\n  // Move node back\r\n  p.add(this.remove(), 0)\r\n\r\n  return this\r\n}\r\n\r\n// Inserts a given element before the targeted element\r\nexport function before (element) {\r\n  element = makeInstance(element)\r\n  element.remove()\r\n\r\n  const i = this.position()\r\n\r\n  this.parent().add(element, i)\r\n\r\n  return this\r\n}\r\n\r\n// Inserts a given element after the targeted element\r\nexport function after (element) {\r\n  element = makeInstance(element)\r\n  element.remove()\r\n\r\n  const i = this.position()\r\n\r\n  this.parent().add(element, i + 1)\r\n\r\n  return this\r\n}\r\n\r\nexport function insertBefore (element) {\r\n  element = makeInstance(element)\r\n  element.before(this)\r\n  return this\r\n}\r\n\r\nexport function insertAfter (element) {\r\n  element = makeInstance(element)\r\n  element.after(this)\r\n  return this\r\n}\r\n\r\nregisterMethods('Dom', {\r\n  siblings,\r\n  position,\r\n  next,\r\n  prev,\r\n  forward,\r\n  backward,\r\n  front,\r\n  back,\r\n  before,\r\n  after,\r\n  insertBefore,\r\n  insertAfter\r\n})\r\n","// Parse unit value\r\nexport const numberAndUnit = /^([+-]?(\\d+(\\.\\d*)?|\\.\\d+)(e[+-]?\\d+)?)([a-z%]*)$/i\r\n\r\n// Parse hex value\r\nexport const hex = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i\r\n\r\n// Parse rgb value\r\nexport const rgb = /rgb\\((\\d+),(\\d+),(\\d+)\\)/\r\n\r\n// Parse reference id\r\nexport const reference = /(#[a-z_][a-z0-9\\-_]*)/i\r\n\r\n// splits a transformation chain\r\nexport const transforms = /\\)\\s*,?\\s*/\r\n\r\n// Whitespace\r\nexport const whitespace = /\\s/g\r\n\r\n// Test hex value\r\nexport const isHex = /^#[a-f0-9]{3}$|^#[a-f0-9]{6}$/i\r\n\r\n// Test rgb value\r\nexport const isRgb = /^rgb\\(/\r\n\r\n// Test for blank string\r\nexport const isBlank = /^(\\s+)?$/\r\n\r\n// Test for numeric string\r\nexport const isNumber = /^[+-]?(\\d+(\\.\\d*)?|\\.\\d+)(e[+-]?\\d+)?$/i\r\n\r\n// Test for image url\r\nexport const isImage = /\\.(jpg|jpeg|png|gif|svg)(\\?[^=]+.*)?/i\r\n\r\n// split at whitespace and comma\r\nexport const delimiter = /[\\s,]+/\r\n\r\n// Test for path letter\r\nexport const isPathLetter = /[MLHVCSQTAZ]/i\r\n","\r\nimport { hex, isHex, isRgb, rgb, whitespace } from '../modules/core/regex.js'\r\n\r\nfunction sixDigitHex (hex) {\r\n  return hex.length === 4\r\n    ? [ '#',\r\n      hex.substring(1, 2), hex.substring(1, 2),\r\n      hex.substring(2, 3), hex.substring(2, 3),\r\n      hex.substring(3, 4), hex.substring(3, 4)\r\n    ].join('')\r\n    : hex\r\n}\r\n\r\nfunction componentHex (component) {\r\n  const integer = Math.round(component)\r\n  const bounded = Math.max(0, Math.min(255, integer))\r\n  const hex = bounded.toString(16)\r\n  return hex.length === 1 ? '0' + hex : hex\r\n}\r\n\r\nfunction is (object, space) {\r\n  for (let i = space.length; i--;) {\r\n    if (object[space[i]] == null) {\r\n      return false\r\n    }\r\n  }\r\n  return true\r\n}\r\n\r\nfunction getParameters (a, b) {\r\n  const params = is(a, 'rgb')\n    ? { _a: a.r, _b: a.g, _c: a.b, _d: 0, space: 'rgb' }\r\n    : is(a, 'xyz')\n      ? { _a: a.x, _b: a.y, _c: a.z, _d: 0, space: 'xyz' }\r\n      : is(a, 'hsl')\n        ? { _a: a.h, _b: a.s, _c: a.l, _d: 0, space: 'hsl' }\r\n        : is(a, 'lab')\n          ? { _a: a.l, _b: a.a, _c: a.b, _d: 0, space: 'lab' }\r\n          : is(a, 'lch')\n            ? { _a: a.l, _b: a.c, _c: a.h, _d: 0, space: 'lch' }\r\n            : is(a, 'cmyk')\n              ? { _a: a.c, _b: a.m, _c: a.y, _d: a.k, space: 'cmyk' }\r\n              : { _a: 0, _b: 0, _c: 0, space: 'rgb' }\r\n\r\n  params.space = b || params.space\r\n  return params\r\n}\r\n\r\nfunction cieSpace (space) {\r\n  if (space === 'lab' || space === 'xyz' || space === 'lch') {\r\n    return true\r\n  } else {\r\n    return false\r\n  }\r\n}\r\n\r\nfunction hueToRgb (p, q, t) {\r\n  if (t < 0) t += 1\r\n  if (t > 1) t -= 1\r\n  if (t < 1 / 6) return p + (q - p) * 6 * t\r\n  if (t < 1 / 2) return q\r\n  if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6\r\n  return p\r\n}\r\n\r\nexport default class Color {\r\n  constructor (...inputs) {\r\n    this.init(...inputs)\r\n  }\r\n\r\n  // Test if given value is a color\n  static isColor (color) {\r\n    return color && (\r\n      color instanceof Color\r\n      || this.isRgb(color)\r\n      || this.test(color)\r\n    )\r\n  }\n\n  // Test if given value is an rgb object\n  static isRgb (color) {\r\n    return color && typeof color.r === 'number'\r\n      && typeof color.g === 'number'\r\n      && typeof color.b === 'number'\r\n  }\n\n  /*\r\n  Generating random colors\r\n  */\n  static random (mode = 'vibrant', t, u) {\r\n\r\n    // Get the math modules\r\n    const { random, round, sin, PI: pi } = Math\r\n\r\n    // Run the correct generator\r\n    if (mode === 'vibrant') {\r\n\r\n      const l = (81 - 57) * random() + 57\r\n      const c = (83 - 45) * random() + 45\r\n      const h = 360 * random()\r\n      const color = new Color(l, c, h, 'lch')\r\n      return color\r\n\r\n    } else if (mode === 'sine') {\r\n\r\n      t = t == null ? random() : t\r\n      const r = round(80 * sin(2 * pi * t / 0.5 + 0.01) + 150)\r\n      const g = round(50 * sin(2 * pi * t / 0.5 + 4.6) + 200)\r\n      const b = round(100 * sin(2 * pi * t / 0.5 + 2.3) + 150)\r\n      const color = new Color(r, g, b)\r\n      return color\r\n\r\n    } else if (mode === 'pastel') {\r\n\r\n      const l = (94 - 86) * random() + 86\r\n      const c = (26 - 9) * random() + 9\r\n      const h = 360 * random()\r\n      const color = new Color(l, c, h, 'lch')\r\n      return color\r\n\r\n    } else if (mode === 'dark') {\r\n\r\n      const l = 10 + 10 * random()\r\n      const c = (125 - 75) * random() + 86\r\n      const h = 360 * random()\r\n      const color = new Color(l, c, h, 'lch')\r\n      return color\r\n\r\n    } else if (mode === 'rgb') {\r\n\r\n      const r = 255 * random()\r\n      const g = 255 * random()\r\n      const b = 255 * random()\r\n      const color = new Color(r, g, b)\r\n      return color\r\n\r\n    } else if (mode === 'lab') {\r\n\r\n      const l = 100 * random()\r\n      const a = 256 * random() - 128\r\n      const b = 256 * random() - 128\r\n      const color = new Color(l, a, b, 'lab')\r\n      return color\r\n\r\n    } else if (mode === 'grey') {\r\n\r\n      const grey = 255 * random()\r\n      const color = new Color(grey, grey, grey)\r\n      return color\r\n\r\n    } else {\r\n\r\n      throw new Error('Unsupported random color mode')\r\n\r\n    }\r\n  }\n\n  // Test if given value is a color string\n  static test (color) {\r\n    return (typeof color === 'string')\r\n      && (isHex.test(color) || isRgb.test(color))\r\n  }\n\n  cmyk () {\r\n\r\n    // Get the rgb values for the current color\r\n    const { _a, _b, _c } = this.rgb()\r\n    const [ r, g, b ] = [ _a, _b, _c ].map(v => v / 255)\r\n\r\n    // Get the cmyk values in an unbounded format\r\n    const k = Math.min(1 - r, 1 - g, 1 - b)\r\n\r\n    if (k === 1) {\r\n      // Catch the black case\r\n      return new Color(0, 0, 0, 1, 'cmyk')\r\n    }\r\n\r\n    const c = (1 - r - k) / (1 - k)\r\n    const m = (1 - g - k) / (1 - k)\r\n    const y = (1 - b - k) / (1 - k)\r\n\r\n    // Construct the new color\r\n    const color = new Color(c, m, y, k, 'cmyk')\r\n    return color\r\n  }\n\n  hsl () {\r\n\r\n    // Get the rgb values\r\n    const { _a, _b, _c } = this.rgb()\r\n    const [ r, g, b ] = [ _a, _b, _c ].map(v => v / 255)\r\n\r\n    // Find the maximum and minimum values to get the lightness\r\n    const max = Math.max(r, g, b)\r\n    const min = Math.min(r, g, b)\r\n    const l = (max + min) / 2\r\n\r\n    // If the r, g, v values are identical then we are grey\r\n    const isGrey = max === min\r\n\r\n    // Calculate the hue and saturation\r\n    const delta = max - min\r\n    const s = isGrey\n      ? 0\r\n      : l > 0.5\n        ? delta / (2 - max - min)\r\n        : delta / (max + min)\r\n    const h = isGrey\n      ? 0\r\n      : max === r\n        ? ((g - b) / delta + (g < b ? 6 : 0)) / 6\r\n        : max === g\n          ? ((b - r) / delta + 2) / 6\r\n          : max === b\n            ? ((r - g) / delta + 4) / 6\r\n            : 0\r\n\r\n    // Construct and return the new color\r\n    const color = new Color(360 * h, 100 * s, 100 * l, 'hsl')\r\n    return color\r\n  }\n\n  init (a = 0, b = 0, c = 0, d = 0, space = 'rgb') {\r\n    // This catches the case when a falsy value is passed like ''\r\n    a = !a ? 0 : a\r\n\r\n    // Reset all values in case the init function is rerun with new color space\r\n    if (this.space) {\r\n      for (const component in this.space) {\r\n        delete this[this.space[component]]\r\n      }\r\n    }\r\n\r\n    if (typeof a === 'number') {\r\n      // Allow for the case that we don't need d...\r\n      space = typeof d === 'string' ? d : space\r\n      d = typeof d === 'string' ? 0 : d\r\n\r\n      // Assign the values straight to the color\r\n      Object.assign(this, { _a: a, _b: b, _c: c, _d: d, space })\r\n    // If the user gave us an array, make the color from it\r\n    } else if (a instanceof Array) {\r\n      this.space = b || (typeof a[3] === 'string' ? a[3] : a[4]) || 'rgb'\r\n      Object.assign(this, { _a: a[0], _b: a[1], _c: a[2], _d: a[3] || 0 })\r\n    } else if (a instanceof Object) {\r\n      // Set the object up and assign its values directly\r\n      const values = getParameters(a, b)\r\n      Object.assign(this, values)\r\n    } else if (typeof a === 'string') {\r\n      if (isRgb.test(a)) {\r\n        const noWhitespace = a.replace(whitespace, '')\r\n        const [ _a, _b, _c ] = rgb.exec(noWhitespace)\r\n          .slice(1, 4).map(v => parseInt(v))\r\n        Object.assign(this, { _a, _b, _c, _d: 0, space: 'rgb' })\r\n      } else if (isHex.test(a)) {\r\n        const hexParse = v => parseInt(v, 16)\r\n        const [ , _a, _b, _c ] = hex.exec(sixDigitHex(a)).map(hexParse)\r\n        Object.assign(this, { _a, _b, _c, _d: 0, space: 'rgb' })\r\n      } else throw Error('Unsupported string format, can\\'t construct Color')\r\n    }\r\n\r\n    // Now add the components as a convenience\r\n    const { _a, _b, _c, _d } = this\r\n    const components = this.space === 'rgb'\n      ? { r: _a, g: _b, b: _c }\r\n      : this.space === 'xyz'\n        ? { x: _a, y: _b, z: _c }\r\n        : this.space === 'hsl'\n          ? { h: _a, s: _b, l: _c }\r\n          : this.space === 'lab'\n            ? { l: _a, a: _b, b: _c }\r\n            : this.space === 'lch'\n              ? { l: _a, c: _b, h: _c }\r\n              : this.space === 'cmyk'\n                ? { c: _a, m: _b, y: _c, k: _d }\r\n                : {}\r\n    Object.assign(this, components)\r\n  }\r\n\r\n  lab () {\r\n    // Get the xyz color\r\n    const { x, y, z } = this.xyz()\r\n\r\n    // Get the lab components\r\n    const l = (116 * y) - 16\r\n    const a = 500 * (x - y)\r\n    const b = 200 * (y - z)\r\n\r\n    // Construct and return a new color\r\n    const color = new Color(l, a, b, 'lab')\r\n    return color\r\n  }\n\n  lch () {\r\n\r\n    // Get the lab color directly\r\n    const { l, a, b } = this.lab()\r\n\r\n    // Get the chromaticity and the hue using polar coordinates\r\n    const c = Math.sqrt(a ** 2 + b ** 2)\r\n    let h = 180 * Math.atan2(b, a) / Math.PI\r\n    if (h < 0) {\r\n      h *= -1\r\n      h = 360 - h\r\n    }\r\n\r\n    // Make a new color and return it\r\n    const color = new Color(l, c, h, 'lch')\r\n    return color\r\n  }\n  /*\r\n  Conversion Methods\r\n  */\r\n\r\n  rgb () {\r\n    if (this.space === 'rgb') {\r\n      return this\r\n    } else if (cieSpace(this.space)) {\r\n      // Convert to the xyz color space\r\n      let { x, y, z } = this\r\n      if (this.space === 'lab' || this.space === 'lch') {\r\n        // Get the values in the lab space\r\n        let { l, a, b } = this\r\n        if (this.space === 'lch') {\r\n          const { c, h } = this\r\n          const dToR = Math.PI / 180\r\n          a = c * Math.cos(dToR * h)\r\n          b = c * Math.sin(dToR * h)\r\n        }\r\n\r\n        // Undo the nonlinear function\r\n        const yL = (l + 16) / 116\r\n        const xL = a / 500 + yL\r\n        const zL = yL - b / 200\r\n\r\n        // Get the xyz values\r\n        const ct = 16 / 116\r\n        const mx = 0.008856\r\n        const nm = 7.787\r\n        x = 0.95047 * ((xL ** 3 > mx) ? xL ** 3 : (xL - ct) / nm)\r\n        y = 1.00000 * ((yL ** 3 > mx) ? yL ** 3 : (yL - ct) / nm)\r\n        z = 1.08883 * ((zL ** 3 > mx) ? zL ** 3 : (zL - ct) / nm)\r\n      }\r\n\r\n      // Convert xyz to unbounded rgb values\r\n      const rU = x * 3.2406 + y * -1.5372 + z * -0.4986\r\n      const gU = x * -0.9689 + y * 1.8758 + z * 0.0415\r\n      const bU = x * 0.0557 + y * -0.2040 + z * 1.0570\r\n\r\n      // Convert the values to true rgb values\r\n      const pow = Math.pow\r\n      const bd = 0.0031308\r\n      const r = (rU > bd) ? (1.055 * pow(rU, 1 / 2.4) - 0.055) : 12.92 * rU\r\n      const g = (gU > bd) ? (1.055 * pow(gU, 1 / 2.4) - 0.055) : 12.92 * gU\r\n      const b = (bU > bd) ? (1.055 * pow(bU, 1 / 2.4) - 0.055) : 12.92 * bU\r\n\r\n      // Make and return the color\r\n      const color = new Color(255 * r, 255 * g, 255 * b)\r\n      return color\r\n    } else if (this.space === 'hsl') {\r\n      // https://bgrins.github.io/TinyColor/docs/tinycolor.html\r\n      // Get the current hsl values\r\n      let { h, s, l } = this\r\n      h /= 360\r\n      s /= 100\r\n      l /= 100\r\n\r\n      // If we are grey, then just make the color directly\r\n      if (s === 0) {\r\n        l *= 255\r\n        const color = new Color(l, l, l)\r\n        return color\r\n      }\r\n\r\n      // TODO I have no idea what this does :D If you figure it out, tell me!\r\n      const q = l < 0.5 ? l * (1 + s) : l + s - l * s\r\n      const p = 2 * l - q\r\n\r\n      // Get the rgb values\r\n      const r = 255 * hueToRgb(p, q, h + 1 / 3)\r\n      const g = 255 * hueToRgb(p, q, h)\r\n      const b = 255 * hueToRgb(p, q, h - 1 / 3)\r\n\r\n      // Make a new color\r\n      const color = new Color(r, g, b)\r\n      return color\r\n    } else if (this.space === 'cmyk') {\r\n      // https://gist.github.com/felipesabino/5066336\r\n      // Get the normalised cmyk values\r\n      const { c, m, y, k } = this\r\n\r\n      // Get the rgb values\r\n      const r = 255 * (1 - Math.min(1, c * (1 - k) + k))\r\n      const g = 255 * (1 - Math.min(1, m * (1 - k) + k))\r\n      const b = 255 * (1 - Math.min(1, y * (1 - k) + k))\r\n\r\n      // Form the color and return it\r\n      const color = new Color(r, g, b)\r\n      return color\r\n    } else {\r\n      return this\r\n    }\r\n  }\r\n\n  toArray () {\r\n    const { _a, _b, _c, _d, space } = this\r\n    return [ _a, _b, _c, _d, space ]\r\n  }\n\n  toHex () {\r\n    const [ r, g, b ] = this._clamped().map(componentHex)\r\n    return `#${r}${g}${b}`\r\n  }\n\n  toRgb () {\r\n    const [ rV, gV, bV ] = this._clamped()\r\n    const string = `rgb(${rV},${gV},${bV})`\r\n    return string\r\n  }\n\n  toString () {\r\n    return this.toHex()\r\n  }\n\n  xyz () {\r\n\r\n    // Normalise the red, green and blue values\r\n    const { _a: r255, _b: g255, _c: b255 } = this.rgb()\r\n    const [ r, g, b ] = [ r255, g255, b255 ].map(v => v / 255)\r\n\r\n    // Convert to the lab rgb space\r\n    const rL = (r > 0.04045) ? Math.pow((r + 0.055) / 1.055, 2.4) : r / 12.92\r\n    const gL = (g > 0.04045) ? Math.pow((g + 0.055) / 1.055, 2.4) : g / 12.92\r\n    const bL = (b > 0.04045) ? Math.pow((b + 0.055) / 1.055, 2.4) : b / 12.92\r\n\r\n    // Convert to the xyz color space without bounding the values\r\n    const xU = (rL * 0.4124 + gL * 0.3576 + bL * 0.1805) / 0.95047\r\n    const yU = (rL * 0.2126 + gL * 0.7152 + bL * 0.0722) / 1.00000\r\n    const zU = (rL * 0.0193 + gL * 0.1192 + bL * 0.9505) / 1.08883\r\n\r\n    // Get the proper xyz values by applying the bounding\r\n    const x = (xU > 0.008856) ? Math.pow(xU, 1 / 3) : (7.787 * xU) + 16 / 116\r\n    const y = (yU > 0.008856) ? Math.pow(yU, 1 / 3) : (7.787 * yU) + 16 / 116\r\n    const z = (zU > 0.008856) ? Math.pow(zU, 1 / 3) : (7.787 * zU) + 16 / 116\r\n\r\n    // Make and return the color\r\n    const color = new Color(x, y, z, 'xyz')\r\n    return color\r\n  }\r\n\n  /*\r\n  Input and Output methods\r\n  */\r\n\r\n  _clamped () {\r\n    const { _a, _b, _c } = this.rgb()\r\n    const { max, min, round } = Math\r\n    const format = v => max(0, min(round(v), 255))\r\n    return [ _a, _b, _c ].map(format)\r\n  }\r\n\r\n  /*\r\n  Constructing colors\r\n  */\r\n\r\n}\r\n","import { delimiter } from '../core/regex.js'\r\nimport { registerMethods } from '../../utils/methods.js'\r\n\r\n// Return array of classes on the node\r\nexport function classes () {\r\n  const attr = this.attr('class')\r\n  return attr == null ? [] : attr.trim().split(delimiter)\r\n}\r\n\r\n// Return true if class exists on the node, false otherwise\r\nexport function hasClass (name) {\r\n  return this.classes().indexOf(name) !== -1\r\n}\r\n\r\n// Add class to the node\r\nexport function addClass (name) {\r\n  if (!this.hasClass(name)) {\r\n    const array = this.classes()\r\n    array.push(name)\r\n    this.attr('class', array.join(' '))\r\n  }\r\n\r\n  return this\r\n}\r\n\r\n// Remove class from the node\r\nexport function removeClass (name) {\r\n  if (this.hasClass(name)) {\r\n    this.attr('class', this.classes().filter(function (c) {\r\n      return c !== name\r\n    }).join(' '))\r\n  }\r\n\r\n  return this\r\n}\r\n\r\n// Toggle the presence of a class on the node\r\nexport function toggleClass (name) {\r\n  return this.hasClass(name) ? this.removeClass(name) : this.addClass(name)\r\n}\r\n\r\nregisterMethods('Dom', {\r\n  classes, hasClass, addClass, removeClass, toggleClass\r\n})\r\n","import { camelCase } from '../../utils/utils.js'\r\nimport { isBlank } from '../core/regex.js'\r\nimport { registerMethods } from '../../utils/methods.js'\r\n\r\n// Dynamic style generator\r\nexport function css (style, val) {\r\n  const ret = {}\r\n  if (arguments.length === 0) {\r\n    // get full style as object\r\n    this.node.style.cssText.split(/\\s*;\\s*/)\r\n      .filter(function (el) {\r\n        return !!el.length\r\n      })\r\n      .forEach(function (el) {\r\n        const t = el.split(/\\s*:\\s*/)\r\n        ret[t[0]] = t[1]\r\n      })\r\n    return ret\r\n  }\r\n\r\n  if (arguments.length < 2) {\r\n    // get style properties as array\r\n    if (Array.isArray(style)) {\r\n      for (const name of style) {\r\n        const cased = camelCase(name)\r\n        ret[name] = this.node.style[cased]\r\n      }\r\n      return ret\r\n    }\r\n\r\n    // get style for property\r\n    if (typeof style === 'string') {\r\n      return this.node.style[camelCase(style)]\r\n    }\r\n\r\n    // set styles in object\r\n    if (typeof style === 'object') {\r\n      for (const name in style) {\r\n        // set empty string if null/undefined/'' was given\r\n        this.node.style[camelCase(name)]\r\n          = (style[name] == null || isBlank.test(style[name])) ? '' : style[name]\r\n      }\r\n    }\r\n  }\r\n\r\n  // set style for property\r\n  if (arguments.length === 2) {\r\n    this.node.style[camelCase(style)]\r\n      = (val == null || isBlank.test(val)) ? '' : val\r\n  }\r\n\r\n  return this\r\n}\r\n\r\n// Show element\r\nexport function show () {\r\n  return this.css('display', '')\r\n}\r\n\r\n// Hide element\r\nexport function hide () {\r\n  return this.css('display', 'none')\r\n}\r\n\r\n// Is element visible?\r\nexport function visible () {\r\n  return this.css('display') !== 'none'\r\n}\r\n\r\nregisterMethods('Dom', {\r\n  css, show, hide, visible\r\n})\r\n","import { registerMethods } from '../../utils/methods.js'\r\nimport { filter, map } from '../../utils/utils.js'\r\n\r\n// Store data values on svg nodes\r\nexport function data (a, v, r) {\r\n  if (a == null) {\r\n    // get an object of attributes\r\n    return this.data(map(filter(this.node.attributes, (el) => el.nodeName.indexOf('data-') === 0), (el) => el.nodeName.slice(5)))\r\n  } else if (a instanceof Array) {\r\n    const data = {}\r\n    for (const key of a) {\r\n      data[key] = this.data(key)\r\n    }\r\n    return data\r\n  } else if (typeof a === 'object') {\r\n    for (v in a) {\r\n      this.data(v, a[v])\r\n    }\r\n  } else if (arguments.length < 2) {\r\n    try {\r\n      return JSON.parse(this.attr('data-' + a))\r\n    } catch (e) {\r\n      return this.attr('data-' + a)\r\n    }\r\n  } else {\r\n    this.attr('data-' + a,\r\n      v === null\n        ? null\r\n        : r === true || typeof v === 'string' || typeof v === 'number'\n          ? v\r\n          : JSON.stringify(v)\r\n    )\r\n  }\r\n\r\n  return this\r\n}\r\n\r\nregisterMethods('Dom', { data })\r\n","import { registerMethods } from '../../utils/methods.js'\r\n\r\n// Remember arbitrary data\r\nexport function remember (k, v) {\r\n  // remember every item in an object individually\r\n  if (typeof arguments[0] === 'object') {\r\n    for (const key in k) {\r\n      this.remember(key, k[key])\r\n    }\r\n  } else if (arguments.length === 1) {\r\n    // retrieve memory\r\n    return this.memory()[k]\r\n  } else {\r\n    // store memory\r\n    this.memory()[k] = v\r\n  }\r\n\r\n  return this\r\n}\r\n\r\n// Erase a given memory\r\nexport function forget () {\r\n  if (arguments.length === 0) {\r\n    this._memory = {}\r\n  } else {\r\n    for (let i = arguments.length - 1; i >= 0; i--) {\r\n      delete this.memory()[arguments[i]]\r\n    }\r\n  }\r\n  return this\r\n}\r\n\r\n// This triggers creation of a new hidden class which is not performant\r\n// However, this function is not rarely used so it will not happen frequently\r\n// Return local memory object\r\nexport function memory () {\r\n  return (this._memory = this._memory || {})\r\n}\r\n\r\nregisterMethods('Dom', { remember, forget, memory })\r\n","import Matrix from './Matrix.js'\r\n\r\nexport default class Point {\r\n  // Initialize\r\n  constructor (...args) {\r\n    this.init(...args)\r\n  }\r\n\r\n  // Clone point\n  clone () {\r\n    return new Point(this)\r\n  }\n\n  init (x, y) {\r\n    const base = { x: 0, y: 0 }\r\n\r\n    // ensure source as object\r\n    const source = Array.isArray(x)\n      ? { x: x[0], y: x[1] }\r\n      : typeof x === 'object'\n        ? { x: x.x, y: x.y }\r\n        : { x: x, y: y }\r\n\r\n    // merge source\r\n    this.x = source.x == null ? base.x : source.x\r\n    this.y = source.y == null ? base.y : source.y\r\n\r\n    return this\r\n  }\r\n\r\n  toArray () {\r\n    return [ this.x, this.y ]\r\n  }\n\n  transform (m) {\r\n    return this.clone().transformO(m)\r\n  }\r\n\r\n  // Transform point with matrix\r\n  transformO (m) {\r\n    if (!Matrix.isMatrixLike(m)) {\r\n      m = new Matrix(m)\r\n    }\r\n\r\n    const { x, y } = this\r\n\r\n    // Perform the matrix multiplication\r\n    this.x = m.a * x + m.c * y + m.e\r\n    this.y = m.b * x + m.d * y + m.f\r\n\r\n    return this\r\n  }\r\n\r\n}\r\n\r\nexport function point (x, y) {\r\n  return new Point(x, y).transform(this.screenCTM().inverse())\r\n}\r\n","import { delimiter } from '../modules/core/regex.js'\r\nimport { radians } from '../utils/utils.js'\r\nimport { register } from '../utils/adopter.js'\r\nimport Element from '../elements/Element.js'\r\nimport Point from './Point.js'\r\n\r\nfunction closeEnough (a, b, threshold) {\r\n  return Math.abs(b - a) < (threshold || 1e-6)\r\n}\r\n\r\nexport default class Matrix {\r\n  constructor (...args) {\r\n    this.init(...args)\r\n  }\r\n\r\n  static formatTransforms (o) {\r\n    // Get all of the parameters required to form the matrix\r\n    const flipBoth = o.flip === 'both' || o.flip === true\r\n    const flipX = o.flip && (flipBoth || o.flip === 'x') ? -1 : 1\r\n    const flipY = o.flip && (flipBoth || o.flip === 'y') ? -1 : 1\r\n    const skewX = o.skew && o.skew.length\n      ? o.skew[0]\r\n      : isFinite(o.skew)\n        ? o.skew\r\n        : isFinite(o.skewX)\n          ? o.skewX\r\n          : 0\r\n    const skewY = o.skew && o.skew.length\n      ? o.skew[1]\r\n      : isFinite(o.skew)\n        ? o.skew\r\n        : isFinite(o.skewY)\n          ? o.skewY\r\n          : 0\r\n    const scaleX = o.scale && o.scale.length\n      ? o.scale[0] * flipX\r\n      : isFinite(o.scale)\n        ? o.scale * flipX\r\n        : isFinite(o.scaleX)\n          ? o.scaleX * flipX\r\n          : flipX\r\n    const scaleY = o.scale && o.scale.length\n      ? o.scale[1] * flipY\r\n      : isFinite(o.scale)\n        ? o.scale * flipY\r\n        : isFinite(o.scaleY)\n          ? o.scaleY * flipY\r\n          : flipY\r\n    const shear = o.shear || 0\r\n    const theta = o.rotate || o.theta || 0\r\n    const origin = new Point(o.origin || o.around || o.ox || o.originX, o.oy || o.originY)\r\n    const ox = origin.x\r\n    const oy = origin.y\r\n    // We need Point to be invalid if nothing was passed because we cannot default to 0 here. Thats why NaN\r\n    const position = new Point(o.position || o.px || o.positionX || NaN, o.py || o.positionY || NaN)\r\n    const px = position.x\r\n    const py = position.y\r\n    const translate = new Point(o.translate || o.tx || o.translateX, o.ty || o.translateY)\r\n    const tx = translate.x\r\n    const ty = translate.y\r\n    const relative = new Point(o.relative || o.rx || o.relativeX, o.ry || o.relativeY)\r\n    const rx = relative.x\r\n    const ry = relative.y\r\n\r\n    // Populate all of the values\r\n    return {\r\n      scaleX, scaleY, skewX, skewY, shear, theta, rx, ry, tx, ty, ox, oy, px, py\r\n    }\r\n  }\n\n  static fromArray (a) {\r\n    return { a: a[0], b: a[1], c: a[2], d: a[3], e: a[4], f: a[5] }\r\n  }\n\n  static isMatrixLike (o) {\r\n    return (\r\n      o.a != null\r\n      || o.b != null\r\n      || o.c != null\r\n      || o.d != null\r\n      || o.e != null\r\n      || o.f != null\r\n    )\r\n  }\n\n  // left matrix, right matrix, target matrix which is overwritten\n  static matrixMultiply (l, r, o) {\r\n    // Work out the product directly\r\n    const a = l.a * r.a + l.c * r.b\r\n    const b = l.b * r.a + l.d * r.b\r\n    const c = l.a * r.c + l.c * r.d\r\n    const d = l.b * r.c + l.d * r.d\r\n    const e = l.e + l.a * r.e + l.c * r.f\r\n    const f = l.f + l.b * r.e + l.d * r.f\r\n\r\n    // make sure to use local variables because l/r and o could be the same\r\n    o.a = a\r\n    o.b = b\r\n    o.c = c\r\n    o.d = d\r\n    o.e = e\r\n    o.f = f\r\n\r\n    return o\r\n  }\n\n  around (cx, cy, matrix) {\r\n    return this.clone().aroundO(cx, cy, matrix)\r\n  }\n\n  // Transform around a center point\n  aroundO (cx, cy, matrix) {\r\n    const dx = cx || 0\r\n    const dy = cy || 0\r\n    return this.translateO(-dx, -dy).lmultiplyO(matrix).translateO(dx, dy)\r\n  }\n\n  // Clones this matrix\n  clone () {\r\n    return new Matrix(this)\r\n  }\n\n  // Decomposes this matrix into its affine parameters\n  decompose (cx = 0, cy = 0) {\r\n    // Get the parameters from the matrix\r\n    const a = this.a\r\n    const b = this.b\r\n    const c = this.c\r\n    const d = this.d\r\n    const e = this.e\r\n    const f = this.f\r\n\r\n    // Figure out if the winding direction is clockwise or counterclockwise\r\n    const determinant = a * d - b * c\r\n    const ccw = determinant > 0 ? 1 : -1\r\n\r\n    // Since we only shear in x, we can use the x basis to get the x scale\r\n    // and the rotation of the resulting matrix\r\n    const sx = ccw * Math.sqrt(a * a + b * b)\r\n    const thetaRad = Math.atan2(ccw * b, ccw * a)\r\n    const theta = 180 / Math.PI * thetaRad\r\n    const ct = Math.cos(thetaRad)\r\n    const st = Math.sin(thetaRad)\r\n\r\n    // We can then solve the y basis vector simultaneously to get the other\r\n    // two affine parameters directly from these parameters\r\n    const lam = (a * c + b * d) / determinant\r\n    const sy = ((c * sx) / (lam * a - b)) || ((d * sx) / (lam * b + a))\r\n\r\n    // Use the translations\r\n    const tx = e - cx + cx * ct * sx + cy * (lam * ct * sx - st * sy)\r\n    const ty = f - cy + cx * st * sx + cy * (lam * st * sx + ct * sy)\r\n\r\n    // Construct the decomposition and return it\r\n    return {\r\n      // Return the affine parameters\r\n      scaleX: sx,\r\n      scaleY: sy,\r\n      shear: lam,\r\n      rotate: theta,\r\n      translateX: tx,\r\n      translateY: ty,\r\n      originX: cx,\r\n      originY: cy,\r\n\r\n      // Return the matrix parameters\r\n      a: this.a,\r\n      b: this.b,\r\n      c: this.c,\r\n      d: this.d,\r\n      e: this.e,\r\n      f: this.f\r\n    }\r\n  }\n\n  // Check if two matrices are equal\n  equals (other) {\r\n    if (other === this) return true\r\n    const comp = new Matrix(other)\r\n    return closeEnough(this.a, comp.a) && closeEnough(this.b, comp.b)\r\n      && closeEnough(this.c, comp.c) && closeEnough(this.d, comp.d)\r\n      && closeEnough(this.e, comp.e) && closeEnough(this.f, comp.f)\r\n  }\n\n  // Flip matrix on x or y, at a given offset\n  flip (axis, around) {\r\n    return this.clone().flipO(axis, around)\r\n  }\n\n  flipO (axis, around) {\r\n    return axis === 'x'\n      ? this.scaleO(-1, 1, around, 0)\r\n      : axis === 'y'\n        ? this.scaleO(1, -1, 0, around)\r\n        : this.scaleO(-1, -1, axis, around || axis) // Define an x, y flip point\r\n  }\n\n  // Initialize\r\n  init (source) {\r\n    const base = Matrix.fromArray([ 1, 0, 0, 1, 0, 0 ])\r\n\r\n    // ensure source as object\r\n    source = source instanceof Element\n      ? source.matrixify()\r\n      : typeof source === 'string'\n        ? Matrix.fromArray(source.split(delimiter).map(parseFloat))\r\n        : Array.isArray(source)\n          ? Matrix.fromArray(source)\r\n          : (typeof source === 'object' && Matrix.isMatrixLike(source))\n            ? source\r\n            : (typeof source === 'object')\n              ? new Matrix().transform(source)\r\n              : arguments.length === 6\n                ? Matrix.fromArray([].slice.call(arguments))\r\n                : base\r\n\r\n    // Merge the source matrix with the base matrix\r\n    this.a = source.a != null ? source.a : base.a\r\n    this.b = source.b != null ? source.b : base.b\r\n    this.c = source.c != null ? source.c : base.c\r\n    this.d = source.d != null ? source.d : base.d\r\n    this.e = source.e != null ? source.e : base.e\r\n    this.f = source.f != null ? source.f : base.f\r\n\r\n    return this\r\n  }\r\n\n  inverse () {\r\n    return this.clone().inverseO()\r\n  }\n\n  // Inverses matrix\n  inverseO () {\r\n    // Get the current parameters out of the matrix\r\n    const a = this.a\r\n    const b = this.b\r\n    const c = this.c\r\n    const d = this.d\r\n    const e = this.e\r\n    const f = this.f\r\n\r\n    // Invert the 2x2 matrix in the top left\r\n    const det = a * d - b * c\r\n    if (!det) throw new Error('Cannot invert ' + this)\r\n\r\n    // Calculate the top 2x2 matrix\r\n    const na = d / det\r\n    const nb = -b / det\r\n    const nc = -c / det\r\n    const nd = a / det\r\n\r\n    // Apply the inverted matrix to the top right\r\n    const ne = -(na * e + nc * f)\r\n    const nf = -(nb * e + nd * f)\r\n\r\n    // Construct the inverted matrix\r\n    this.a = na\r\n    this.b = nb\r\n    this.c = nc\r\n    this.d = nd\r\n    this.e = ne\r\n    this.f = nf\r\n\r\n    return this\r\n  }\n\n  lmultiply (matrix) {\r\n    return this.clone().lmultiplyO(matrix)\r\n  }\n\n  lmultiplyO (matrix) {\r\n    const r = this\r\n    const l = matrix instanceof Matrix\r\n      ? matrix\r\n      : new Matrix(matrix)\r\n\r\n    return Matrix.matrixMultiply(l, r, this)\r\n  }\n\n  // Left multiplies by the given matrix\n  multiply (matrix) {\r\n    return this.clone().multiplyO(matrix)\r\n  }\n\n  multiplyO (matrix) {\r\n    // Get the matrices\r\n    const l = this\r\n    const r = matrix instanceof Matrix\r\n      ? matrix\r\n      : new Matrix(matrix)\r\n\r\n    return Matrix.matrixMultiply(l, r, this)\r\n  }\n\n  // Rotate matrix\n  rotate (r, cx, cy) {\r\n    return this.clone().rotateO(r, cx, cy)\r\n  }\n\n  rotateO (r, cx = 0, cy = 0) {\r\n    // Convert degrees to radians\r\n    r = radians(r)\r\n\r\n    const cos = Math.cos(r)\r\n    const sin = Math.sin(r)\r\n\r\n    const { a, b, c, d, e, f } = this\r\n\r\n    this.a = a * cos - b * sin\r\n    this.b = b * cos + a * sin\r\n    this.c = c * cos - d * sin\r\n    this.d = d * cos + c * sin\r\n    this.e = e * cos - f * sin + cy * sin - cx * cos + cx\r\n    this.f = f * cos + e * sin - cx * sin - cy * cos + cy\r\n\r\n    return this\r\n  }\n\n  // Scale matrix\n  scale (x, y, cx, cy) {\r\n    return this.clone().scaleO(...arguments)\r\n  }\n\n  scaleO (x, y = x, cx = 0, cy = 0) {\r\n    // Support uniform scaling\r\n    if (arguments.length === 3) {\r\n      cy = cx\r\n      cx = y\r\n      y = x\r\n    }\r\n\r\n    const { a, b, c, d, e, f } = this\r\n\r\n    this.a = a * x\r\n    this.b = b * y\r\n    this.c = c * x\r\n    this.d = d * y\r\n    this.e = e * x - cx * x + cx\r\n    this.f = f * y - cy * y + cy\r\n\r\n    return this\r\n  }\n\n  // Shear matrix\n  shear (a, cx, cy) {\r\n    return this.clone().shearO(a, cx, cy)\r\n  }\n\n  shearO (lx, cx = 0, cy = 0) {\r\n    const { a, b, c, d, e, f } = this\r\n\r\n    this.a = a + b * lx\r\n    this.c = c + d * lx\r\n    this.e = e + f * lx - cy * lx\r\n\r\n    return this\r\n  }\n\n  // Skew Matrix\n  skew (x, y, cx, cy) {\r\n    return this.clone().skewO(...arguments)\r\n  }\n\n  skewO (x, y = x, cx = 0, cy = 0) {\r\n    // support uniformal skew\r\n    if (arguments.length === 3) {\r\n      cy = cx\r\n      cx = y\r\n      y = x\r\n    }\r\n\r\n    // Convert degrees to radians\r\n    x = radians(x)\r\n    y = radians(y)\r\n\r\n    const lx = Math.tan(x)\r\n    const ly = Math.tan(y)\r\n\r\n    const { a, b, c, d, e, f } = this\r\n\r\n    this.a = a + b * lx\r\n    this.b = b + a * ly\r\n    this.c = c + d * lx\r\n    this.d = d + c * ly\r\n    this.e = e + f * lx - cy * lx\r\n    this.f = f + e * ly - cx * ly\r\n\r\n    return this\r\n  }\n\n  // SkewX\n  skewX (x, cx, cy) {\r\n    return this.skew(x, 0, cx, cy)\r\n  }\n\n  // SkewY\n  skewY (y, cx, cy) {\r\n    return this.skew(0, y, cx, cy)\r\n  }\n\n  toArray () {\r\n    return [ this.a, this.b, this.c, this.d, this.e, this.f ]\r\n  }\n\n  // Convert matrix to string\n  toString () {\r\n    return 'matrix(' + this.a + ',' + this.b + ',' + this.c + ',' + this.d + ',' + this.e + ',' + this.f + ')'\r\n  }\n\n  // Transform a matrix into another matrix by manipulating the space\r\n  transform (o) {\r\n    // Check if o is a matrix and then left multiply it directly\r\n    if (Matrix.isMatrixLike(o)) {\r\n      const matrix = new Matrix(o)\r\n      return matrix.multiplyO(this)\r\n    }\r\n\r\n    // Get the proposed transformations and the current transformations\r\n    const t = Matrix.formatTransforms(o)\r\n    const current = this\r\n    const { x: ox, y: oy } = new Point(t.ox, t.oy).transform(current)\r\n\r\n    // Construct the resulting matrix\r\n    const transformer = new Matrix()\r\n      .translateO(t.rx, t.ry)\r\n      .lmultiplyO(current)\r\n      .translateO(-ox, -oy)\r\n      .scaleO(t.scaleX, t.scaleY)\r\n      .skewO(t.skewX, t.skewY)\r\n      .shearO(t.shear)\r\n      .rotateO(t.theta)\r\n      .translateO(ox, oy)\r\n\r\n    // If we want the origin at a particular place, we force it there\r\n    if (isFinite(t.px) || isFinite(t.py)) {\r\n      const origin = new Point(ox, oy).transform(transformer)\r\n      // TODO: Replace t.px with isFinite(t.px)\r\n      // Doesnt work because t.px is also 0 if it wasnt passed\r\n      const dx = isFinite(t.px) ? t.px - origin.x : 0\r\n      const dy = isFinite(t.py) ? t.py - origin.y : 0\r\n      transformer.translateO(dx, dy)\r\n    }\r\n\r\n    // Translate now after positioning\r\n    transformer.translateO(t.tx, t.ty)\r\n    return transformer\r\n  }\r\n\n  // Translate matrix\r\n  translate (x, y) {\r\n    return this.clone().translateO(x, y)\r\n  }\r\n\n  translateO (x, y) {\r\n    this.e += x || 0\r\n    this.f += y || 0\r\n    return this\r\n  }\r\n\n  valueOf () {\r\n    return {\r\n      a: this.a,\r\n      b: this.b,\r\n      c: this.c,\r\n      d: this.d,\r\n      e: this.e,\r\n      f: this.f\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport function ctm () {\r\n  return new Matrix(this.node.getCTM())\r\n}\r\n\r\nexport function screenCTM () {\r\n  /* https://bugzilla.mozilla.org/show_bug.cgi?id=1344537\r\n     This is needed because FF does not return the transformation matrix\r\n     for the inner coordinate system when getScreenCTM() is called on nested svgs.\r\n     However all other Browsers do that */\r\n  if (typeof this.isRoot === 'function' && !this.isRoot()) {\r\n    const rect = this.rect(1, 1)\r\n    const m = rect.node.getScreenCTM()\r\n    rect.remove()\r\n    return new Matrix(m)\r\n  }\r\n  return new Matrix(this.node.getScreenCTM())\r\n}\r\n\r\nregister(Matrix, 'Matrix')\r\n","import { globals } from '../../utils/window.js'\r\nimport { makeInstance } from '../../utils/adopter.js'\r\n\r\nexport default function parser () {\r\n  // Reuse cached element if possible\r\n  if (!parser.nodes) {\r\n    const svg = makeInstance().size(2, 0)\r\n    svg.node.style.cssText = [\r\n      'opacity: 0',\r\n      'position: absolute',\r\n      'left: -100%',\r\n      'top: -100%',\r\n      'overflow: hidden'\r\n    ].join(';')\r\n\r\n    svg.attr('focusable', 'false')\r\n    svg.attr('aria-hidden', 'true')\r\n\r\n    const path = svg.path().node\r\n\r\n    parser.nodes = { svg, path }\r\n  }\r\n\r\n  if (!parser.nodes.svg.node.parentNode) {\r\n    const b = globals.document.body || globals.document.documentElement\r\n    parser.nodes.svg.addTo(b)\r\n  }\r\n\r\n  return parser.nodes\r\n}\r\n","import { delimiter } from '../modules/core/regex.js'\r\nimport { globals } from '../utils/window.js'\r\nimport { register } from '../utils/adopter.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport Matrix from './Matrix.js'\r\nimport Point from './Point.js'\r\nimport parser from '../modules/core/parser.js'\r\n\r\nexport function isNulledBox (box) {\r\n  return !box.width && !box.height && !box.x && !box.y\r\n}\r\n\r\nexport function domContains (node) {\r\n  return node === globals.document\r\n    || (globals.document.documentElement.contains || function (node) {\r\n      // This is IE - it does not support contains() for top-level SVGs\r\n      while (node.parentNode) {\r\n        node = node.parentNode\r\n      }\r\n      return node === globals.document\r\n    }).call(globals.document.documentElement, node)\r\n}\r\n\r\nexport default class Box {\r\n  constructor (...args) {\r\n    this.init(...args)\r\n  }\r\n\r\n  addOffset () {\r\n    // offset by window scroll position, because getBoundingClientRect changes when window is scrolled\r\n    this.x += globals.window.pageXOffset\r\n    this.y += globals.window.pageYOffset\r\n    return new Box(this)\r\n  }\r\n\r\n  init (source) {\r\n    const base = [ 0, 0, 0, 0 ]\r\n    source = typeof source === 'string'\n      ? source.split(delimiter).map(parseFloat)\r\n      : Array.isArray(source)\n        ? source\r\n        : typeof source === 'object'\n          ? [ source.left != null\n            ? source.left\r\n            : source.x, source.top != null ? source.top : source.y, source.width, source.height ]\r\n          : arguments.length === 4\n            ? [].slice.call(arguments)\r\n            : base\r\n\r\n    this.x = source[0] || 0\r\n    this.y = source[1] || 0\r\n    this.width = this.w = source[2] || 0\r\n    this.height = this.h = source[3] || 0\r\n\r\n    // Add more bounding box properties\r\n    this.x2 = this.x + this.w\r\n    this.y2 = this.y + this.h\r\n    this.cx = this.x + this.w / 2\r\n    this.cy = this.y + this.h / 2\r\n\r\n    return this\r\n  }\r\n\r\n  isNulled () {\r\n    return isNulledBox(this)\r\n  }\r\n\r\n  // Merge rect box with another, return a new instance\r\n  merge (box) {\r\n    const x = Math.min(this.x, box.x)\r\n    const y = Math.min(this.y, box.y)\r\n    const width = Math.max(this.x + this.width, box.x + box.width) - x\r\n    const height = Math.max(this.y + this.height, box.y + box.height) - y\r\n\r\n    return new Box(x, y, width, height)\r\n  }\r\n\r\n  toArray () {\r\n    return [ this.x, this.y, this.width, this.height ]\r\n  }\r\n\r\n  toString () {\r\n    return this.x + ' ' + this.y + ' ' + this.width + ' ' + this.height\r\n  }\r\n\r\n  transform (m) {\r\n    if (!(m instanceof Matrix)) {\r\n      m = new Matrix(m)\r\n    }\r\n\r\n    let xMin = Infinity\r\n    let xMax = -Infinity\r\n    let yMin = Infinity\r\n    let yMax = -Infinity\r\n\r\n    const pts = [\r\n      new Point(this.x, this.y),\r\n      new Point(this.x2, this.y),\r\n      new Point(this.x, this.y2),\r\n      new Point(this.x2, this.y2)\r\n    ]\r\n\r\n    pts.forEach(function (p) {\r\n      p = p.transform(m)\r\n      xMin = Math.min(xMin, p.x)\r\n      xMax = Math.max(xMax, p.x)\r\n      yMin = Math.min(yMin, p.y)\r\n      yMax = Math.max(yMax, p.y)\r\n    })\r\n\r\n    return new Box(\r\n      xMin, yMin,\r\n      xMax - xMin,\r\n      yMax - yMin\r\n    )\r\n  }\r\n\r\n}\r\n\r\nfunction getBox (el, getBBoxFn, retry) {\r\n  let box\r\n\r\n  try {\r\n    // Try to get the box with the provided function\r\n    box = getBBoxFn(el.node)\r\n\r\n    // If the box is worthless and not even in the dom, retry\r\n    // by throwing an error here...\r\n    if (isNulledBox(box) && !domContains(el.node)) {\r\n      throw new Error('Element not in the dom')\r\n    }\r\n  } catch (e) {\r\n    // ... and calling the retry handler here\r\n    box = retry(el)\r\n  }\r\n\r\n  return box\r\n}\r\n\r\nexport function bbox () {\r\n  // Function to get bbox is getBBox()\r\n  const getBBox = (node) => node.getBBox()\r\n\r\n  // Take all measures so that a stupid browser renders the element\r\n  // so we can get the bbox from it when we try again\r\n  const retry = (el) => {\r\n    try {\r\n      const clone = el.clone().addTo(parser().svg).show()\r\n      const box = clone.node.getBBox()\r\n      clone.remove()\r\n      return box\r\n    } catch (e) {\r\n      // We give up...\r\n      throw new Error(`Getting bbox of element \"${el.node.nodeName}\" is not possible: ${e.toString()}`)\r\n    }\r\n  }\r\n\r\n  const box = getBox(this, getBBox, retry)\r\n  const bbox = new Box(box)\r\n\r\n  return bbox\r\n}\r\n\r\nexport function rbox (el) {\r\n  const getRBox = (node) => node.getBoundingClientRect()\r\n  const retry = (el) => {\r\n    // There is no point in trying tricks here because if we insert the element into the dom ourselves\r\n    // it obviously will be at the wrong position\r\n    throw new Error(`Getting rbox of element \"${el.node.nodeName}\" is not possible`)\r\n  }\r\n\r\n  const box = getBox(this, getRBox, retry)\r\n  const rbox = new Box(box)\r\n\r\n  // If an element was passed, we want the bbox in the coordinate system of that element\r\n  if (el) {\r\n    return rbox.transform(el.screenCTM().inverseO())\r\n  }\r\n\r\n  // Else we want it in absolute screen coordinates\r\n  // Therefore we need to add the scrollOffset\r\n  return rbox.addOffset()\r\n}\r\n\r\n// Checks whether the given point is inside the bounding box\r\nexport function inside (x, y) {\r\n  const box = this.bbox()\r\n\r\n  return x > box.x\r\n    && y > box.y\r\n    && x < box.x + box.width\r\n    && y < box.y + box.height\r\n}\r\n\r\nregisterMethods({\r\n  viewbox: {\r\n    viewbox (x, y, width, height) {\r\n      // act as getter\r\n      if (x == null) return new Box(this.attr('viewBox'))\r\n\r\n      // act as setter\r\n      return this.attr('viewBox', new Box(x, y, width, height))\r\n    },\r\n\r\n    zoom (level, point) {\r\n      // Its best to rely on the attributes here and here is why:\r\n      // clientXYZ: Doesn't work on non-root svgs because they dont have a CSSBox (silly!)\r\n      // getBoundingClientRect: Doesn't work because Chrome just ignores width and height of nested svgs completely\r\n      //                        that means, their clientRect is always as big as the content.\r\n      //                        Furthermore this size is incorrect if the element is further transformed by its parents\r\n      // computedStyle: Only returns meaningful values if css was used with px. We dont go this route here!\r\n      // getBBox: returns the bounding box of its content - that doesnt help!\r\n      let { width, height } = this.attr([ 'width', 'height' ])\r\n\r\n      // Width and height is a string when a number with a unit is present which we can't use\r\n      // So we try clientXYZ\r\n      if ((!width && !height) || (typeof width === 'string' || typeof height === 'string')) {\r\n        width = this.node.clientWidth\r\n        height = this.node.clientHeight\r\n      }\r\n\r\n      // Giving up...\r\n      if (!width || !height) {\r\n        throw new Error('Impossible to get absolute width and height. Please provide an absolute width and height attribute on the zooming element')\r\n      }\r\n\r\n      const v = this.viewbox()\r\n\r\n      const zoomX = width / v.width\r\n      const zoomY = height / v.height\r\n      const zoom = Math.min(zoomX, zoomY)\r\n\r\n      if (level == null) {\r\n        return zoom\r\n      }\r\n\r\n      let zoomAmount = zoom / level\r\n\r\n      // Set the zoomAmount to the highest value which is safe to process and recover from\r\n      // The * 100 is a bit of wiggle room for the matrix transformation\r\n      if (zoomAmount === Infinity) zoomAmount = Number.MAX_SAFE_INTEGER / 100\r\n\r\n      point = point || new Point(width / 2 / zoomX + v.x, height / 2 / zoomY + v.y)\r\n\r\n      const box = new Box(v).transform(\r\n        new Matrix({ scale: zoomAmount, origin: point })\r\n      )\r\n\r\n      return this.viewbox(box)\r\n    }\r\n  }\r\n})\r\n\r\nregister(Box, 'Box')\r\n","import { extend } from '../utils/adopter.js'\r\n// import { subClassArray } from './ArrayPolyfill.js'\r\n\r\nclass List extends Array {\r\n  constructor (arr = [], ...args) {\r\n    super(arr, ...args)\r\n    if (typeof arr === 'number') return this\r\n    this.length = 0\r\n    this.push(...arr)\r\n  }\r\n}\r\n\r\n/* = subClassArray('List', Array, function (arr = []) {\r\n  // This catches the case, that native map tries to create an array with new Array(1)\r\n  if (typeof arr === 'number') return this\r\n  this.length = 0\r\n  this.push(...arr)\r\n}) */\r\n\r\nexport default List\r\n\r\nextend([ List ], {\r\n  each (fnOrMethodName, ...args) {\r\n    if (typeof fnOrMethodName === 'function') {\r\n      return this.map((el, i, arr) => {\r\n        return fnOrMethodName.call(el, el, i, arr)\r\n      })\r\n    } else {\r\n      return this.map(el => {\r\n        return el[fnOrMethodName](...args)\r\n      })\r\n    }\r\n  },\r\n\r\n  toArray () {\r\n    return Array.prototype.concat.apply([], this)\r\n  }\r\n})\r\n\r\nconst reserved = [ 'toArray', 'constructor', 'each' ]\r\n\r\nList.extend = function (methods) {\r\n  methods = methods.reduce((obj, name) => {\r\n    // Don't overwrite own methods\r\n    if (reserved.includes(name)) return obj\r\n\r\n    // Don't add private methods\r\n    if (name[0] === '_') return obj\r\n\r\n    // Relay every call to each()\r\n    obj[name] = function (...attrs) {\r\n      return this.each(name, ...attrs)\r\n    }\r\n    return obj\r\n  }, {})\r\n\r\n  extend([ List ], methods)\r\n}\r\n","import { adopt } from '../../utils/adopter.js'\r\nimport { globals } from '../../utils/window.js'\r\nimport { map } from '../../utils/utils.js'\r\nimport List from '../../types/List.js'\r\n\r\nexport default function baseFind (query, parent) {\r\n  return new List(map((parent || globals.document).querySelectorAll(query), function (node) {\r\n    return adopt(node)\r\n  }))\r\n}\r\n\r\n// Scoped find method\r\nexport function find (query) {\r\n  return baseFind(query, this.node)\r\n}\r\n\r\nexport function findOne (query) {\r\n  return adopt(this.node.querySelector(query))\r\n}\r\n","import { delimiter } from './regex.js'\r\nimport { makeInstance } from '../../utils/adopter.js'\r\nimport { globals } from '../../utils/window.js'\r\n\r\nlet listenerId = 0\r\nexport const windowEvents = {}\r\n\r\nexport function getEvents (instance) {\r\n  let n = instance.getEventHolder()\r\n\r\n  // We dont want to save events in global space\r\n  if (n === globals.window) n = windowEvents\r\n  if (!n.events) n.events = {}\r\n  return n.events\r\n}\r\n\r\nexport function getEventTarget (instance) {\r\n  return instance.getEventTarget()\r\n}\r\n\r\nexport function clearEvents (instance) {\r\n  let n = instance.getEventHolder()\r\n  if (n === globals.window) n = windowEvents\r\n  if (n.events) n.events = {}\r\n}\r\n\r\n// Add event binder in the SVG namespace\r\nexport function on (node, events, listener, binding, options) {\r\n  const l = listener.bind(binding || node)\r\n  const instance = makeInstance(node)\r\n  const bag = getEvents(instance)\r\n  const n = getEventTarget(instance)\r\n\r\n  // events can be an array of events or a string of events\r\n  events = Array.isArray(events) ? events : events.split(delimiter)\r\n\r\n  // add id to listener\r\n  if (!listener._svgjsListenerId) {\r\n    listener._svgjsListenerId = ++listenerId\r\n  }\r\n\r\n  events.forEach(function (event) {\r\n    const ev = event.split('.')[0]\r\n    const ns = event.split('.')[1] || '*'\r\n\r\n    // ensure valid object\r\n    bag[ev] = bag[ev] || {}\r\n    bag[ev][ns] = bag[ev][ns] || {}\r\n\r\n    // reference listener\r\n    bag[ev][ns][listener._svgjsListenerId] = l\r\n\r\n    // add listener\r\n    n.addEventListener(ev, l, options || false)\r\n  })\r\n}\r\n\r\n// Add event unbinder in the SVG namespace\r\nexport function off (node, events, listener, options) {\r\n  const instance = makeInstance(node)\r\n  const bag = getEvents(instance)\r\n  const n = getEventTarget(instance)\r\n\r\n  // listener can be a function or a number\r\n  if (typeof listener === 'function') {\r\n    listener = listener._svgjsListenerId\r\n    if (!listener) return\r\n  }\r\n\r\n  // events can be an array of events or a string or undefined\r\n  events = Array.isArray(events) ? events : (events || '').split(delimiter)\r\n\r\n  events.forEach(function (event) {\r\n    const ev = event && event.split('.')[0]\r\n    const ns = event && event.split('.')[1]\r\n    let namespace, l\r\n\r\n    if (listener) {\r\n      // remove listener reference\r\n      if (bag[ev] && bag[ev][ns || '*']) {\r\n        // removeListener\r\n        n.removeEventListener(ev, bag[ev][ns || '*'][listener], options || false)\r\n\r\n        delete bag[ev][ns || '*'][listener]\r\n      }\r\n    } else if (ev && ns) {\r\n      // remove all listeners for a namespaced event\r\n      if (bag[ev] && bag[ev][ns]) {\r\n        for (l in bag[ev][ns]) {\r\n          off(n, [ ev, ns ].join('.'), l)\r\n        }\r\n\r\n        delete bag[ev][ns]\r\n      }\r\n    } else if (ns) {\r\n      // remove all listeners for a specific namespace\r\n      for (event in bag) {\r\n        for (namespace in bag[event]) {\r\n          if (ns === namespace) {\r\n            off(n, [ event, ns ].join('.'))\r\n          }\r\n        }\r\n      }\r\n    } else if (ev) {\r\n      // remove all listeners for the event\r\n      if (bag[ev]) {\r\n        for (namespace in bag[ev]) {\r\n          off(n, [ ev, namespace ].join('.'))\r\n        }\r\n\r\n        delete bag[ev]\r\n      }\r\n    } else {\r\n      // remove all listeners on a given node\r\n      for (event in bag) {\r\n        off(n, event)\r\n      }\r\n\r\n      clearEvents(instance)\r\n    }\r\n  })\r\n}\r\n\r\nexport function dispatch (node, event, data, options) {\r\n  const n = getEventTarget(node)\r\n\r\n  // Dispatch event\r\n  if (event instanceof globals.window.Event) {\r\n    n.dispatchEvent(event)\r\n  } else {\r\n    event = new globals.window.CustomEvent(event, { detail: data, cancelable: true, ...options })\r\n    n.dispatchEvent(event)\r\n  }\r\n  return event\r\n}\r\n","import { dispatch, off, on } from '../modules/core/event.js'\nimport { register } from '../utils/adopter.js'\nimport Base from './Base.js'\n\nexport default class EventTarget extends Base {\n  addEventListener () {}\n\n  dispatch (event, data, options) {\n    return dispatch(this, event, data, options)\n  }\n\n  dispatchEvent (event) {\n    const bag = this.getEventHolder().events\n    if (!bag) return true\n\n    const events = bag[event.type]\n\n    for (const i in events) {\n      for (const j in events[i]) {\n        events[i][j](event)\n      }\n    }\n\n    return !event.defaultPrevented\n  }\n\n  // Fire given event\n  fire (event, data, options) {\n    this.dispatch(event, data, options)\n    return this\n  }\n\n  getEventHolder () {\n    return this\n  }\n\n  getEventTarget () {\n    return this\n  }\n\n  // Unbind event from listener\n  off (event, listener, options) {\n    off(this, event, listener, options)\n    return this\n  }\n\n  // Bind given event to listener\n  on (event, listener, binding, options) {\n    on(this, event, listener, binding, options)\n    return this\n  }\n\n  removeEventListener () {}\n}\n\nregister(EventTarget, 'EventTarget')\n","\r\nexport function noop () {}\r\n\r\n// Default animation values\r\nexport const timeline = {\r\n  duration: 400,\r\n  ease: '>',\r\n  delay: 0\r\n}\r\n\r\n// Default attribute values\r\nexport const attrs = {\r\n\r\n  // fill and stroke\r\n  'fill-opacity': 1,\r\n  'stroke-opacity': 1,\r\n  'stroke-width': 0,\r\n  'stroke-linejoin': 'miter',\r\n  'stroke-linecap': 'butt',\r\n  fill: '#000000',\r\n  stroke: '#000000',\r\n  opacity: 1,\r\n\r\n  // position\r\n  x: 0,\r\n  y: 0,\r\n  cx: 0,\r\n  cy: 0,\r\n\r\n  // size\r\n  width: 0,\r\n  height: 0,\r\n\r\n  // radius\r\n  r: 0,\r\n  rx: 0,\r\n  ry: 0,\r\n\r\n  // gradient\r\n  offset: 0,\r\n  'stop-opacity': 1,\r\n  'stop-color': '#000000',\r\n\r\n  // text\r\n  'text-anchor': 'start'\r\n}\r\n","import { delimiter } from '../modules/core/regex.js'\r\n\r\nexport default class SVGArray extends Array {\r\n  constructor (...args) {\r\n    super(...args)\r\n    this.init(...args)\r\n  }\r\n\r\n  clone () {\r\n    return new this.constructor(this)\r\n  }\n\n  init (arr) {\r\n    // This catches the case, that native map tries to create an array with new Array(1)\r\n    if (typeof arr === 'number') return this\r\n    this.length = 0\r\n    this.push(...this.parse(arr))\r\n    return this\r\n  }\r\n\r\n  // Parse whitespace separated string\n  parse (array = []) {\r\n    // If already is an array, no need to parse it\r\n    if (array instanceof Array) return array\r\n\r\n    return array.trim().split(delimiter).map(parseFloat)\r\n  }\n\n  toArray () {\r\n    return Array.prototype.concat.apply([], this)\r\n  }\r\n\r\n  toSet () {\r\n    return new Set(this)\r\n  }\n\n  toString () {\r\n    return this.join(' ')\r\n  }\r\n\r\n  // Flattens the array if needed\r\n  valueOf () {\r\n    const ret = []\r\n    ret.push(...this)\r\n    return ret\r\n  }\r\n\r\n}\r\n","import { numberAndUnit } from '../modules/core/regex.js'\r\n\r\n// Module for unit conversions\r\nexport default class SVGNumber {\r\n  // Initialize\r\n  constructor (...args) {\r\n    this.init(...args)\r\n  }\r\n\r\n  convert (unit) {\r\n    return new SVGNumber(this.value, unit)\r\n  }\r\n\r\n  // Divide number\r\n  divide (number) {\r\n    number = new SVGNumber(number)\r\n    return new SVGNumber(this / number, this.unit || number.unit)\r\n  }\r\n\r\n  init (value, unit) {\r\n    unit = Array.isArray(value) ? value[1] : unit\r\n    value = Array.isArray(value) ? value[0] : value\r\n\r\n    // initialize defaults\r\n    this.value = 0\r\n    this.unit = unit || ''\r\n\r\n    // parse value\r\n    if (typeof value === 'number') {\r\n      // ensure a valid numeric value\r\n      this.value = isNaN(value) ? 0 : !isFinite(value) ? (value < 0 ? -3.4e+38 : +3.4e+38) : value\r\n    } else if (typeof value === 'string') {\r\n      unit = value.match(numberAndUnit)\r\n\r\n      if (unit) {\r\n        // make value numeric\r\n        this.value = parseFloat(unit[1])\r\n\r\n        // normalize\r\n        if (unit[5] === '%') {\r\n          this.value /= 100\r\n        } else if (unit[5] === 's') {\r\n          this.value *= 1000\r\n        }\r\n\r\n        // store unit\r\n        this.unit = unit[5]\r\n      }\r\n    } else {\r\n      if (value instanceof SVGNumber) {\r\n        this.value = value.valueOf()\r\n        this.unit = value.unit\r\n      }\r\n    }\r\n\r\n    return this\r\n  }\r\n\r\n  // Subtract number\r\n  minus (number) {\r\n    number = new SVGNumber(number)\r\n    return new SVGNumber(this - number, this.unit || number.unit)\r\n  }\r\n\r\n  // Add number\r\n  plus (number) {\r\n    number = new SVGNumber(number)\r\n    return new SVGNumber(this + number, this.unit || number.unit)\r\n  }\r\n\r\n  // Multiply number\r\n  times (number) {\r\n    number = new SVGNumber(number)\r\n    return new SVGNumber(this * number, this.unit || number.unit)\r\n  }\r\n\r\n  toArray () {\r\n    return [ this.value, this.unit ]\r\n  }\r\n\r\n  toJSON () {\r\n    return this.toString()\r\n  }\r\n\r\n  toString () {\r\n    return (this.unit === '%'\n      ? ~~(this.value * 1e8) / 1e6\r\n      : this.unit === 's'\n        ? this.value / 1e3\r\n        : this.value\r\n    ) + this.unit\r\n  }\r\n\r\n  valueOf () {\r\n    return this.value\r\n  }\r\n\r\n}\r\n","import { attrs as defaults } from './defaults.js'\r\nimport { isNumber } from './regex.js'\r\nimport Color from '../../types/Color.js'\r\nimport SVGArray from '../../types/SVGArray.js'\r\nimport SVGNumber from '../../types/SVGNumber.js'\r\n\r\nconst hooks = []\r\nexport function registerAttrHook (fn) {\r\n  hooks.push(fn)\r\n}\r\n\r\n// Set svg element attribute\r\nexport default function attr (attr, val, ns) {\r\n  // act as full getter\r\n  if (attr == null) {\r\n    // get an object of attributes\r\n    attr = {}\r\n    val = this.node.attributes\r\n\r\n    for (const node of val) {\r\n      attr[node.nodeName] = isNumber.test(node.nodeValue)\r\n        ? parseFloat(node.nodeValue)\r\n        : node.nodeValue\r\n    }\r\n\r\n    return attr\r\n  } else if (attr instanceof Array) {\r\n    // loop through array and get all values\r\n    return attr.reduce((last, curr) => {\r\n      last[curr] = this.attr(curr)\r\n      return last\r\n    }, {})\r\n  } else if (typeof attr === 'object' && attr.constructor === Object) {\r\n    // apply every attribute individually if an object is passed\r\n    for (val in attr) this.attr(val, attr[val])\r\n  } else if (val === null) {\r\n    // remove value\r\n    this.node.removeAttribute(attr)\r\n  } else if (val == null) {\r\n    // act as a getter if the first and only argument is not an object\r\n    val = this.node.getAttribute(attr)\r\n    return val == null\n      ? defaults[attr]\r\n      : isNumber.test(val)\n        ? parseFloat(val)\r\n        : val\r\n  } else {\r\n    // Loop through hooks and execute them to convert value\r\n    val = hooks.reduce((_val, hook) => {\r\n      return hook(attr, _val, this)\r\n    }, val)\r\n\r\n    // ensure correct numeric values (also accepts NaN and Infinity)\r\n    if (typeof val === 'number') {\r\n      val = new SVGNumber(val)\r\n    } else if (Color.isColor(val)) {\r\n      // ensure full hex color\r\n      val = new Color(val)\r\n    } else if (val.constructor === Array) {\r\n      // Check for plain arrays and parse array values\r\n      val = new SVGArray(val)\r\n    }\r\n\r\n    // if the passed attribute is leading...\r\n    if (attr === 'leading') {\r\n      // ... call the leading method instead\r\n      if (this.leading) {\r\n        this.leading(val)\r\n      }\r\n    } else {\r\n      // set given attribute on node\r\n      typeof ns === 'string'\n        ? this.node.setAttributeNS(ns, attr, val.toString())\r\n        : this.node.setAttribute(attr, val.toString())\r\n    }\r\n\r\n    // rebuild if required\r\n    if (this.rebuild && (attr === 'font-size' || attr === 'x')) {\r\n      this.rebuild()\r\n    }\r\n  }\r\n\r\n  return this\r\n}\r\n","import {\r\n  adopt,\r\n  assignNewId,\r\n  eid,\r\n  extend,\r\n  makeInstance,\r\n  create,\r\n  register\r\n} from '../utils/adopter.js'\r\nimport { find, findOne } from '../modules/core/selector.js'\r\nimport { globals } from '../utils/window.js'\r\nimport { map } from '../utils/utils.js'\r\nimport { svg, html } from '../modules/core/namespaces.js'\r\nimport EventTarget from '../types/EventTarget.js'\r\nimport List from '../types/List.js'\r\nimport attr from '../modules/core/attr.js'\r\n\r\nexport default class Dom extends EventTarget {\r\n  constructor (node, attrs) {\r\n    super()\r\n    this.node = node\r\n    this.type = node.nodeName\r\n\r\n    if (attrs && node !== attrs) {\r\n      this.attr(attrs)\r\n    }\r\n  }\r\n\r\n  // Add given element at a position\r\n  add (element, i) {\r\n    element = makeInstance(element)\r\n\r\n    // If non-root svg nodes are added we have to remove their namespaces\r\n    if (element.removeNamespace && this.node instanceof globals.window.SVGElement) {\r\n      element.removeNamespace()\r\n    }\r\n\r\n    if (i == null) {\r\n      this.node.appendChild(element.node)\r\n    } else if (element.node !== this.node.childNodes[i]) {\r\n      this.node.insertBefore(element.node, this.node.childNodes[i])\r\n    }\r\n\r\n    return this\r\n  }\r\n\r\n  // Add element to given container and return self\r\n  addTo (parent, i) {\r\n    return makeInstance(parent).put(this, i)\r\n  }\r\n\r\n  // Returns all child elements\r\n  children () {\r\n    return new List(map(this.node.children, function (node) {\r\n      return adopt(node)\r\n    }))\r\n  }\r\n\r\n  // Remove all elements in this container\r\n  clear () {\r\n    // remove children\r\n    while (this.node.hasChildNodes()) {\r\n      this.node.removeChild(this.node.lastChild)\r\n    }\r\n\r\n    return this\r\n  }\r\n\r\n  // Clone element\r\n  clone (deep = true) {\r\n    // write dom data to the dom so the clone can pickup the data\r\n    this.writeDataToDom()\r\n\r\n    // clone element and assign new id\r\n    return new this.constructor(assignNewId(this.node.cloneNode(deep)))\r\n  }\r\n\r\n  // Iterates over all children and invokes a given block\r\n  each (block, deep) {\r\n    const children = this.children()\r\n    let i, il\r\n\r\n    for (i = 0, il = children.length; i < il; i++) {\r\n      block.apply(children[i], [ i, children ])\r\n\r\n      if (deep) {\r\n        children[i].each(block, deep)\r\n      }\r\n    }\r\n\r\n    return this\r\n  }\r\n\r\n  element (nodeName, attrs) {\r\n    return this.put(new Dom(create(nodeName), attrs))\r\n  }\r\n\r\n  // Get first child\r\n  first () {\r\n    return adopt(this.node.firstChild)\r\n  }\r\n\r\n  // Get a element at the given index\r\n  get (i) {\r\n    return adopt(this.node.childNodes[i])\r\n  }\r\n\r\n  getEventHolder () {\r\n    return this.node\r\n  }\r\n\r\n  getEventTarget () {\r\n    return this.node\r\n  }\r\n\r\n  // Checks if the given element is a child\r\n  has (element) {\r\n    return this.index(element) >= 0\r\n  }\r\n\r\n  html (htmlOrFn, outerHTML) {\r\n    return this.xml(htmlOrFn, outerHTML, html)\r\n  }\r\n\r\n  // Get / set id\r\n  id (id) {\r\n    // generate new id if no id set\r\n    if (typeof id === 'undefined' && !this.node.id) {\r\n      this.node.id = eid(this.type)\r\n    }\r\n\r\n    // don't set directly with this.node.id to make `null` work correctly\r\n    return this.attr('id', id)\r\n  }\r\n\r\n  // Gets index of given element\r\n  index (element) {\r\n    return [].slice.call(this.node.childNodes).indexOf(element.node)\r\n  }\r\n\r\n  // Get the last child\r\n  last () {\r\n    return adopt(this.node.lastChild)\r\n  }\r\n\r\n  // matches the element vs a css selector\r\n  matches (selector) {\r\n    const el = this.node\r\n    const matcher = el.matches || el.matchesSelector || el.msMatchesSelector || el.mozMatchesSelector || el.webkitMatchesSelector || el.oMatchesSelector || null\r\n    return matcher && matcher.call(el, selector)\r\n  }\r\n\r\n  // Returns the parent element instance\r\n  parent (type) {\r\n    let parent = this\r\n\r\n    // check for parent\r\n    if (!parent.node.parentNode) return null\r\n\r\n    // get parent element\r\n    parent = adopt(parent.node.parentNode)\r\n\r\n    if (!type) return parent\r\n\r\n    // loop trough ancestors if type is given\r\n    do {\r\n      if (typeof type === 'string' ? parent.matches(type) : parent instanceof type) return parent\r\n    } while ((parent = adopt(parent.node.parentNode)))\r\n\r\n    return parent\r\n  }\r\n\r\n  // Basically does the same as `add()` but returns the added element instead\r\n  put (element, i) {\r\n    element = makeInstance(element)\r\n    this.add(element, i)\r\n    return element\r\n  }\r\n\r\n  // Add element to given container and return container\r\n  putIn (parent, i) {\r\n    return makeInstance(parent).add(this, i)\r\n  }\r\n\r\n  // Remove element\r\n  remove () {\r\n    if (this.parent()) {\r\n      this.parent().removeElement(this)\r\n    }\r\n\r\n    return this\r\n  }\r\n\r\n  // Remove a given child\r\n  removeElement (element) {\r\n    this.node.removeChild(element.node)\r\n\r\n    return this\r\n  }\r\n\r\n  // Replace this with element\r\n  replace (element) {\r\n    element = makeInstance(element)\r\n\r\n    if (this.node.parentNode) {\r\n      this.node.parentNode.replaceChild(element.node, this.node)\r\n    }\r\n\r\n    return element\r\n  }\r\n\r\n  round (precision = 2, map = null) {\r\n    const factor = 10 ** precision\r\n    const attrs = this.attr(map)\r\n\r\n    for (const i in attrs) {\r\n      if (typeof attrs[i] === 'number') {\r\n        attrs[i] = Math.round(attrs[i] * factor) / factor\r\n      }\r\n    }\r\n\r\n    this.attr(attrs)\r\n    return this\r\n  }\r\n\r\n  // Import / Export raw svg\r\n  svg (svgOrFn, outerSVG) {\r\n    return this.xml(svgOrFn, outerSVG, svg)\r\n  }\r\n\r\n  // Return id on string conversion\r\n  toString () {\r\n    return this.id()\r\n  }\r\n\r\n  words (text) {\r\n    // This is faster than removing all children and adding a new one\r\n    this.node.textContent = text\r\n    return this\r\n  }\r\n\r\n  wrap (node) {\r\n    const parent = this.parent()\r\n\r\n    if (!parent) {\r\n      return this.addTo(node)\r\n    }\r\n\r\n    const position = parent.index(this)\r\n    return parent.put(node, position).put(this)\r\n  }\r\n\r\n  // write svgjs data to the dom\r\n  writeDataToDom () {\r\n    // dump variables recursively\r\n    this.each(function () {\r\n      this.writeDataToDom()\r\n    })\r\n\r\n    return this\r\n  }\r\n\r\n  // Import / Export raw svg\r\n  xml (xmlOrFn, outerXML, ns) {\r\n    if (typeof xmlOrFn === 'boolean') {\r\n      ns = outerXML\r\n      outerXML = xmlOrFn\r\n      xmlOrFn = null\r\n    }\r\n\r\n    // act as getter if no svg string is given\r\n    if (xmlOrFn == null || typeof xmlOrFn === 'function') {\r\n      // The default for exports is, that the outerNode is included\r\n      outerXML = outerXML == null ? true : outerXML\r\n\r\n      // write svgjs data to the dom\r\n      this.writeDataToDom()\r\n      let current = this\r\n\r\n      // An export modifier was passed\r\n      if (xmlOrFn != null) {\r\n        current = adopt(current.node.cloneNode(true))\r\n\r\n        // If the user wants outerHTML we need to process this node, too\r\n        if (outerXML) {\r\n          const result = xmlOrFn(current)\r\n          current = result || current\r\n\r\n          // The user does not want this node? Well, then he gets nothing\r\n          if (result === false) return ''\r\n        }\r\n\r\n        // Deep loop through all children and apply modifier\r\n        current.each(function () {\r\n          const result = xmlOrFn(this)\r\n          const _this = result || this\r\n\r\n          // If modifier returns false, discard node\r\n          if (result === false) {\r\n            this.remove()\r\n\r\n            // If modifier returns new node, use it\r\n          } else if (result && this !== _this) {\r\n            this.replace(_this)\r\n          }\r\n        }, true)\r\n      }\r\n\r\n      // Return outer or inner content\r\n      return outerXML\r\n        ? current.node.outerHTML\r\n        : current.node.innerHTML\r\n    }\r\n\r\n    // Act as setter if we got a string\r\n\r\n    // The default for import is, that the current node is not replaced\r\n    outerXML = outerXML == null ? false : outerXML\r\n\r\n    // Create temporary holder\r\n    const well = create('wrapper', ns)\r\n    const fragment = globals.document.createDocumentFragment()\r\n\r\n    // Dump raw svg\r\n    well.innerHTML = xmlOrFn\r\n\r\n    // Transplant nodes into the fragment\r\n    for (let len = well.children.length; len--;) {\r\n      fragment.appendChild(well.firstElementChild)\r\n    }\r\n\r\n    const parent = this.parent()\r\n\r\n    // Add the whole fragment at once\r\n    return outerXML\r\n      ? this.replace(fragment) && parent\r\n      : this.add(fragment)\r\n  }\r\n}\r\n\r\nextend(Dom, { attr, find, findOne })\r\nregister(Dom, 'Dom')\r\n","import { bbox, rbox, inside } from '../types/Box.js'\nimport { ctm, screenCTM } from '../types/Matrix.js'\nimport {\n  extend,\n  getClass,\n  makeInstance,\n  register,\n  root\n} from '../utils/adopter.js'\nimport { globals } from '../utils/window.js'\nimport { point } from '../types/Point.js'\nimport { proportionalSize } from '../utils/utils.js'\nimport { reference } from '../modules/core/regex.js'\nimport Dom from './Dom.js'\nimport List from '../types/List.js'\nimport SVGNumber from '../types/SVGNumber.js'\n\nexport default class Element extends Dom {\n  constructor (node, attrs) {\n    super(node, attrs)\n\n    // initialize data object\n    this.dom = {}\n\n    // create circular reference\n    this.node.instance = this\n\n    if (node.hasAttribute('svgjs:data')) {\n      // pull svgjs data from the dom (getAttributeNS doesn't work in html5)\n      this.setData(JSON.parse(node.getAttribute('svgjs:data')) || {})\n    }\n  }\n\n  // Move element by its center\n  center (x, y) {\n    return this.cx(x).cy(y)\n  }\n\n  // Move by center over x-axis\n  cx (x) {\n    return x == null\n      ? this.x() + this.width() / 2\n      : this.x(x - this.width() / 2)\n  }\n\n  // Move by center over y-axis\n  cy (y) {\n    return y == null\n      ? this.y() + this.height() / 2\n      : this.y(y - this.height() / 2)\n  }\n\n  // Get defs\n  defs () {\n    const root = this.root()\n    return root && root.defs()\n  }\n\n  // Relative move over x and y axes\n  dmove (x, y) {\n    return this.dx(x).dy(y)\n  }\n\n  // Relative move over x axis\n  dx (x = 0) {\n    return this.x(new SVGNumber(x).plus(this.x()))\n  }\n\n  // Relative move over y axis\n  dy (y = 0) {\n    return this.y(new SVGNumber(y).plus(this.y()))\n  }\n\n  getEventHolder () {\n    return this\n  }\n\n  // Set height of element\n  height (height) {\n    return this.attr('height', height)\n  }\n\n  // Move element to given x and y values\n  move (x, y) {\n    return this.x(x).y(y)\n  }\n\n  // return array of all ancestors of given type up to the root svg\n  parents (until = this.root()) {\n    const isSelector = typeof until === 'string'\n    if (!isSelector) {\n      until = makeInstance(until)\n    }\n    const parents = new List()\n    let parent = this\n\n    while (\n      (parent = parent.parent())\n      && parent.node !== globals.document\n      && parent.nodeName !== '#document-fragment') {\n\n      parents.push(parent)\n\n      if (!isSelector && (parent.node === until.node)) {\n        break\n      }\n      if (isSelector && parent.matches(until)) {\n        break\n      }\n      if (parent.node === this.root().node) {\n        // We worked our way to the root and didn't match `until`\n        return null\n      }\n    }\n\n    return parents\n  }\n\n  // Get referenced element form attribute value\n  reference (attr) {\n    attr = this.attr(attr)\n    if (!attr) return null\n\n    const m = (attr + '').match(reference)\n    return m ? makeInstance(m[1]) : null\n  }\n\n  // Get parent document\n  root () {\n    const p = this.parent(getClass(root))\n    return p && p.root()\n  }\n\n  // set given data to the elements data property\n  setData (o) {\n    this.dom = o\n    return this\n  }\n\n  // Set element size to given width and height\n  size (width, height) {\n    const p = proportionalSize(this, width, height)\n\n    return this\n      .width(new SVGNumber(p.width))\n      .height(new SVGNumber(p.height))\n  }\n\n  // Set width of element\n  width (width) {\n    return this.attr('width', width)\n  }\n\n  // write svgjs data to the dom\n  writeDataToDom () {\n    // remove previously set data\n    this.node.removeAttribute('svgjs:data')\n\n    if (Object.keys(this.dom).length) {\n      this.node.setAttribute('svgjs:data', JSON.stringify(this.dom)) // see #428\n    }\n\n    return super.writeDataToDom()\n  }\n\n  // Move over x-axis\n  x (x) {\n    return this.attr('x', x)\n  }\n\n  // Move over y-axis\n  y (y) {\n    return this.attr('y', y)\n  }\n}\n\nextend(Element, {\n  bbox, rbox, inside, point, ctm, screenCTM\n})\n\nregister(Element, 'Element')\n","import { registerMethods } from '../../utils/methods.js'\r\nimport Color from '../../types/Color.js'\r\nimport Element from '../../elements/Element.js'\r\nimport Matrix from '../../types/Matrix.js'\r\nimport Point from '../../types/Point.js'\r\nimport SVGNumber from '../../types/SVGNumber.js'\r\n\r\n// Define list of available attributes for stroke and fill\r\nconst sugar = {\r\n  stroke: [ 'color', 'width', 'opacity', 'linecap', 'linejoin', 'miterlimit', 'dasharray', 'dashoffset' ],\r\n  fill: [ 'color', 'opacity', 'rule' ],\r\n  prefix: function (t, a) {\r\n    return a === 'color' ? t : t + '-' + a\r\n  }\r\n}\r\n\r\n// Add sugar for fill and stroke\r\n;[ 'fill', 'stroke' ].forEach(function (m) {\r\n  const extension = {}\r\n  let i\r\n\r\n  extension[m] = function (o) {\r\n    if (typeof o === 'undefined') {\r\n      return this.attr(m)\r\n    }\r\n    if (typeof o === 'string' || o instanceof Color || Color.isRgb(o) || (o instanceof Element)) {\r\n      this.attr(m, o)\r\n    } else {\r\n      // set all attributes from sugar.fill and sugar.stroke list\r\n      for (i = sugar[m].length - 1; i >= 0; i--) {\r\n        if (o[sugar[m][i]] != null) {\r\n          this.attr(sugar.prefix(m, sugar[m][i]), o[sugar[m][i]])\r\n        }\r\n      }\r\n    }\r\n\r\n    return this\r\n  }\r\n\r\n  registerMethods([ 'Element', 'Runner' ], extension)\r\n})\r\n\r\nregisterMethods([ 'Element', 'Runner' ], {\r\n  // Let the user set the matrix directly\r\n  matrix: function (mat, b, c, d, e, f) {\r\n    // Act as a getter\r\n    if (mat == null) {\r\n      return new Matrix(this)\r\n    }\r\n\r\n    // Act as a setter, the user can pass a matrix or a set of numbers\r\n    return this.attr('transform', new Matrix(mat, b, c, d, e, f))\r\n  },\r\n\r\n  // Map rotation to transform\r\n  rotate: function (angle, cx, cy) {\r\n    return this.transform({ rotate: angle, ox: cx, oy: cy }, true)\r\n  },\r\n\r\n  // Map skew to transform\r\n  skew: function (x, y, cx, cy) {\r\n    return arguments.length === 1 || arguments.length === 3\r\n      ? this.transform({ skew: x, ox: y, oy: cx }, true)\r\n      : this.transform({ skew: [ x, y ], ox: cx, oy: cy }, true)\r\n  },\r\n\r\n  shear: function (lam, cx, cy) {\r\n    return this.transform({ shear: lam, ox: cx, oy: cy }, true)\r\n  },\r\n\r\n  // Map scale to transform\r\n  scale: function (x, y, cx, cy) {\r\n    return arguments.length === 1 || arguments.length === 3\r\n      ? this.transform({ scale: x, ox: y, oy: cx }, true)\r\n      : this.transform({ scale: [ x, y ], ox: cx, oy: cy }, true)\r\n  },\r\n\r\n  // Map translate to transform\r\n  translate: function (x, y) {\r\n    return this.transform({ translate: [ x, y ] }, true)\r\n  },\r\n\r\n  // Map relative translations to transform\r\n  relative: function (x, y) {\r\n    return this.transform({ relative: [ x, y ] }, true)\r\n  },\r\n\r\n  // Map flip to transform\r\n  flip: function (direction = 'both', origin = 'center') {\r\n    if ('xybothtrue'.indexOf(direction) === -1) {\r\n      origin = direction\r\n      direction = 'both'\r\n    }\r\n\r\n    return this.transform({ flip: direction, origin: origin }, true)\r\n  },\r\n\r\n  // Opacity\r\n  opacity: function (value) {\r\n    return this.attr('opacity', value)\r\n  }\r\n})\r\n\r\nregisterMethods('radius', {\r\n  // Add x and y radius\r\n  radius: function (x, y = x) {\r\n    const type = (this._element || this).type\r\n    return type === 'radialGradient'\r\n      ? this.attr('r', new SVGNumber(x))\r\n      : this.rx(x).ry(y)\r\n  }\r\n})\r\n\r\nregisterMethods('Path', {\r\n  // Get path length\r\n  length: function () {\r\n    return this.node.getTotalLength()\r\n  },\r\n  // Get point at length\r\n  pointAt: function (length) {\r\n    return new Point(this.node.getPointAtLength(length))\r\n  }\r\n})\r\n\r\nregisterMethods([ 'Element', 'Runner' ], {\r\n  // Set font\r\n  font: function (a, v) {\r\n    if (typeof a === 'object') {\r\n      for (v in a) this.font(v, a[v])\r\n      return this\r\n    }\r\n\r\n    return a === 'leading'\r\n      ? this.leading(v)\r\n      : a === 'anchor'\r\n        ? this.attr('text-anchor', v)\r\n        : a === 'size' || a === 'family' || a === 'weight' || a === 'stretch' || a === 'variant' || a === 'style'\r\n          ? this.attr('font-' + a, v)\r\n          : this.attr(a, v)\r\n  }\r\n})\r\n\r\n// Add events to elements\r\nconst methods = [ 'click',\r\n  'dblclick',\r\n  'mousedown',\r\n  'mouseup',\r\n  'mouseover',\r\n  'mouseout',\r\n  'mousemove',\r\n  'mouseenter',\r\n  'mouseleave',\r\n  'touchstart',\r\n  'touchmove',\r\n  'touchleave',\r\n  'touchend',\r\n  'touchcancel' ].reduce(function (last, event) {\r\n  // add event to Element\r\n  const fn = function (f) {\r\n    if (f === null) {\r\n      this.off(event)\r\n    } else {\r\n      this.on(event, f)\r\n    }\r\n    return this\r\n  }\r\n\r\n  last[event] = fn\r\n  return last\r\n}, {})\r\n\r\nregisterMethods('Element', methods)\r\n","import { getOrigin } from '../../utils/utils.js'\r\nimport { delimiter, transforms } from '../core/regex.js'\r\nimport { registerMethods } from '../../utils/methods.js'\r\nimport Matrix from '../../types/Matrix.js'\r\n\r\n// Reset all transformations\r\nexport function untransform () {\r\n  return this.attr('transform', null)\r\n}\r\n\r\n// merge the whole transformation chain into one matrix and returns it\r\nexport function matrixify () {\r\n  const matrix = (this.attr('transform') || '')\r\n    // split transformations\r\n    .split(transforms).slice(0, -1).map(function (str) {\r\n      // generate key => value pairs\r\n      const kv = str.trim().split('(')\r\n      return [ kv[0],\r\n        kv[1].split(delimiter)\r\n          .map(function (str) {\r\n            return parseFloat(str)\r\n          })\r\n      ]\r\n    })\r\n    .reverse()\r\n    // merge every transformation into one matrix\r\n    .reduce(function (matrix, transform) {\r\n      if (transform[0] === 'matrix') {\r\n        return matrix.lmultiply(Matrix.fromArray(transform[1]))\r\n      }\r\n      return matrix[transform[0]].apply(matrix, transform[1])\r\n    }, new Matrix())\r\n\r\n  return matrix\r\n}\r\n\r\n// add an element to another parent without changing the visual representation on the screen\r\nexport function toParent (parent, i) {\r\n  if (this === parent) return this\r\n  const ctm = this.screenCTM()\r\n  const pCtm = parent.screenCTM().inverse()\r\n\r\n  this.addTo(parent, i).untransform().transform(pCtm.multiply(ctm))\r\n\r\n  return this\r\n}\r\n\r\n// same as above with parent equals root-svg\r\nexport function toRoot (i) {\r\n  return this.toParent(this.root(), i)\r\n}\r\n\r\n// Add transformations\r\nexport function transform (o, relative) {\r\n  // Act as a getter if no object was passed\r\n  if (o == null || typeof o === 'string') {\r\n    const decomposed = new Matrix(this).decompose()\r\n    return o == null ? decomposed : decomposed[o]\r\n  }\r\n\r\n  if (!Matrix.isMatrixLike(o)) {\r\n    // Set the origin according to the defined transform\r\n    o = { ...o, origin: getOrigin(o, this) }\r\n  }\r\n\r\n  // The user can pass a boolean, an Element or an Matrix or nothing\r\n  const cleanRelative = relative === true ? this : (relative || false)\r\n  const result = new Matrix(cleanRelative).transform(o)\r\n  return this.attr('transform', result)\r\n}\r\n\r\nregisterMethods('Element', {\r\n  untransform, matrixify, toParent, toRoot, transform\r\n})\r\n","import { register } from '../utils/adopter.js'\r\nimport Element from './Element.js'\r\n\r\nexport default class Container extends Element {\r\n  flatten (parent = this, index) {\r\n    this.each(function () {\r\n      if (this instanceof Container) {\r\n        return this.flatten().ungroup()\r\n      }\r\n    })\r\n\r\n    return this\r\n  }\r\n\r\n  ungroup (parent = this.parent(), index = parent.index(this)) {\r\n    // when parent != this, we want append all elements to the end\r\n    index = index === -1 ? parent.children().length : index\r\n\r\n    this.each(function (i, children) {\r\n      // reverse each\r\n      return children[children.length - i - 1].toParent(parent, index)\r\n    })\r\n\r\n    return this.remove()\r\n  }\r\n}\r\n\r\nregister(Container, 'Container')\r\n","import { nodeOrNew, register } from '../utils/adopter.js'\r\nimport Container from './Container.js'\r\n\r\nexport default class Defs extends Container {\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('defs', node), attrs)\r\n  }\r\n\r\n  flatten () {\r\n    return this\r\n  }\r\n\r\n  ungroup () {\r\n    return this\r\n  }\r\n}\r\n\r\nregister(Defs, 'Defs')\r\n","import { register } from '../utils/adopter.js'\r\nimport Element from './Element.js'\r\n\r\nexport default class Shape extends Element {}\r\n\r\nregister(Shape, 'Shape')\r\n","import SVGNumber from '../../types/SVGNumber.js'\r\n\r\n// Radius x value\r\nexport function rx (rx) {\r\n  return this.attr('rx', rx)\r\n}\r\n\r\n// Radius y value\r\nexport function ry (ry) {\r\n  return this.attr('ry', ry)\r\n}\r\n\r\n// Move over x-axis\r\nexport function x (x) {\r\n  return x == null\r\n    ? this.cx() - this.rx()\r\n    : this.cx(x + this.rx())\r\n}\r\n\r\n// Move over y-axis\r\nexport function y (y) {\r\n  return y == null\r\n    ? this.cy() - this.ry()\r\n    : this.cy(y + this.ry())\r\n}\r\n\r\n// Move by center over x-axis\r\nexport function cx (x) {\r\n  return this.attr('cx', x)\r\n}\r\n\r\n// Move by center over y-axis\r\nexport function cy (y) {\r\n  return this.attr('cy', y)\r\n}\r\n\r\n// Set width of element\r\nexport function width (width) {\r\n  return width == null\r\n    ? this.rx() * 2\r\n    : this.rx(new SVGNumber(width).divide(2))\r\n}\r\n\r\n// Set height of element\r\nexport function height (height) {\r\n  return height == null\r\n    ? this.ry() * 2\r\n    : this.ry(new SVGNumber(height).divide(2))\r\n}\r\n","import {\r\n  extend,\r\n  nodeOrNew,\r\n  register,\r\n  wrapWithAttrCheck\r\n} from '../utils/adopter.js'\r\nimport { proportionalSize } from '../utils/utils.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport SVGNumber from '../types/SVGNumber.js'\r\nimport Shape from './Shape.js'\r\nimport * as circled from '../modules/core/circled.js'\r\n\r\nexport default class Ellipse extends Shape {\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('ellipse', node), attrs)\r\n  }\r\n\r\n  size (width, height) {\r\n    const p = proportionalSize(this, width, height)\r\n\r\n    return this\r\n      .rx(new SVGNumber(p.width).divide(2))\r\n      .ry(new SVGNumber(p.height).divide(2))\r\n  }\r\n}\r\n\r\nextend(Ellipse, circled)\r\n\r\nregisterMethods('Container', {\r\n  // Create an ellipse\r\n  ellipse: wrapWithAttrCheck(function (width = 0, height = width) {\r\n    return this.put(new Ellipse()).size(width, height).move(0, 0)\r\n  })\r\n})\r\n\r\nregister(Ellipse, 'Ellipse')\r\n","import Dom from './Dom.js'\nimport { globals } from '../utils/window.js'\nimport { register, create } from '../utils/adopter.js'\n\nclass Fragment extends Dom {\n  constructor (node = globals.document.createDocumentFragment()) {\n    super(node)\n  }\n\n  // Import / Export raw xml\n  xml (xmlOrFn, outerXML, ns) {\n    if (typeof xmlOrFn === 'boolean') {\n      ns = outerXML\n      outerXML = xmlOrFn\n      xmlOrFn = null\n    }\n\n    // because this is a fragment we have to put all elements into a wrapper first\n    // before we can get the innerXML from it\n    if (xmlOrFn == null || typeof xmlOrFn === 'function') {\n      const wrapper = new Dom(create('wrapper', ns))\n      wrapper.add(this.node.cloneNode(true))\n\n      return wrapper.xml(false, ns)\n    }\n\n    // Act as setter if we got a string\n    return super.xml(xmlOrFn, false, ns)\n  }\n\n}\n\nregister(Fragment, 'Fragment')\n\nexport default Fragment\n","import SVGNumber from '../../types/SVGNumber.js'\r\n\r\nexport function from (x, y) {\r\n  return (this._element || this).type === 'radialGradient'\r\n    ? this.attr({ fx: new SVGNumber(x), fy: new SVGNumber(y) })\r\n    : this.attr({ x1: new SVGNumber(x), y1: new SVGNumber(y) })\r\n}\r\n\r\nexport function to (x, y) {\r\n  return (this._element || this).type === 'radialGradient'\r\n    ? this.attr({ cx: new SVGNumber(x), cy: new SVGNumber(y) })\r\n    : this.attr({ x2: new SVGNumber(x), y2: new SVGNumber(y) })\r\n}\r\n","import {\r\n  extend,\r\n  nodeOrNew,\r\n  register,\r\n  wrapWithAttrCheck\r\n} from '../utils/adopter.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport Box from '../types/Box.js'\r\nimport Container from './Container.js'\r\nimport baseFind from '../modules/core/selector.js'\r\nimport * as gradiented from '../modules/core/gradiented.js'\r\n\r\nexport default class Gradient extends Container {\r\n  constructor (type, attrs) {\r\n    super(\r\n      nodeOrNew(type + 'Gradient', typeof type === 'string' ? null : type),\r\n      attrs\r\n    )\r\n  }\r\n\r\n  // custom attr to handle transform\r\n  attr (a, b, c) {\r\n    if (a === 'transform') a = 'gradientTransform'\r\n    return super.attr(a, b, c)\r\n  }\r\n\r\n  bbox () {\r\n    return new Box()\r\n  }\r\n\r\n  targets () {\r\n    return baseFind('svg [fill*=\"' + this.id() + '\"]')\r\n  }\r\n\r\n  // Alias string conversion to fill\r\n  toString () {\r\n    return this.url()\r\n  }\r\n\r\n  // Update gradient\r\n  update (block) {\r\n    // remove all stops\r\n    this.clear()\r\n\r\n    // invoke passed block\r\n    if (typeof block === 'function') {\r\n      block.call(this, this)\r\n    }\r\n\r\n    return this\r\n  }\r\n\r\n  // Return the fill id\r\n  url () {\r\n    return 'url(\"#' + this.id() + '\")'\r\n  }\r\n}\r\n\r\nextend(Gradient, gradiented)\r\n\r\nregisterMethods({\r\n  Container: {\r\n    // Create gradient element in defs\r\n    gradient (...args) {\r\n      return this.defs().gradient(...args)\r\n    }\r\n  },\r\n  // define gradient\r\n  Defs: {\r\n    gradient: wrapWithAttrCheck(function (type, block) {\r\n      return this.put(new Gradient(type)).update(block)\r\n    })\r\n  }\r\n})\r\n\r\nregister(Gradient, 'Gradient')\r\n","import { nodeOrNew, register, wrapWithAttrCheck } from '../utils/adopter.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport Box from '../types/Box.js'\r\nimport Container from './Container.js'\r\nimport baseFind from '../modules/core/selector.js'\r\n\r\nexport default class Pattern extends Container {\r\n  // Initialize node\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('pattern', node), attrs)\r\n  }\r\n\r\n  // custom attr to handle transform\r\n  attr (a, b, c) {\r\n    if (a === 'transform') a = 'patternTransform'\r\n    return super.attr(a, b, c)\r\n  }\r\n\r\n  bbox () {\r\n    return new Box()\r\n  }\r\n\r\n  targets () {\r\n    return baseFind('svg [fill*=\"' + this.id() + '\"]')\r\n  }\r\n\r\n  // Alias string conversion to fill\r\n  toString () {\r\n    return this.url()\r\n  }\r\n\r\n  // Update pattern by rebuilding\r\n  update (block) {\r\n    // remove content\r\n    this.clear()\r\n\r\n    // invoke passed block\r\n    if (typeof block === 'function') {\r\n      block.call(this, this)\r\n    }\r\n\r\n    return this\r\n  }\r\n\r\n  // Return the fill id\r\n  url () {\r\n    return 'url(\"#' + this.id() + '\")'\r\n  }\r\n\r\n}\r\n\r\nregisterMethods({\r\n  Container: {\r\n    // Create pattern element in defs\r\n    pattern (...args) {\r\n      return this.defs().pattern(...args)\r\n    }\r\n  },\r\n  Defs: {\r\n    pattern: wrapWithAttrCheck(function (width, height, block) {\r\n      return this.put(new Pattern()).update(block).attr({\r\n        x: 0,\r\n        y: 0,\r\n        width: width,\r\n        height: height,\r\n        patternUnits: 'userSpaceOnUse'\r\n      })\r\n    })\r\n  }\r\n})\r\n\r\nregister(Pattern, 'Pattern')\r\n","import { isImage } from '../modules/core/regex.js'\r\nimport { nodeOrNew, register, wrapWithAttrCheck } from '../utils/adopter.js'\r\nimport { off, on } from '../modules/core/event.js'\r\nimport { registerAttrHook } from '../modules/core/attr.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport { xlink } from '../modules/core/namespaces.js'\r\nimport Pattern from './Pattern.js'\r\nimport Shape from './Shape.js'\r\nimport { globals } from '../utils/window.js'\r\n\r\nexport default class Image extends Shape {\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('image', node), attrs)\r\n  }\r\n\r\n  // (re)load image\r\n  load (url, callback) {\r\n    if (!url) return this\r\n\r\n    const img = new globals.window.Image()\r\n\r\n    on(img, 'load', function (e) {\r\n      const p = this.parent(Pattern)\r\n\r\n      // ensure image size\r\n      if (this.width() === 0 && this.height() === 0) {\r\n        this.size(img.width, img.height)\r\n      }\r\n\r\n      if (p instanceof Pattern) {\r\n        // ensure pattern size if not set\r\n        if (p.width() === 0 && p.height() === 0) {\r\n          p.size(this.width(), this.height())\r\n        }\r\n      }\r\n\r\n      if (typeof callback === 'function') {\r\n        callback.call(this, e)\r\n      }\r\n    }, this)\r\n\r\n    on(img, 'load error', function () {\r\n      // dont forget to unbind memory leaking events\r\n      off(img)\r\n    })\r\n\r\n    return this.attr('href', (img.src = url), xlink)\r\n  }\r\n}\r\n\r\nregisterAttrHook(function (attr, val, _this) {\r\n  // convert image fill and stroke to patterns\r\n  if (attr === 'fill' || attr === 'stroke') {\r\n    if (isImage.test(val)) {\r\n      val = _this.root().defs().image(val)\r\n    }\r\n  }\r\n\r\n  if (val instanceof Image) {\r\n    val = _this.root().defs().pattern(0, 0, (pattern) => {\r\n      pattern.add(val)\r\n    })\r\n  }\r\n\r\n  return val\r\n})\r\n\r\nregisterMethods({\r\n  Container: {\r\n    // create image element, load image and set its size\r\n    image: wrapWithAttrCheck(function (source, callback) {\r\n      return this.put(new Image()).size(0, 0).load(source, callback)\r\n    })\r\n  }\r\n})\r\n\r\nregister(Image, 'Image')\r\n","import { delimiter } from '../modules/core/regex.js'\r\nimport SVGArray from './SVGArray.js'\r\nimport Box from './Box.js'\r\nimport Matrix from './Matrix.js'\r\n\r\nexport default class PointArray extends SVGArray {\r\n  // Get bounding box of points\r\n  bbox () {\r\n    let maxX = -Infinity\r\n    let maxY = -Infinity\r\n    let minX = Infinity\r\n    let minY = Infinity\r\n    this.forEach(function (el) {\r\n      maxX = Math.max(el[0], maxX)\r\n      maxY = Math.max(el[1], maxY)\r\n      minX = Math.min(el[0], minX)\r\n      minY = Math.min(el[1], minY)\r\n    })\r\n    return new Box(minX, minY, maxX - minX, maxY - minY)\r\n  }\r\n\r\n  // Move point string\r\n  move (x, y) {\r\n    const box = this.bbox()\r\n\r\n    // get relative offset\r\n    x -= box.x\r\n    y -= box.y\r\n\r\n    // move every point\r\n    if (!isNaN(x) && !isNaN(y)) {\r\n      for (let i = this.length - 1; i >= 0; i--) {\r\n        this[i] = [ this[i][0] + x, this[i][1] + y ]\r\n      }\r\n    }\r\n\r\n    return this\r\n  }\r\n\r\n  // Parse point string and flat array\r\n  parse (array = [ 0, 0 ]) {\r\n    const points = []\r\n\r\n    // if it is an array, we flatten it and therefore clone it to 1 depths\r\n    if (array instanceof Array) {\r\n      array = Array.prototype.concat.apply([], array)\r\n    } else { // Else, it is considered as a string\r\n      // parse points\r\n      array = array.trim().split(delimiter).map(parseFloat)\r\n    }\r\n\r\n    // validate points - https://svgwg.org/svg2-draft/shapes.html#DataTypePoints\r\n    // Odd number of coordinates is an error. In such cases, drop the last odd coordinate.\r\n    if (array.length % 2 !== 0) array.pop()\r\n\r\n    // wrap points in two-tuples\r\n    for (let i = 0, len = array.length; i < len; i = i + 2) {\r\n      points.push([ array[i], array[i + 1] ])\r\n    }\r\n\r\n    return points\r\n  }\r\n\r\n  // Resize poly string\r\n  size (width, height) {\r\n    let i\r\n    const box = this.bbox()\r\n\r\n    // recalculate position of all points according to new size\r\n    for (i = this.length - 1; i >= 0; i--) {\r\n      if (box.width) this[i][0] = ((this[i][0] - box.x) * width) / box.width + box.x\r\n      if (box.height) this[i][1] = ((this[i][1] - box.y) * height) / box.height + box.y\r\n    }\r\n\r\n    return this\r\n  }\r\n\r\n  // Convert array to line object\r\n  toLine () {\r\n    return {\r\n      x1: this[0][0],\r\n      y1: this[0][1],\r\n      x2: this[1][0],\r\n      y2: this[1][1]\r\n    }\r\n  }\r\n\r\n  // Convert array to string\r\n  toString () {\r\n    const array = []\r\n    // convert to a poly point string\r\n    for (let i = 0, il = this.length; i < il; i++) {\r\n      array.push(this[i].join(','))\r\n    }\r\n\r\n    return array.join(' ')\r\n  }\r\n\r\n  transform (m) {\r\n    return this.clone().transformO(m)\r\n  }\r\n\r\n  // transform points with matrix (similar to Point.transform)\r\n  transformO (m) {\r\n    if (!Matrix.isMatrixLike(m)) {\r\n      m = new Matrix(m)\r\n    }\r\n\r\n    for (let i = this.length; i--;) {\r\n      // Perform the matrix multiplication\r\n      const [ x, y ] = this[i]\r\n      this[i][0] = m.a * x + m.c * y + m.e\r\n      this[i][1] = m.b * x + m.d * y + m.f\r\n    }\r\n\r\n    return this\r\n  }\r\n\r\n}\r\n","import PointArray from '../../types/PointArray.js'\r\n\r\nexport const MorphArray = PointArray\r\n\r\n// Move by left top corner over x-axis\r\nexport function x (x) {\r\n  return x == null ? this.bbox().x : this.move(x, this.bbox().y)\r\n}\r\n\r\n// Move by left top corner over y-axis\r\nexport function y (y) {\r\n  return y == null ? this.bbox().y : this.move(this.bbox().x, y)\r\n}\r\n\r\n// Set width of element\r\nexport function width (width) {\r\n  const b = this.bbox()\r\n  return width == null ? b.width : this.size(width, b.height)\r\n}\r\n\r\n// Set height of element\r\nexport function height (height) {\r\n  const b = this.bbox()\r\n  return height == null ? b.height : this.size(b.width, height)\r\n}\r\n","import {\r\n  extend,\r\n  nodeOrNew,\r\n  register,\r\n  wrapWithAttrCheck\r\n} from '../utils/adopter.js'\r\nimport { proportionalSize } from '../utils/utils.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport PointArray from '../types/PointArray.js'\r\nimport Shape from './Shape.js'\r\nimport * as pointed from '../modules/core/pointed.js'\r\n\r\nexport default class Line extends Shape {\r\n  // Initialize node\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('line', node), attrs)\r\n  }\r\n\r\n  // Get array\r\n  array () {\r\n    return new PointArray([\r\n      [ this.attr('x1'), this.attr('y1') ],\r\n      [ this.attr('x2'), this.attr('y2') ]\r\n    ])\r\n  }\r\n\r\n  // Move by left top corner\r\n  move (x, y) {\r\n    return this.attr(this.array().move(x, y).toLine())\r\n  }\r\n\r\n  // Overwrite native plot() method\r\n  plot (x1, y1, x2, y2) {\r\n    if (x1 == null) {\r\n      return this.array()\r\n    } else if (typeof y1 !== 'undefined') {\r\n      x1 = { x1, y1, x2, y2 }\r\n    } else {\r\n      x1 = new PointArray(x1).toLine()\r\n    }\r\n\r\n    return this.attr(x1)\r\n  }\r\n\r\n  // Set element size to given width and height\r\n  size (width, height) {\r\n    const p = proportionalSize(this, width, height)\r\n    return this.attr(this.array().size(p.width, p.height).toLine())\r\n  }\r\n}\r\n\r\nextend(Line, pointed)\r\n\r\nregisterMethods({\r\n  Container: {\r\n    // Create a line element\r\n    line: wrapWithAttrCheck(function (...args) {\r\n      // make sure plot is called as a setter\r\n      // x1 is not necessarily a number, it can also be an array, a string and a PointArray\r\n      return Line.prototype.plot.apply(\r\n        this.put(new Line())\r\n        , args[0] != null ? args : [ 0, 0, 0, 0 ]\r\n      )\r\n    })\r\n  }\r\n})\r\n\r\nregister(Line, 'Line')\r\n","import { nodeOrNew, register, wrapWithAttrCheck } from '../utils/adopter.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport Container from './Container.js'\r\n\r\nexport default class Marker extends Container {\r\n  // Initialize node\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('marker', node), attrs)\r\n  }\r\n\r\n  // Set height of element\n  height (height) {\r\n    return this.attr('markerHeight', height)\r\n  }\n\n  orient (orient) {\r\n    return this.attr('orient', orient)\r\n  }\n\n  // Set marker refX and refY\n  ref (x, y) {\r\n    return this.attr('refX', x).attr('refY', y)\r\n  }\n\n  // Return the fill id\n  toString () {\r\n    return 'url(#' + this.id() + ')'\r\n  }\n\n  // Update marker\n  update (block) {\r\n    // remove all content\r\n    this.clear()\r\n\r\n    // invoke passed block\r\n    if (typeof block === 'function') {\r\n      block.call(this, this)\r\n    }\r\n\r\n    return this\r\n  }\n\n  // Set width of element\r\n  width (width) {\r\n    return this.attr('markerWidth', width)\r\n  }\r\n\r\n}\r\n\r\nregisterMethods({\r\n  Container: {\r\n    marker (...args) {\r\n      // Create marker element in defs\r\n      return this.defs().marker(...args)\r\n    }\r\n  },\r\n  Defs: {\r\n    // Create marker\r\n    marker: wrapWithAttrCheck(function (width, height, block) {\r\n      // Set default viewbox to match the width and height, set ref to cx and cy and set orient to auto\r\n      return this.put(new Marker())\r\n        .size(width, height)\r\n        .ref(width / 2, height / 2)\r\n        .viewbox(0, 0, width, height)\r\n        .attr('orient', 'auto')\r\n        .update(block)\r\n    })\r\n  },\r\n  marker: {\r\n    // Create and attach markers\r\n    marker (marker, width, height, block) {\r\n      let attr = [ 'marker' ]\r\n\r\n      // Build attribute name\r\n      if (marker !== 'all') attr.push(marker)\r\n      attr = attr.join('-')\r\n\r\n      // Set marker attribute\r\n      marker = arguments[1] instanceof Marker\r\n        ? arguments[1]\r\n        : this.defs().marker(width, height, block)\r\n\r\n      return this.attr(attr, marker)\r\n    }\r\n  }\r\n})\r\n\r\nregister(Marker, 'Marker')\r\n","import { timeline } from '../modules/core/defaults.js'\r\nimport { extend } from '../utils/adopter.js'\r\n\r\n/***\r\nBase Class\r\n==========\r\nThe base stepper class that will be\r\n***/\r\n\r\nfunction makeSetterGetter (k, f) {\r\n  return function (v) {\r\n    if (v == null) return this[k]\r\n    this[k] = v\r\n    if (f) f.call(this)\r\n    return this\r\n  }\r\n}\r\n\r\nexport const easing = {\r\n  '-': function (pos) {\r\n    return pos\r\n  },\r\n  '<>': function (pos) {\r\n    return -Math.cos(pos * Math.PI) / 2 + 0.5\r\n  },\r\n  '>': function (pos) {\r\n    return Math.sin(pos * Math.PI / 2)\r\n  },\r\n  '<': function (pos) {\r\n    return -Math.cos(pos * Math.PI / 2) + 1\r\n  },\r\n  bezier: function (x1, y1, x2, y2) {\r\n    // see https://www.w3.org/TR/css-easing-1/#cubic-bezier-algo\r\n    return function (t) {\r\n      if (t < 0) {\r\n        if (x1 > 0) {\r\n          return y1 / x1 * t\r\n        } else if (x2 > 0) {\r\n          return y2 / x2 * t\r\n        } else {\r\n          return 0\r\n        }\r\n      } else if (t > 1) {\r\n        if (x2 < 1) {\r\n          return (1 - y2) / (1 - x2) * t + (y2 - x2) / (1 - x2)\r\n        } else if (x1 < 1) {\r\n          return (1 - y1) / (1 - x1) * t + (y1 - x1) / (1 - x1)\r\n        } else {\r\n          return 1\r\n        }\r\n      } else {\r\n        return 3 * t * (1 - t) ** 2 * y1 + 3 * t ** 2 * (1 - t) * y2 + t ** 3\r\n      }\r\n    }\r\n  },\r\n  // see https://www.w3.org/TR/css-easing-1/#step-timing-function-algo\r\n  steps: function (steps, stepPosition = 'end') {\r\n    // deal with \"jump-\" prefix\r\n    stepPosition = stepPosition.split('-').reverse()[0]\r\n\r\n    let jumps = steps\r\n    if (stepPosition === 'none') {\r\n      --jumps\r\n    } else if (stepPosition === 'both') {\r\n      ++jumps\r\n    }\r\n\r\n    // The beforeFlag is essentially useless\r\n    return (t, beforeFlag = false) => {\r\n      // Step is called currentStep in referenced url\r\n      let step = Math.floor(t * steps)\r\n      const jumping = (t * step) % 1 === 0\r\n\r\n      if (stepPosition === 'start' || stepPosition === 'both') {\r\n        ++step\r\n      }\r\n\r\n      if (beforeFlag && jumping) {\r\n        --step\r\n      }\r\n\r\n      if (t >= 0 && step < 0) {\r\n        step = 0\r\n      }\r\n\r\n      if (t <= 1 && step > jumps) {\r\n        step = jumps\r\n      }\r\n\r\n      return step / jumps\r\n    }\r\n  }\r\n}\r\n\r\nexport class Stepper {\r\n  done () {\r\n    return false\r\n  }\r\n}\r\n\r\n/***\r\nEasing Functions\r\n================\r\n***/\r\n\r\nexport class Ease extends Stepper {\r\n  constructor (fn = timeline.ease) {\r\n    super()\r\n    this.ease = easing[fn] || fn\r\n  }\r\n\r\n  step (from, to, pos) {\r\n    if (typeof from !== 'number') {\r\n      return pos < 1 ? from : to\r\n    }\r\n    return from + (to - from) * this.ease(pos)\r\n  }\r\n}\r\n\r\n/***\r\nController Types\r\n================\r\n***/\r\n\r\nexport class Controller extends Stepper {\r\n  constructor (fn) {\r\n    super()\r\n    this.stepper = fn\r\n  }\r\n\r\n  done (c) {\r\n    return c.done\r\n  }\n\n  step (current, target, dt, c) {\r\n    return this.stepper(current, target, dt, c)\r\n  }\r\n\r\n}\r\n\r\nfunction recalculate () {\r\n  // Apply the default parameters\r\n  const duration = (this._duration || 500) / 1000\r\n  const overshoot = this._overshoot || 0\r\n\r\n  // Calculate the PID natural response\r\n  const eps = 1e-10\r\n  const pi = Math.PI\r\n  const os = Math.log(overshoot / 100 + eps)\r\n  const zeta = -os / Math.sqrt(pi * pi + os * os)\r\n  const wn = 3.9 / (zeta * duration)\r\n\r\n  // Calculate the Spring values\r\n  this.d = 2 * zeta * wn\r\n  this.k = wn * wn\r\n}\r\n\r\nexport class Spring extends Controller {\r\n  constructor (duration = 500, overshoot = 0) {\r\n    super()\r\n    this.duration(duration)\r\n      .overshoot(overshoot)\r\n  }\r\n\r\n  step (current, target, dt, c) {\r\n    if (typeof current === 'string') return current\r\n    c.done = dt === Infinity\r\n    if (dt === Infinity) return target\r\n    if (dt === 0) return current\r\n\r\n    if (dt > 100) dt = 16\r\n\r\n    dt /= 1000\r\n\r\n    // Get the previous velocity\r\n    const velocity = c.velocity || 0\r\n\r\n    // Apply the control to get the new position and store it\r\n    const acceleration = -this.d * velocity - this.k * (current - target)\r\n    const newPosition = current\r\n      + velocity * dt\r\n      + acceleration * dt * dt / 2\r\n\r\n    // Store the velocity\r\n    c.velocity = velocity + acceleration * dt\r\n\r\n    // Figure out if we have converged, and if so, pass the value\r\n    c.done = Math.abs(target - newPosition) + Math.abs(velocity) < 0.002\r\n    return c.done ? target : newPosition\r\n  }\r\n}\r\n\r\nextend(Spring, {\r\n  duration: makeSetterGetter('_duration', recalculate),\r\n  overshoot: makeSetterGetter('_overshoot', recalculate)\r\n})\r\n\r\nexport class PID extends Controller {\r\n  constructor (p = 0.1, i = 0.01, d = 0, windup = 1000) {\r\n    super()\r\n    this.p(p).i(i).d(d).windup(windup)\r\n  }\r\n\r\n  step (current, target, dt, c) {\r\n    if (typeof current === 'string') return current\r\n    c.done = dt === Infinity\r\n\r\n    if (dt === Infinity) return target\r\n    if (dt === 0) return current\r\n\r\n    const p = target - current\r\n    let i = (c.integral || 0) + p * dt\r\n    const d = (p - (c.error || 0)) / dt\r\n    const windup = this._windup\r\n\r\n    // antiwindup\r\n    if (windup !== false) {\r\n      i = Math.max(-windup, Math.min(i, windup))\r\n    }\r\n\r\n    c.error = p\r\n    c.integral = i\r\n\r\n    c.done = Math.abs(p) < 0.001\r\n\r\n    return c.done ? target : current + (this.P * p + this.I * i + this.D * d)\r\n  }\r\n}\r\n\r\nextend(PID, {\r\n  windup: makeSetterGetter('_windup'),\r\n  p: makeSetterGetter('P'),\r\n  i: makeSetterGetter('I'),\r\n  d: makeSetterGetter('D')\r\n})\r\n","import { isPathLetter } from '../modules/core/regex.js'\r\nimport Point from '../types/Point.js'\r\n\r\nconst segmentParameters = { M: 2, L: 2, H: 1, V: 1, C: 6, S: 4, Q: 4, T: 2, A: 7, Z: 0 }\r\n\r\nconst pathHandlers = {\r\n  M: function (c, p, p0) {\r\n    p.x = p0.x = c[0]\r\n    p.y = p0.y = c[1]\r\n\r\n    return [ 'M', p.x, p.y ]\r\n  },\r\n  L: function (c, p) {\r\n    p.x = c[0]\r\n    p.y = c[1]\r\n    return [ 'L', c[0], c[1] ]\r\n  },\r\n  H: function (c, p) {\r\n    p.x = c[0]\r\n    return [ 'H', c[0] ]\r\n  },\r\n  V: function (c, p) {\r\n    p.y = c[0]\r\n    return [ 'V', c[0] ]\r\n  },\r\n  C: function (c, p) {\r\n    p.x = c[4]\r\n    p.y = c[5]\r\n    return [ 'C', c[0], c[1], c[2], c[3], c[4], c[5] ]\r\n  },\r\n  S: function (c, p) {\r\n    p.x = c[2]\r\n    p.y = c[3]\r\n    return [ 'S', c[0], c[1], c[2], c[3] ]\r\n  },\r\n  Q: function (c, p) {\r\n    p.x = c[2]\r\n    p.y = c[3]\r\n    return [ 'Q', c[0], c[1], c[2], c[3] ]\r\n  },\r\n  T: function (c, p) {\r\n    p.x = c[0]\r\n    p.y = c[1]\r\n    return [ 'T', c[0], c[1] ]\r\n  },\r\n  Z: function (c, p, p0) {\r\n    p.x = p0.x\r\n    p.y = p0.y\r\n    return [ 'Z' ]\r\n  },\r\n  A: function (c, p) {\r\n    p.x = c[5]\r\n    p.y = c[6]\r\n    return [ 'A', c[0], c[1], c[2], c[3], c[4], c[5], c[6] ]\r\n  }\r\n}\r\n\r\nconst mlhvqtcsaz = 'mlhvqtcsaz'.split('')\r\n\r\nfor (let i = 0, il = mlhvqtcsaz.length; i < il; ++i) {\r\n  pathHandlers[mlhvqtcsaz[i]] = (function (i) {\r\n    return function (c, p, p0) {\r\n      if (i === 'H') c[0] = c[0] + p.x\r\n      else if (i === 'V') c[0] = c[0] + p.y\r\n      else if (i === 'A') {\r\n        c[5] = c[5] + p.x\r\n        c[6] = c[6] + p.y\r\n      } else {\r\n        for (let j = 0, jl = c.length; j < jl; ++j) {\r\n          c[j] = c[j] + (j % 2 ? p.y : p.x)\r\n        }\r\n      }\r\n\r\n      return pathHandlers[i](c, p, p0)\r\n    }\r\n  })(mlhvqtcsaz[i].toUpperCase())\r\n}\r\n\r\nfunction makeAbsolut (parser) {\r\n  const command = parser.segment[0]\r\n  return pathHandlers[command](parser.segment.slice(1), parser.p, parser.p0)\r\n}\r\n\r\nfunction segmentComplete (parser) {\r\n  return parser.segment.length && parser.segment.length - 1 === segmentParameters[parser.segment[0].toUpperCase()]\r\n}\r\n\r\nfunction startNewSegment (parser, token) {\r\n  parser.inNumber && finalizeNumber(parser, false)\r\n  const pathLetter = isPathLetter.test(token)\r\n\r\n  if (pathLetter) {\r\n    parser.segment = [ token ]\r\n  } else {\r\n    const lastCommand = parser.lastCommand\r\n    const small = lastCommand.toLowerCase()\r\n    const isSmall = lastCommand === small\r\n    parser.segment = [ small === 'm' ? (isSmall ? 'l' : 'L') : lastCommand ]\r\n  }\r\n\r\n  parser.inSegment = true\r\n  parser.lastCommand = parser.segment[0]\r\n\r\n  return pathLetter\r\n}\r\n\r\nfunction finalizeNumber (parser, inNumber) {\r\n  if (!parser.inNumber) throw new Error('Parser Error')\r\n  parser.number && parser.segment.push(parseFloat(parser.number))\r\n  parser.inNumber = inNumber\r\n  parser.number = ''\r\n  parser.pointSeen = false\r\n  parser.hasExponent = false\r\n\r\n  if (segmentComplete(parser)) {\r\n    finalizeSegment(parser)\r\n  }\r\n}\r\n\r\nfunction finalizeSegment (parser) {\r\n  parser.inSegment = false\r\n  if (parser.absolute) {\r\n    parser.segment = makeAbsolut(parser)\r\n  }\r\n  parser.segments.push(parser.segment)\r\n}\r\n\r\nfunction isArcFlag (parser) {\r\n  if (!parser.segment.length) return false\r\n  const isArc = parser.segment[0].toUpperCase() === 'A'\r\n  const length = parser.segment.length\r\n\r\n  return isArc && (length === 4 || length === 5)\r\n}\r\n\r\nfunction isExponential (parser) {\r\n  return parser.lastToken.toUpperCase() === 'E'\r\n}\r\n\r\nexport function pathParser (d, toAbsolute = true) {\r\n\r\n  let index = 0\r\n  let token = ''\r\n  const parser = {\r\n    segment: [],\r\n    inNumber: false,\r\n    number: '',\r\n    lastToken: '',\r\n    inSegment: false,\r\n    segments: [],\r\n    pointSeen: false,\r\n    hasExponent: false,\r\n    absolute: toAbsolute,\r\n    p0: new Point(),\r\n    p: new Point()\r\n  }\r\n\r\n  while ((parser.lastToken = token, token = d.charAt(index++))) {\r\n    if (!parser.inSegment) {\r\n      if (startNewSegment(parser, token)) {\r\n        continue\r\n      }\r\n    }\r\n\r\n    if (token === '.') {\r\n      if (parser.pointSeen || parser.hasExponent) {\r\n        finalizeNumber(parser, false)\r\n        --index\r\n        continue\r\n      }\r\n      parser.inNumber = true\r\n      parser.pointSeen = true\r\n      parser.number += token\r\n      continue\r\n    }\r\n\r\n    if (!isNaN(parseInt(token))) {\r\n\r\n      if (parser.number === '0' || isArcFlag(parser)) {\r\n        parser.inNumber = true\r\n        parser.number = token\r\n        finalizeNumber(parser, true)\r\n        continue\r\n      }\r\n\r\n      parser.inNumber = true\r\n      parser.number += token\r\n      continue\r\n    }\r\n\r\n    if (token === ' ' || token === ',') {\r\n      if (parser.inNumber) {\r\n        finalizeNumber(parser, false)\r\n      }\r\n      continue\r\n    }\r\n\r\n    if (token === '-') {\r\n      if (parser.inNumber && !isExponential(parser)) {\r\n        finalizeNumber(parser, false)\r\n        --index\r\n        continue\r\n      }\r\n      parser.number += token\r\n      parser.inNumber = true\r\n      continue\r\n    }\r\n\r\n    if (token.toUpperCase() === 'E') {\r\n      parser.number += token\r\n      parser.hasExponent = true\r\n      continue\r\n    }\r\n\r\n    if (isPathLetter.test(token)) {\r\n      if (parser.inNumber) {\r\n        finalizeNumber(parser, false)\r\n      } else if (!segmentComplete(parser)) {\r\n        throw new Error('parser Error')\r\n      } else {\r\n        finalizeSegment(parser)\r\n      }\r\n      --index\r\n    }\r\n  }\r\n\r\n  if (parser.inNumber) {\r\n    finalizeNumber(parser, false)\r\n  }\r\n\r\n  if (parser.inSegment && segmentComplete(parser)) {\r\n    finalizeSegment(parser)\r\n  }\r\n\r\n  return parser.segments\r\n\r\n}\r\n","import SVGArray from './SVGArray.js'\r\nimport parser from '../modules/core/parser.js'\r\nimport Box from './Box.js'\r\nimport { pathParser } from '../utils/pathParser.js'\r\n\r\nfunction arrayToString (a) {\r\n  let s = ''\r\n  for (let i = 0, il = a.length; i < il; i++) {\r\n    s += a[i][0]\r\n\r\n    if (a[i][1] != null) {\r\n      s += a[i][1]\r\n\r\n      if (a[i][2] != null) {\r\n        s += ' '\r\n        s += a[i][2]\r\n\r\n        if (a[i][3] != null) {\r\n          s += ' '\r\n          s += a[i][3]\r\n          s += ' '\r\n          s += a[i][4]\r\n\r\n          if (a[i][5] != null) {\r\n            s += ' '\r\n            s += a[i][5]\r\n            s += ' '\r\n            s += a[i][6]\r\n\r\n            if (a[i][7] != null) {\r\n              s += ' '\r\n              s += a[i][7]\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  return s + ' '\r\n}\r\n\r\nexport default class PathArray extends SVGArray {\r\n  // Get bounding box of path\r\n  bbox () {\r\n    parser().path.setAttribute('d', this.toString())\r\n    return new Box(parser.nodes.path.getBBox())\r\n  }\r\n\r\n  // Move path string\r\n  move (x, y) {\r\n    // get bounding box of current situation\r\n    const box = this.bbox()\r\n\r\n    // get relative offset\r\n    x -= box.x\r\n    y -= box.y\r\n\r\n    if (!isNaN(x) && !isNaN(y)) {\r\n      // move every point\r\n      for (let l, i = this.length - 1; i >= 0; i--) {\r\n        l = this[i][0]\r\n\r\n        if (l === 'M' || l === 'L' || l === 'T') {\r\n          this[i][1] += x\r\n          this[i][2] += y\r\n        } else if (l === 'H') {\r\n          this[i][1] += x\r\n        } else if (l === 'V') {\r\n          this[i][1] += y\r\n        } else if (l === 'C' || l === 'S' || l === 'Q') {\r\n          this[i][1] += x\r\n          this[i][2] += y\r\n          this[i][3] += x\r\n          this[i][4] += y\r\n\r\n          if (l === 'C') {\r\n            this[i][5] += x\r\n            this[i][6] += y\r\n          }\r\n        } else if (l === 'A') {\r\n          this[i][6] += x\r\n          this[i][7] += y\r\n        }\r\n      }\r\n    }\r\n\r\n    return this\r\n  }\r\n\r\n  // Absolutize and parse path to array\r\n  parse (d = 'M0 0') {\r\n    if (Array.isArray(d)) {\r\n      d = Array.prototype.concat.apply([], d).toString()\r\n    }\r\n\r\n    return pathParser(d)\r\n  }\r\n\r\n  // Resize path string\r\n  size (width, height) {\r\n    // get bounding box of current situation\r\n    const box = this.bbox()\r\n    let i, l\r\n\r\n    // If the box width or height is 0 then we ignore\r\n    // transformations on the respective axis\r\n    box.width = box.width === 0 ? 1 : box.width\r\n    box.height = box.height === 0 ? 1 : box.height\r\n\r\n    // recalculate position of all points according to new size\r\n    for (i = this.length - 1; i >= 0; i--) {\r\n      l = this[i][0]\r\n\r\n      if (l === 'M' || l === 'L' || l === 'T') {\r\n        this[i][1] = ((this[i][1] - box.x) * width) / box.width + box.x\r\n        this[i][2] = ((this[i][2] - box.y) * height) / box.height + box.y\r\n      } else if (l === 'H') {\r\n        this[i][1] = ((this[i][1] - box.x) * width) / box.width + box.x\r\n      } else if (l === 'V') {\r\n        this[i][1] = ((this[i][1] - box.y) * height) / box.height + box.y\r\n      } else if (l === 'C' || l === 'S' || l === 'Q') {\r\n        this[i][1] = ((this[i][1] - box.x) * width) / box.width + box.x\r\n        this[i][2] = ((this[i][2] - box.y) * height) / box.height + box.y\r\n        this[i][3] = ((this[i][3] - box.x) * width) / box.width + box.x\r\n        this[i][4] = ((this[i][4] - box.y) * height) / box.height + box.y\r\n\r\n        if (l === 'C') {\r\n          this[i][5] = ((this[i][5] - box.x) * width) / box.width + box.x\r\n          this[i][6] = ((this[i][6] - box.y) * height) / box.height + box.y\r\n        }\r\n      } else if (l === 'A') {\r\n        // resize radii\r\n        this[i][1] = (this[i][1] * width) / box.width\r\n        this[i][2] = (this[i][2] * height) / box.height\r\n\r\n        // move position values\r\n        this[i][6] = ((this[i][6] - box.x) * width) / box.width + box.x\r\n        this[i][7] = ((this[i][7] - box.y) * height) / box.height + box.y\r\n      }\r\n    }\r\n\r\n    return this\r\n  }\r\n\r\n  // Convert array to string\r\n  toString () {\r\n    return arrayToString(this)\r\n  }\r\n\r\n}\r\n","import { Ease } from './Controller.js'\nimport {\n  delimiter,\n  numberAndUnit,\n  isPathLetter\n} from '../modules/core/regex.js'\nimport { extend } from '../utils/adopter.js'\nimport Color from '../types/Color.js'\nimport PathArray from '../types/PathArray.js'\nimport SVGArray from '../types/SVGArray.js'\nimport SVGNumber from '../types/SVGNumber.js'\n\nconst getClassForType = (value) => {\n  const type = typeof value\n\n  if (type === 'number') {\n    return SVGNumber\n  } else if (type === 'string') {\n    if (Color.isColor(value)) {\n      return Color\n    } else if (delimiter.test(value)) {\n      return isPathLetter.test(value)\n        ? PathArray\n        : SVGArray\n    } else if (numberAndUnit.test(value)) {\n      return SVGNumber\n    } else {\n      return NonMorphable\n    }\n  } else if (morphableTypes.indexOf(value.constructor) > -1) {\n    return value.constructor\n  } else if (Array.isArray(value)) {\n    return SVGArray\n  } else if (type === 'object') {\n    return ObjectBag\n  } else {\n    return NonMorphable\n  }\n}\n\nexport default class Morphable {\n  constructor (stepper) {\n    this._stepper = stepper || new Ease('-')\n\n    this._from = null\n    this._to = null\n    this._type = null\n    this._context = null\n    this._morphObj = null\n  }\n\n  at (pos) {\n    return this._morphObj.morph(this._from, this._to, pos, this._stepper, this._context)\n\n  }\n\n  done () {\n    const complete = this._context\n      .map(this._stepper.done)\n      .reduce(function (last, curr) {\n        return last && curr\n      }, true)\n    return complete\n  }\n\n  from (val) {\n    if (val == null) {\n      return this._from\n    }\n\n    this._from = this._set(val)\n    return this\n  }\n\n  stepper (stepper) {\n    if (stepper == null) return this._stepper\n    this._stepper = stepper\n    return this\n  }\n\n  to (val) {\n    if (val == null) {\n      return this._to\n    }\n\n    this._to = this._set(val)\n    return this\n  }\n\n  type (type) {\n    // getter\n    if (type == null) {\n      return this._type\n    }\n\n    // setter\n    this._type = type\n    return this\n  }\n\n  _set (value) {\n    if (!this._type) {\n      this.type(getClassForType(value))\n    }\n\n    let result = (new this._type(value))\n    if (this._type === Color) {\n      result = this._to\n        ? result[this._to[4]]()\n        : this._from\n          ? result[this._from[4]]()\n          : result\n    }\n\n    if (this._type === ObjectBag) {\n      result = this._to\n        ? result.align(this._to)\n        : this._from\n          ? result.align(this._from)\n          : result\n    }\n\n    result = result.toConsumable()\n\n    this._morphObj = this._morphObj || new this._type()\n    this._context = this._context\n      || Array.apply(null, Array(result.length))\n        .map(Object)\n        .map(function (o) {\n          o.done = true\n          return o\n        })\n    return result\n  }\n\n}\n\nexport class NonMorphable {\n  constructor (...args) {\n    this.init(...args)\n  }\n\n  init (val) {\n    val = Array.isArray(val) ? val[0] : val\n    this.value = val\n    return this\n  }\n\n  toArray () {\n    return [ this.value ]\n  }\n\n  valueOf () {\n    return this.value\n  }\n\n}\n\nexport class TransformBag {\n  constructor (...args) {\n    this.init(...args)\n  }\n\n  init (obj) {\n    if (Array.isArray(obj)) {\n      obj = {\n        scaleX: obj[0],\n        scaleY: obj[1],\n        shear: obj[2],\n        rotate: obj[3],\n        translateX: obj[4],\n        translateY: obj[5],\n        originX: obj[6],\n        originY: obj[7]\n      }\n    }\n\n    Object.assign(this, TransformBag.defaults, obj)\n    return this\n  }\n\n  toArray () {\n    const v = this\n\n    return [\n      v.scaleX,\n      v.scaleY,\n      v.shear,\n      v.rotate,\n      v.translateX,\n      v.translateY,\n      v.originX,\n      v.originY\n    ]\n  }\n}\n\nTransformBag.defaults = {\n  scaleX: 1,\n  scaleY: 1,\n  shear: 0,\n  rotate: 0,\n  translateX: 0,\n  translateY: 0,\n  originX: 0,\n  originY: 0\n}\n\nconst sortByKey = (a, b) => {\n  return (a[0] < b[0] ? -1 : (a[0] > b[0] ? 1 : 0))\n}\n\nexport class ObjectBag {\n  constructor (...args) {\n    this.init(...args)\n  }\n\n  align (other) {\n    const values = this.values\n    for (let i = 0, il = values.length; i < il; ++i) {\n\n      // If the type is the same we only need to check if the color is in the correct format\n      if (values[i + 1] === other[i + 1]) {\n        if (values[i + 1] === Color && other[i + 7] !== values[i + 7]) {\n          const space = other[i + 7]\n          const color = new Color(this.values.splice(i + 3, 5))[space]().toArray()\n          this.values.splice(i + 3, 0, ...color)\n        }\n\n        i += values[i + 2] + 2\n        continue\n      }\n\n      if (!other[i + 1]) {\n        return this\n      }\n\n      // The types differ, so we overwrite the new type with the old one\n      // And initialize it with the types default (e.g. black for color or 0 for number)\n      const defaultObject = new (other[i + 1])().toArray()\n\n      // Than we fix the values array\n      const toDelete = (values[i + 2]) + 3\n\n      values.splice(i, toDelete, other[i], other[i + 1], other[i + 2], ...defaultObject)\n\n      i += values[i + 2] + 2\n    }\n    return this\n  }\n\n  init (objOrArr) {\n    this.values = []\n\n    if (Array.isArray(objOrArr)) {\n      this.values = objOrArr.slice()\n      return\n    }\n\n    objOrArr = objOrArr || {}\n    const entries = []\n\n    for (const i in objOrArr) {\n      const Type = getClassForType(objOrArr[i])\n      const val = new Type(objOrArr[i]).toArray()\n      entries.push([ i, Type, val.length, ...val ])\n    }\n\n    entries.sort(sortByKey)\n\n    this.values = entries.reduce((last, curr) => last.concat(curr), [])\n    return this\n  }\n\n  toArray () {\n    return this.values\n  }\n\n  valueOf () {\n    const obj = {}\n    const arr = this.values\n\n    // for (var i = 0, len = arr.length; i < len; i += 2) {\n    while (arr.length) {\n      const key = arr.shift()\n      const Type = arr.shift()\n      const num = arr.shift()\n      const values = arr.splice(0, num)\n      obj[key] = new Type(values)// .valueOf()\n    }\n\n    return obj\n  }\n\n}\n\nconst morphableTypes = [\n  NonMorphable,\n  TransformBag,\n  ObjectBag\n]\n\nexport function registerMorphableType (type = []) {\n  morphableTypes.push(...[].concat(type))\n}\n\nexport function makeMorphable () {\n  extend(morphableTypes, {\n    to (val) {\n      return new Morphable()\n        .type(this.constructor)\n        .from(this.toArray())// this.valueOf())\n        .to(val)\n    },\n    fromArray (arr) {\n      this.init(arr)\n      return this\n    },\n    toConsumable () {\n      return this.toArray()\n    },\n    morph (from, to, pos, stepper, context) {\n      const mapper = function (i, index) {\n        return stepper.step(i, to[index], pos, context[index], context)\n      }\n\n      return this.fromArray(from.map(mapper))\n    }\n  })\n}\n","import { nodeOrNew, register, wrapWithAttrCheck } from '../utils/adopter.js'\r\nimport { proportionalSize } from '../utils/utils.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport PathArray from '../types/PathArray.js'\r\nimport Shape from './Shape.js'\r\n\r\nexport default class Path extends Shape {\r\n  // Initialize node\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('path', node), attrs)\r\n  }\r\n\r\n  // Get array\r\n  array () {\r\n    return this._array || (this._array = new PathArray(this.attr('d')))\r\n  }\r\n\r\n  // Clear array cache\r\n  clear () {\r\n    delete this._array\r\n    return this\r\n  }\r\n\r\n  // Set height of element\r\n  height (height) {\r\n    return height == null ? this.bbox().height : this.size(this.bbox().width, height)\r\n  }\r\n\r\n  // Move by left top corner\r\n  move (x, y) {\r\n    return this.attr('d', this.array().move(x, y))\r\n  }\r\n\r\n  // Plot new path\r\n  plot (d) {\r\n    return (d == null)\n      ? this.array()\r\n      : this.clear().attr('d', typeof d === 'string' ? d : (this._array = new PathArray(d)))\r\n  }\r\n\r\n  // Set element size to given width and height\r\n  size (width, height) {\r\n    const p = proportionalSize(this, width, height)\r\n    return this.attr('d', this.array().size(p.width, p.height))\r\n  }\r\n\r\n  // Set width of element\r\n  width (width) {\r\n    return width == null ? this.bbox().width : this.size(width, this.bbox().height)\r\n  }\r\n\r\n  // Move by left top corner over x-axis\r\n  x (x) {\r\n    return x == null ? this.bbox().x : this.move(x, this.bbox().y)\r\n  }\r\n\r\n  // Move by left top corner over y-axis\r\n  y (y) {\r\n    return y == null ? this.bbox().y : this.move(this.bbox().x, y)\r\n  }\r\n\r\n}\r\n\r\n// Define morphable array\r\nPath.prototype.MorphArray = PathArray\r\n\r\n// Add parent method\r\nregisterMethods({\r\n  Container: {\r\n    // Create a wrapped path element\r\n    path: wrapWithAttrCheck(function (d) {\r\n      // make sure plot is called as a setter\r\n      return this.put(new Path()).plot(d || new PathArray())\r\n    })\r\n  }\r\n})\r\n\r\nregister(Path, 'Path')\r\n","import { proportionalSize } from '../../utils/utils.js'\r\nimport PointArray from '../../types/PointArray.js'\r\n\r\n// Get array\r\nexport function array () {\r\n  return this._array || (this._array = new PointArray(this.attr('points')))\r\n}\r\n\r\n// Clear array cache\r\nexport function clear () {\r\n  delete this._array\r\n  return this\r\n}\r\n\r\n// Move by left top corner\r\nexport function move (x, y) {\r\n  return this.attr('points', this.array().move(x, y))\r\n}\r\n\r\n// Plot new path\r\nexport function plot (p) {\r\n  return (p == null)\n    ? this.array()\r\n    : this.clear().attr('points', typeof p === 'string'\n      ? p\r\n      : (this._array = new PointArray(p)))\r\n}\r\n\r\n// Set element size to given width and height\r\nexport function size (width, height) {\r\n  const p = proportionalSize(this, width, height)\r\n  return this.attr('points', this.array().size(p.width, p.height))\r\n}\r\n","import {\r\n  extend,\r\n  nodeOrNew,\r\n  register,\r\n  wrapWithAttrCheck\r\n} from '../utils/adopter.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport PointArray from '../types/PointArray.js'\r\nimport Shape from './Shape.js'\r\nimport * as pointed from '../modules/core/pointed.js'\r\nimport * as poly from '../modules/core/poly.js'\r\n\r\nexport default class Polygon extends Shape {\r\n  // Initialize node\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('polygon', node), attrs)\r\n  }\r\n}\r\n\r\nregisterMethods({\r\n  Container: {\r\n    // Create a wrapped polygon element\r\n    polygon: wrapWithAttrCheck(function (p) {\r\n      // make sure plot is called as a setter\r\n      return this.put(new Polygon()).plot(p || new PointArray())\r\n    })\r\n  }\r\n})\r\n\r\nextend(Polygon, pointed)\r\nextend(Polygon, poly)\r\nregister(Polygon, 'Polygon')\r\n","import {\r\n  extend,\r\n  nodeOrNew,\r\n  register,\r\n  wrapWithAttrCheck\r\n} from '../utils/adopter.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport PointArray from '../types/PointArray.js'\r\nimport Shape from './Shape.js'\r\nimport * as pointed from '../modules/core/pointed.js'\r\nimport * as poly from '../modules/core/poly.js'\r\n\r\nexport default class Polyline extends Shape {\r\n  // Initialize node\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('polyline', node), attrs)\r\n  }\r\n}\r\n\r\nregisterMethods({\r\n  Container: {\r\n    // Create a wrapped polygon element\r\n    polyline: wrapWithAttrCheck(function (p) {\r\n      // make sure plot is called as a setter\r\n      return this.put(new Polyline()).plot(p || new PointArray())\r\n    })\r\n  }\r\n})\r\n\r\nextend(Polyline, pointed)\r\nextend(Polyline, poly)\r\nregister(Polyline, 'Polyline')\r\n","import {\r\n  extend,\r\n  nodeOrNew,\r\n  register,\r\n  wrapWithAttrCheck\r\n} from '../utils/adopter.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport { rx, ry } from '../modules/core/circled.js'\r\nimport Shape from './Shape.js'\r\n\r\nexport default class Rect extends Shape {\r\n  // Initialize node\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('rect', node), attrs)\r\n  }\r\n}\r\n\r\nextend(Rect, { rx, ry })\r\n\r\nregisterMethods({\r\n  Container: {\r\n    // Create a rect element\r\n    rect: wrapWithAttrCheck(function (width, height) {\r\n      return this.put(new Rect()).size(width, height)\r\n    })\r\n  }\r\n})\r\n\r\nregister(Rect, 'Rect')\r\n","export default class Queue {\r\n  constructor () {\r\n    this._first = null\r\n    this._last = null\r\n  }\r\n\r\n  // Shows us the first item in the list\n  first () {\r\n    return this._first && this._first.value\r\n  }\n\n  // Shows us the last item in the list\n  last () {\r\n    return this._last && this._last.value\r\n  }\n\n  push (value) {\r\n    // An item stores an id and the provided value\r\n    const item = typeof value.next !== 'undefined' ? value : { value: value, next: null, prev: null }\r\n\r\n    // Deal with the queue being empty or populated\r\n    if (this._last) {\r\n      item.prev = this._last\r\n      this._last.next = item\r\n      this._last = item\r\n    } else {\r\n      this._last = item\r\n      this._first = item\r\n    }\r\n\r\n    // Return the current item\r\n    return item\r\n  }\r\n\n  // Removes the item that was returned from the push\n  remove (item) {\r\n    // Relink the previous item\r\n    if (item.prev) item.prev.next = item.next\r\n    if (item.next) item.next.prev = item.prev\r\n    if (item === this._last) this._last = item.prev\r\n    if (item === this._first) this._first = item.next\r\n\r\n    // Invalidate item\r\n    item.prev = null\r\n    item.next = null\r\n  }\n\n  shift () {\r\n    // Check if we have a value\r\n    const remove = this._first\r\n    if (!remove) return null\r\n\r\n    // If we do, remove it and relink things\r\n    this._first = remove.next\r\n    if (this._first) this._first.prev = null\r\n    this._last = this._first ? this._last : null\r\n    return remove.value\r\n  }\r\n\r\n}\r\n","import { globals } from '../utils/window.js'\r\nimport Queue from './Queue.js'\r\n\r\nconst Animator = {\r\n  nextDraw: null,\r\n  frames: new Queue(),\r\n  timeouts: new Queue(),\r\n  immediates: new Queue(),\r\n  timer: () => globals.window.performance || globals.window.Date,\r\n  transforms: [],\r\n\r\n  frame (fn) {\r\n    // Store the node\r\n    const node = Animator.frames.push({ run: fn })\r\n\r\n    // Request an animation frame if we don't have one\r\n    if (Animator.nextDraw === null) {\r\n      Animator.nextDraw = globals.window.requestAnimationFrame(Animator._draw)\r\n    }\r\n\r\n    // Return the node so we can remove it easily\r\n    return node\r\n  },\r\n\r\n  timeout (fn, delay) {\r\n    delay = delay || 0\r\n\r\n    // Work out when the event should fire\r\n    const time = Animator.timer().now() + delay\r\n\r\n    // Add the timeout to the end of the queue\r\n    const node = Animator.timeouts.push({ run: fn, time: time })\r\n\r\n    // Request another animation frame if we need one\r\n    if (Animator.nextDraw === null) {\r\n      Animator.nextDraw = globals.window.requestAnimationFrame(Animator._draw)\r\n    }\r\n\r\n    return node\r\n  },\r\n\r\n  immediate (fn) {\r\n    // Add the immediate fn to the end of the queue\r\n    const node = Animator.immediates.push(fn)\r\n    // Request another animation frame if we need one\r\n    if (Animator.nextDraw === null) {\r\n      Animator.nextDraw = globals.window.requestAnimationFrame(Animator._draw)\r\n    }\r\n\r\n    return node\r\n  },\r\n\r\n  cancelFrame (node) {\r\n    node != null && Animator.frames.remove(node)\r\n  },\r\n\r\n  clearTimeout (node) {\r\n    node != null && Animator.timeouts.remove(node)\r\n  },\r\n\r\n  cancelImmediate (node) {\r\n    node != null && Animator.immediates.remove(node)\r\n  },\r\n\r\n  _draw (now) {\r\n    // Run all the timeouts we can run, if they are not ready yet, add them\r\n    // to the end of the queue immediately! (bad timeouts!!! [sarcasm])\r\n    let nextTimeout = null\r\n    const lastTimeout = Animator.timeouts.last()\r\n    while ((nextTimeout = Animator.timeouts.shift())) {\r\n      // Run the timeout if its time, or push it to the end\r\n      if (now >= nextTimeout.time) {\r\n        nextTimeout.run()\r\n      } else {\r\n        Animator.timeouts.push(nextTimeout)\r\n      }\r\n\r\n      // If we hit the last item, we should stop shifting out more items\r\n      if (nextTimeout === lastTimeout) break\r\n    }\r\n\r\n    // Run all of the animation frames\r\n    let nextFrame = null\r\n    const lastFrame = Animator.frames.last()\r\n    while ((nextFrame !== lastFrame) && (nextFrame = Animator.frames.shift())) {\r\n      nextFrame.run(now)\r\n    }\r\n\r\n    let nextImmediate = null\r\n    while ((nextImmediate = Animator.immediates.shift())) {\r\n      nextImmediate()\r\n    }\r\n\r\n    // If we have remaining timeouts or frames, draw until we don't anymore\r\n    Animator.nextDraw = Animator.timeouts.first() || Animator.frames.first()\r\n      ? globals.window.requestAnimationFrame(Animator._draw)\r\n      : null\r\n  }\r\n}\r\n\r\nexport default Animator\r\n","import { globals } from '../utils/window.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport Animator from './Animator.js'\r\nimport EventTarget from '../types/EventTarget.js'\r\n\r\nconst makeSchedule = function (runnerInfo) {\r\n  const start = runnerInfo.start\r\n  const duration = runnerInfo.runner.duration()\r\n  const end = start + duration\r\n  return { start: start, duration: duration, end: end, runner: runnerInfo.runner }\r\n}\r\n\r\nconst defaultSource = function () {\r\n  const w = globals.window\r\n  return (w.performance || w.Date).now()\r\n}\r\n\r\nexport default class Timeline extends EventTarget {\r\n  // Construct a new timeline on the given element\r\n  constructor (timeSource = defaultSource) {\r\n    super()\r\n\r\n    this._timeSource = timeSource\r\n\r\n    // Store the timing variables\r\n    this._startTime = 0\r\n    this._speed = 1.0\r\n\r\n    // Determines how long a runner is hold in memory. Can be a dt or true/false\r\n    this._persist = 0\r\n\r\n    // Keep track of the running animations and their starting parameters\r\n    this._nextFrame = null\r\n    this._paused = true\r\n    this._runners = []\r\n    this._runnerIds = []\r\n    this._lastRunnerId = -1\r\n    this._time = 0\r\n    this._lastSourceTime = 0\r\n    this._lastStepTime = 0\r\n\r\n    // Make sure that step is always called in class context\r\n    this._step = this._stepFn.bind(this, false)\r\n    this._stepImmediate = this._stepFn.bind(this, true)\r\n  }\r\n\r\n  active () {\r\n    return !!this._nextFrame\r\n  }\r\n\r\n  finish () {\r\n    // Go to end and pause\r\n    this.time(this.getEndTimeOfTimeline() + 1)\r\n    return this.pause()\r\n  }\r\n\r\n  // Calculates the end of the timeline\r\n  getEndTime () {\r\n    const lastRunnerInfo = this.getLastRunnerInfo()\r\n    const lastDuration = lastRunnerInfo ? lastRunnerInfo.runner.duration() : 0\r\n    const lastStartTime = lastRunnerInfo ? lastRunnerInfo.start : this._time\r\n    return lastStartTime + lastDuration\r\n  }\r\n\r\n  getEndTimeOfTimeline () {\r\n    const endTimes = this._runners.map((i) => i.start + i.runner.duration())\r\n    return Math.max(0, ...endTimes)\r\n  }\r\n\r\n  getLastRunnerInfo () {\r\n    return this.getRunnerInfoById(this._lastRunnerId)\r\n  }\r\n\r\n  getRunnerInfoById (id) {\r\n    return this._runners[this._runnerIds.indexOf(id)] || null\r\n  }\r\n\r\n  pause () {\r\n    this._paused = true\r\n    return this._continue()\r\n  }\r\n\r\n  persist (dtOrForever) {\r\n    if (dtOrForever == null) return this._persist\r\n    this._persist = dtOrForever\r\n    return this\r\n  }\r\n\r\n  play () {\r\n    // Now make sure we are not paused and continue the animation\r\n    this._paused = false\r\n    return this.updateTime()._continue()\r\n  }\r\n\r\n  reverse (yes) {\r\n    const currentSpeed = this.speed()\r\n    if (yes == null) return this.speed(-currentSpeed)\r\n\r\n    const positive = Math.abs(currentSpeed)\r\n    return this.speed(yes ? -positive : positive)\r\n  }\r\n\r\n  // schedules a runner on the timeline\r\n  schedule (runner, delay, when) {\r\n    if (runner == null) {\r\n      return this._runners.map(makeSchedule)\r\n    }\r\n\r\n    // The start time for the next animation can either be given explicitly,\r\n    // derived from the current timeline time or it can be relative to the\r\n    // last start time to chain animations directly\r\n\r\n    let absoluteStartTime = 0\r\n    const endTime = this.getEndTime()\r\n    delay = delay || 0\r\n\r\n    // Work out when to start the animation\r\n    if (when == null || when === 'last' || when === 'after') {\r\n      // Take the last time and increment\r\n      absoluteStartTime = endTime\r\n    } else if (when === 'absolute' || when === 'start') {\r\n      absoluteStartTime = delay\r\n      delay = 0\r\n    } else if (when === 'now') {\r\n      absoluteStartTime = this._time\r\n    } else if (when === 'relative') {\r\n      const runnerInfo = this.getRunnerInfoById(runner.id)\r\n      if (runnerInfo) {\r\n        absoluteStartTime = runnerInfo.start + delay\r\n        delay = 0\r\n      }\r\n    } else if (when === 'with-last') {\r\n      const lastRunnerInfo = this.getLastRunnerInfo()\r\n      const lastStartTime = lastRunnerInfo ? lastRunnerInfo.start : this._time\r\n      absoluteStartTime = lastStartTime\r\n    } else {\r\n      throw new Error('Invalid value for the \"when\" parameter')\r\n    }\r\n\r\n    // Manage runner\r\n    runner.unschedule()\r\n    runner.timeline(this)\r\n\r\n    const persist = runner.persist()\r\n    const runnerInfo = {\r\n      persist: persist === null ? this._persist : persist,\r\n      start: absoluteStartTime + delay,\r\n      runner\r\n    }\r\n\r\n    this._lastRunnerId = runner.id\r\n\r\n    this._runners.push(runnerInfo)\r\n    this._runners.sort((a, b) => a.start - b.start)\r\n    this._runnerIds = this._runners.map(info => info.runner.id)\r\n\r\n    this.updateTime()._continue()\r\n    return this\r\n  }\r\n\r\n  seek (dt) {\r\n    return this.time(this._time + dt)\r\n  }\r\n\r\n  source (fn) {\r\n    if (fn == null) return this._timeSource\r\n    this._timeSource = fn\r\n    return this\r\n  }\r\n\r\n  speed (speed) {\r\n    if (speed == null) return this._speed\r\n    this._speed = speed\r\n    return this\r\n  }\r\n\r\n  stop () {\r\n    // Go to start and pause\r\n    this.time(0)\r\n    return this.pause()\r\n  }\r\n\r\n  time (time) {\r\n    if (time == null) return this._time\r\n    this._time = time\r\n    return this._continue(true)\r\n  }\r\n\r\n  // Remove the runner from this timeline\r\n  unschedule (runner) {\r\n    const index = this._runnerIds.indexOf(runner.id)\r\n    if (index < 0) return this\r\n\r\n    this._runners.splice(index, 1)\r\n    this._runnerIds.splice(index, 1)\r\n\r\n    runner.timeline(null)\r\n    return this\r\n  }\r\n\r\n  // Makes sure, that after pausing the time doesn't jump\r\n  updateTime () {\r\n    if (!this.active()) {\r\n      this._lastSourceTime = this._timeSource()\r\n    }\r\n    return this\r\n  }\r\n\r\n  // Checks if we are running and continues the animation\r\n  _continue (immediateStep = false) {\r\n    Animator.cancelFrame(this._nextFrame)\r\n    this._nextFrame = null\r\n\r\n    if (immediateStep) return this._stepImmediate()\r\n    if (this._paused) return this\r\n\r\n    this._nextFrame = Animator.frame(this._step)\r\n    return this\r\n  }\r\n\r\n  _stepFn (immediateStep = false) {\r\n    // Get the time delta from the last time and update the time\r\n    const time = this._timeSource()\r\n    let dtSource = time - this._lastSourceTime\r\n\r\n    if (immediateStep) dtSource = 0\r\n\r\n    const dtTime = this._speed * dtSource + (this._time - this._lastStepTime)\r\n    this._lastSourceTime = time\r\n\r\n    // Only update the time if we use the timeSource.\r\n    // Otherwise use the current time\r\n    if (!immediateStep) {\r\n      // Update the time\r\n      this._time += dtTime\r\n      this._time = this._time < 0 ? 0 : this._time\r\n    }\r\n    this._lastStepTime = this._time\r\n    this.fire('time', this._time)\r\n\r\n    // This is for the case that the timeline was seeked so that the time\r\n    // is now before the startTime of the runner. Thats why we need to set\r\n    // the runner to position 0\r\n\r\n    // FIXME:\r\n    // However, reseting in insertion order leads to bugs. Considering the case,\r\n    // where 2 runners change the same attribute but in different times,\r\n    // reseting both of them will lead to the case where the later defined\r\n    // runner always wins the reset even if the other runner started earlier\r\n    // and therefore should win the attribute battle\r\n    // this can be solved by reseting them backwards\r\n    for (let k = this._runners.length; k--;) {\r\n      // Get and run the current runner and ignore it if its inactive\r\n      const runnerInfo = this._runners[k]\r\n      const runner = runnerInfo.runner\r\n\r\n      // Make sure that we give the actual difference\r\n      // between runner start time and now\r\n      const dtToStart = this._time - runnerInfo.start\r\n\r\n      // Dont run runner if not started yet\r\n      // and try to reset it\r\n      if (dtToStart <= 0) {\r\n        runner.reset()\r\n      }\r\n    }\r\n\r\n    // Run all of the runners directly\r\n    let runnersLeft = false\r\n    for (let i = 0, len = this._runners.length; i < len; i++) {\r\n      // Get and run the current runner and ignore it if its inactive\r\n      const runnerInfo = this._runners[i]\r\n      const runner = runnerInfo.runner\r\n      let dt = dtTime\r\n\r\n      // Make sure that we give the actual difference\r\n      // between runner start time and now\r\n      const dtToStart = this._time - runnerInfo.start\r\n\r\n      // Dont run runner if not started yet\r\n      if (dtToStart <= 0) {\r\n        runnersLeft = true\r\n        continue\r\n      } else if (dtToStart < dt) {\r\n        // Adjust dt to make sure that animation is on point\r\n        dt = dtToStart\r\n      }\r\n\r\n      if (!runner.active()) continue\r\n\r\n      // If this runner is still going, signal that we need another animation\r\n      // frame, otherwise, remove the completed runner\r\n      const finished = runner.step(dt).done\r\n      if (!finished) {\r\n        runnersLeft = true\r\n        // continue\r\n      } else if (runnerInfo.persist !== true) {\r\n        // runner is finished. And runner might get removed\r\n        const endTime = runner.duration() - runner.time() + this._time\r\n\r\n        if (endTime + runnerInfo.persist < this._time) {\r\n          // Delete runner and correct index\r\n          runner.unschedule()\r\n          --i\r\n          --len\r\n        }\r\n      }\r\n    }\r\n\r\n    // Basically: we continue when there are runners right from us in time\r\n    // when -->, and when runners are left from us when <--\r\n    if ((runnersLeft && !(this._speed < 0 && this._time === 0)) || (this._runnerIds.length && this._speed < 0 && this._time > 0)) {\r\n      this._continue()\r\n    } else {\r\n      this.pause()\r\n      this.fire('finished')\r\n    }\r\n\r\n    return this\r\n  }\r\n\r\n}\r\n\r\nregisterMethods({\r\n  Element: {\r\n    timeline: function (timeline) {\r\n      if (timeline == null) {\r\n        this._timeline = (this._timeline || new Timeline())\r\n        return this._timeline\r\n      } else {\r\n        this._timeline = timeline\r\n        return this\r\n      }\r\n    }\r\n  }\r\n})\r\n","import { Controller, Ease, Stepper } from './Controller.js'\r\nimport { extend, register } from '../utils/adopter.js'\r\nimport { from, to } from '../modules/core/gradiented.js'\r\nimport { getOrigin } from '../utils/utils.js'\r\nimport { noop, timeline } from '../modules/core/defaults.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport { rx, ry } from '../modules/core/circled.js'\r\nimport Animator from './Animator.js'\r\nimport Box from '../types/Box.js'\r\nimport EventTarget from '../types/EventTarget.js'\r\nimport Matrix from '../types/Matrix.js'\r\nimport Morphable, { TransformBag, ObjectBag } from './Morphable.js'\r\nimport Point from '../types/Point.js'\r\nimport SVGNumber from '../types/SVGNumber.js'\r\nimport Timeline from './Timeline.js'\r\n\r\nexport default class Runner extends EventTarget {\r\n  constructor (options) {\r\n    super()\r\n\r\n    // Store a unique id on the runner, so that we can identify it later\r\n    this.id = Runner.id++\r\n\r\n    // Ensure a default value\r\n    options = options == null\r\n      ? timeline.duration\r\n      : options\r\n\r\n    // Ensure that we get a controller\r\n    options = typeof options === 'function'\r\n      ? new Controller(options)\r\n      : options\r\n\r\n    // Declare all of the variables\r\n    this._element = null\r\n    this._timeline = null\r\n    this.done = false\r\n    this._queue = []\r\n\r\n    // Work out the stepper and the duration\r\n    this._duration = typeof options === 'number' && options\r\n    this._isDeclarative = options instanceof Controller\r\n    this._stepper = this._isDeclarative ? options : new Ease()\r\n\r\n    // We copy the current values from the timeline because they can change\r\n    this._history = {}\r\n\r\n    // Store the state of the runner\r\n    this.enabled = true\r\n    this._time = 0\r\n    this._lastTime = 0\r\n\r\n    // At creation, the runner is in reseted state\r\n    this._reseted = true\r\n\r\n    // Save transforms applied to this runner\r\n    this.transforms = new Matrix()\r\n    this.transformId = 1\r\n\r\n    // Looping variables\r\n    this._haveReversed = false\r\n    this._reverse = false\r\n    this._loopsDone = 0\r\n    this._swing = false\r\n    this._wait = 0\r\n    this._times = 1\r\n\r\n    this._frameId = null\r\n\r\n    // Stores how long a runner is stored after beeing done\r\n    this._persist = this._isDeclarative ? true : null\r\n  }\r\n\r\n  static sanitise (duration, delay, when) {\r\n    // Initialise the default parameters\r\n    let times = 1\r\n    let swing = false\r\n    let wait = 0\r\n    duration = duration || timeline.duration\r\n    delay = delay || timeline.delay\r\n    when = when || 'last'\r\n\r\n    // If we have an object, unpack the values\r\n    if (typeof duration === 'object' && !(duration instanceof Stepper)) {\r\n      delay = duration.delay || delay\r\n      when = duration.when || when\r\n      swing = duration.swing || swing\r\n      times = duration.times || times\r\n      wait = duration.wait || wait\r\n      duration = duration.duration || timeline.duration\r\n    }\r\n\r\n    return {\r\n      duration: duration,\r\n      delay: delay,\r\n      swing: swing,\r\n      times: times,\r\n      wait: wait,\r\n      when: when\r\n    }\r\n  }\r\n\r\n  active (enabled) {\r\n    if (enabled == null) return this.enabled\r\n    this.enabled = enabled\r\n    return this\r\n  }\r\n\r\n  /*\r\n  Private Methods\r\n  ===============\r\n  Methods that shouldn't be used externally\r\n  */\r\n  addTransform (transform, index) {\r\n    this.transforms.lmultiplyO(transform)\r\n    return this\r\n  }\r\n\r\n  after (fn) {\r\n    return this.on('finished', fn)\r\n  }\r\n\r\n  animate (duration, delay, when) {\r\n    const o = Runner.sanitise(duration, delay, when)\r\n    const runner = new Runner(o.duration)\r\n    if (this._timeline) runner.timeline(this._timeline)\r\n    if (this._element) runner.element(this._element)\r\n    return runner.loop(o).schedule(o.delay, o.when)\r\n  }\r\n\r\n  clearTransform () {\r\n    this.transforms = new Matrix()\r\n    return this\r\n  }\r\n\r\n  // TODO: Keep track of all transformations so that deletion is faster\r\n  clearTransformsFromQueue () {\r\n    if (!this.done || !this._timeline || !this._timeline._runnerIds.includes(this.id)) {\r\n      this._queue = this._queue.filter((item) => {\r\n        return !item.isTransform\r\n      })\r\n    }\r\n  }\r\n\r\n  delay (delay) {\r\n    return this.animate(0, delay)\r\n  }\r\n\r\n  duration () {\r\n    return this._times * (this._wait + this._duration) - this._wait\r\n  }\r\n\r\n  during (fn) {\r\n    return this.queue(null, fn)\r\n  }\r\n\r\n  ease (fn) {\r\n    this._stepper = new Ease(fn)\r\n    return this\r\n  }\r\n  /*\r\n  Runner Definitions\r\n  ==================\r\n  These methods help us define the runtime behaviour of the Runner or they\r\n  help us make new runners from the current runner\r\n  */\r\n\r\n  element (element) {\r\n    if (element == null) return this._element\r\n    this._element = element\r\n    element._prepareRunner()\r\n    return this\r\n  }\r\n\r\n  finish () {\r\n    return this.step(Infinity)\r\n  }\r\n\r\n  loop (times, swing, wait) {\r\n    // Deal with the user passing in an object\r\n    if (typeof times === 'object') {\r\n      swing = times.swing\r\n      wait = times.wait\r\n      times = times.times\r\n    }\r\n\r\n    // Sanitise the values and store them\r\n    this._times = times || Infinity\r\n    this._swing = swing || false\r\n    this._wait = wait || 0\r\n\r\n    // Allow true to be passed\r\n    if (this._times === true) { this._times = Infinity }\r\n\r\n    return this\r\n  }\r\n\r\n  loops (p) {\r\n    const loopDuration = this._duration + this._wait\r\n    if (p == null) {\r\n      const loopsDone = Math.floor(this._time / loopDuration)\r\n      const relativeTime = (this._time - loopsDone * loopDuration)\r\n      const position = relativeTime / this._duration\r\n      return Math.min(loopsDone + position, this._times)\r\n    }\r\n    const whole = Math.floor(p)\r\n    const partial = p % 1\r\n    const time = loopDuration * whole + this._duration * partial\r\n    return this.time(time)\r\n  }\r\n\r\n  persist (dtOrForever) {\r\n    if (dtOrForever == null) return this._persist\r\n    this._persist = dtOrForever\r\n    return this\r\n  }\r\n\r\n  position (p) {\r\n    // Get all of the variables we need\r\n    const x = this._time\r\n    const d = this._duration\r\n    const w = this._wait\r\n    const t = this._times\r\n    const s = this._swing\r\n    const r = this._reverse\r\n    let position\r\n\r\n    if (p == null) {\r\n      /*\r\n      This function converts a time to a position in the range [0, 1]\r\n      The full explanation can be found in this desmos demonstration\r\n        https://www.desmos.com/calculator/u4fbavgche\r\n      The logic is slightly simplified here because we can use booleans\r\n      */\r\n\r\n      // Figure out the value without thinking about the start or end time\r\n      const f = function (x) {\r\n        const swinging = s * Math.floor(x % (2 * (w + d)) / (w + d))\r\n        const backwards = (swinging && !r) || (!swinging && r)\r\n        const uncliped = Math.pow(-1, backwards) * (x % (w + d)) / d + backwards\r\n        const clipped = Math.max(Math.min(uncliped, 1), 0)\r\n        return clipped\r\n      }\r\n\r\n      // Figure out the value by incorporating the start time\r\n      const endTime = t * (w + d) - w\r\n      position = x <= 0\r\n        ? Math.round(f(1e-5))\r\n        : x < endTime\r\n          ? f(x)\r\n          : Math.round(f(endTime - 1e-5))\r\n      return position\r\n    }\r\n\r\n    // Work out the loops done and add the position to the loops done\r\n    const loopsDone = Math.floor(this.loops())\r\n    const swingForward = s && (loopsDone % 2 === 0)\r\n    const forwards = (swingForward && !r) || (r && swingForward)\r\n    position = loopsDone + (forwards ? p : 1 - p)\r\n    return this.loops(position)\r\n  }\r\n\r\n  progress (p) {\r\n    if (p == null) {\r\n      return Math.min(1, this._time / this.duration())\r\n    }\r\n    return this.time(p * this.duration())\r\n  }\r\n\r\n  /*\r\n  Basic Functionality\r\n  ===================\r\n  These methods allow us to attach basic functions to the runner directly\r\n  */\r\n  queue (initFn, runFn, retargetFn, isTransform) {\r\n    this._queue.push({\r\n      initialiser: initFn || noop,\r\n      runner: runFn || noop,\r\n      retarget: retargetFn,\r\n      isTransform: isTransform,\r\n      initialised: false,\r\n      finished: false\r\n    })\r\n    const timeline = this.timeline()\r\n    timeline && this.timeline()._continue()\r\n    return this\r\n  }\r\n\r\n  reset () {\r\n    if (this._reseted) return this\r\n    this.time(0)\r\n    this._reseted = true\r\n    return this\r\n  }\r\n\r\n  reverse (reverse) {\r\n    this._reverse = reverse == null ? !this._reverse : reverse\r\n    return this\r\n  }\r\n\r\n  schedule (timeline, delay, when) {\r\n    // The user doesn't need to pass a timeline if we already have one\r\n    if (!(timeline instanceof Timeline)) {\r\n      when = delay\r\n      delay = timeline\r\n      timeline = this.timeline()\r\n    }\r\n\r\n    // If there is no timeline, yell at the user...\r\n    if (!timeline) {\r\n      throw Error('Runner cannot be scheduled without timeline')\r\n    }\r\n\r\n    // Schedule the runner on the timeline provided\r\n    timeline.schedule(this, delay, when)\r\n    return this\r\n  }\r\n\r\n  step (dt) {\r\n    // If we are inactive, this stepper just gets skipped\r\n    if (!this.enabled) return this\r\n\r\n    // Update the time and get the new position\r\n    dt = dt == null ? 16 : dt\r\n    this._time += dt\r\n    const position = this.position()\r\n\r\n    // Figure out if we need to run the stepper in this frame\r\n    const running = this._lastPosition !== position && this._time >= 0\r\n    this._lastPosition = position\r\n\r\n    // Figure out if we just started\r\n    const duration = this.duration()\r\n    const justStarted = this._lastTime <= 0 && this._time > 0\r\n    const justFinished = this._lastTime < duration && this._time >= duration\r\n\r\n    this._lastTime = this._time\r\n    if (justStarted) {\r\n      this.fire('start', this)\r\n    }\r\n\r\n    // Work out if the runner is finished set the done flag here so animations\r\n    // know, that they are running in the last step (this is good for\r\n    // transformations which can be merged)\r\n    const declarative = this._isDeclarative\r\n    this.done = !declarative && !justFinished && this._time >= duration\r\n\r\n    // Runner is running. So its not in reseted state anymore\r\n    this._reseted = false\r\n\r\n    let converged = false\r\n    // Call initialise and the run function\r\n    if (running || declarative) {\r\n      this._initialise(running)\r\n\r\n      // clear the transforms on this runner so they dont get added again and again\r\n      this.transforms = new Matrix()\r\n      converged = this._run(declarative ? dt : position)\r\n\r\n      this.fire('step', this)\r\n    }\r\n    // correct the done flag here\r\n    // declaritive animations itself know when they converged\r\n    this.done = this.done || (converged && declarative)\r\n    if (justFinished) {\r\n      this.fire('finished', this)\r\n    }\r\n    return this\r\n  }\r\n\r\n  /*\r\n  Runner animation methods\r\n  ========================\r\n  Control how the animation plays\r\n  */\r\n  time (time) {\r\n    if (time == null) {\r\n      return this._time\r\n    }\r\n    const dt = time - this._time\r\n    this.step(dt)\r\n    return this\r\n  }\r\n\r\n  timeline (timeline) {\r\n    // check explicitly for undefined so we can set the timeline to null\r\n    if (typeof timeline === 'undefined') return this._timeline\r\n    this._timeline = timeline\r\n    return this\r\n  }\r\n\r\n  unschedule () {\r\n    const timeline = this.timeline()\r\n    timeline && timeline.unschedule(this)\r\n    return this\r\n  }\r\n\r\n  // Run each initialise function in the runner if required\r\n  _initialise (running) {\r\n    // If we aren't running, we shouldn't initialise when not declarative\r\n    if (!running && !this._isDeclarative) return\r\n\r\n    // Loop through all of the initialisers\r\n    for (let i = 0, len = this._queue.length; i < len; ++i) {\r\n      // Get the current initialiser\r\n      const current = this._queue[i]\r\n\r\n      // Determine whether we need to initialise\r\n      const needsIt = this._isDeclarative || (!current.initialised && running)\r\n      running = !current.finished\r\n\r\n      // Call the initialiser if we need to\r\n      if (needsIt && running) {\r\n        current.initialiser.call(this)\r\n        current.initialised = true\r\n      }\r\n    }\r\n  }\r\n\r\n  // Save a morpher to the morpher list so that we can retarget it later\r\n  _rememberMorpher (method, morpher) {\r\n    this._history[method] = {\r\n      morpher: morpher,\r\n      caller: this._queue[this._queue.length - 1]\r\n    }\r\n\r\n    // We have to resume the timeline in case a controller\r\n    // is already done without being ever run\r\n    // This can happen when e.g. this is done:\r\n    //    anim = el.animate(new SVG.Spring)\r\n    // and later\r\n    //    anim.move(...)\r\n    if (this._isDeclarative) {\r\n      const timeline = this.timeline()\r\n      timeline && timeline.play()\r\n    }\r\n  }\r\n\r\n  // Try to set the target for a morpher if the morpher exists, otherwise\r\n  // Run each run function for the position or dt given\r\n  _run (positionOrDt) {\r\n    // Run all of the _queue directly\r\n    let allfinished = true\r\n    for (let i = 0, len = this._queue.length; i < len; ++i) {\r\n      // Get the current function to run\r\n      const current = this._queue[i]\r\n\r\n      // Run the function if its not finished, we keep track of the finished\r\n      // flag for the sake of declarative _queue\r\n      const converged = current.runner.call(this, positionOrDt)\r\n      current.finished = current.finished || (converged === true)\r\n      allfinished = allfinished && current.finished\r\n    }\r\n\r\n    // We report when all of the constructors are finished\r\n    return allfinished\r\n  }\r\n\r\n  // do nothing and return false\r\n  _tryRetarget (method, target, extra) {\r\n    if (this._history[method]) {\r\n      // if the last method wasnt even initialised, throw it away\r\n      if (!this._history[method].caller.initialised) {\r\n        const index = this._queue.indexOf(this._history[method].caller)\r\n        this._queue.splice(index, 1)\r\n        return false\r\n      }\r\n\r\n      // for the case of transformations, we use the special retarget function\r\n      // which has access to the outer scope\r\n      if (this._history[method].caller.retarget) {\r\n        this._history[method].caller.retarget.call(this, target, extra)\r\n        // for everything else a simple morpher change is sufficient\r\n      } else {\r\n        this._history[method].morpher.to(target)\r\n      }\r\n\r\n      this._history[method].caller.finished = false\r\n      const timeline = this.timeline()\r\n      timeline && timeline.play()\r\n      return true\r\n    }\r\n    return false\r\n  }\r\n\r\n}\r\n\r\nRunner.id = 0\r\n\r\nexport class FakeRunner {\r\n  constructor (transforms = new Matrix(), id = -1, done = true) {\r\n    this.transforms = transforms\r\n    this.id = id\r\n    this.done = done\r\n  }\r\n\r\n  clearTransformsFromQueue () { }\r\n}\r\n\r\nextend([ Runner, FakeRunner ], {\r\n  mergeWith (runner) {\r\n    return new FakeRunner(\r\n      runner.transforms.lmultiply(this.transforms),\r\n      runner.id\r\n    )\r\n  }\r\n})\r\n\r\n// FakeRunner.emptyRunner = new FakeRunner()\r\n\r\nconst lmultiply = (last, curr) => last.lmultiplyO(curr)\r\nconst getRunnerTransform = (runner) => runner.transforms\r\n\r\nfunction mergeTransforms () {\r\n  // Find the matrix to apply to the element and apply it\r\n  const runners = this._transformationRunners.runners\r\n  const netTransform = runners\r\n    .map(getRunnerTransform)\r\n    .reduce(lmultiply, new Matrix())\r\n\r\n  this.transform(netTransform)\r\n\r\n  this._transformationRunners.merge()\r\n\r\n  if (this._transformationRunners.length() === 1) {\r\n    this._frameId = null\r\n  }\r\n}\r\n\r\nexport class RunnerArray {\r\n  constructor () {\r\n    this.runners = []\r\n    this.ids = []\r\n  }\r\n\r\n  add (runner) {\r\n    if (this.runners.includes(runner)) return\r\n    const id = runner.id + 1\r\n\r\n    this.runners.push(runner)\r\n    this.ids.push(id)\r\n\r\n    return this\r\n  }\r\n\r\n  clearBefore (id) {\r\n    const deleteCnt = this.ids.indexOf(id + 1) || 1\r\n    this.ids.splice(0, deleteCnt, 0)\r\n    this.runners.splice(0, deleteCnt, new FakeRunner())\r\n      .forEach((r) => r.clearTransformsFromQueue())\r\n    return this\r\n  }\r\n\r\n  edit (id, newRunner) {\r\n    const index = this.ids.indexOf(id + 1)\r\n    this.ids.splice(index, 1, id + 1)\r\n    this.runners.splice(index, 1, newRunner)\r\n    return this\r\n  }\r\n\r\n  getByID (id) {\r\n    return this.runners[this.ids.indexOf(id + 1)]\r\n  }\r\n\r\n  length () {\r\n    return this.ids.length\r\n  }\r\n\r\n  merge () {\r\n    let lastRunner = null\r\n    for (let i = 0; i < this.runners.length; ++i) {\r\n      const runner = this.runners[i]\r\n\r\n      const condition = lastRunner\r\n        && runner.done && lastRunner.done\r\n        // don't merge runner when persisted on timeline\r\n        && (!runner._timeline || !runner._timeline._runnerIds.includes(runner.id))\r\n        && (!lastRunner._timeline || !lastRunner._timeline._runnerIds.includes(lastRunner.id))\r\n\r\n      if (condition) {\r\n        // the +1 happens in the function\r\n        this.remove(runner.id)\r\n        const newRunner = runner.mergeWith(lastRunner)\r\n        this.edit(lastRunner.id, newRunner)\r\n        lastRunner = newRunner\r\n        --i\r\n      } else {\r\n        lastRunner = runner\r\n      }\r\n    }\r\n\r\n    return this\r\n  }\r\n\r\n  remove (id) {\r\n    const index = this.ids.indexOf(id + 1)\r\n    this.ids.splice(index, 1)\r\n    this.runners.splice(index, 1)\r\n    return this\r\n  }\r\n\r\n}\r\n\r\nregisterMethods({\r\n  Element: {\r\n    animate (duration, delay, when) {\r\n      const o = Runner.sanitise(duration, delay, when)\r\n      const timeline = this.timeline()\r\n      return new Runner(o.duration)\r\n        .loop(o)\r\n        .element(this)\r\n        .timeline(timeline.play())\r\n        .schedule(o.delay, o.when)\r\n    },\r\n\r\n    delay (by, when) {\r\n      return this.animate(0, by, when)\r\n    },\r\n\r\n    // this function searches for all runners on the element and deletes the ones\r\n    // which run before the current one. This is because absolute transformations\r\n    // overwfrite anything anyway so there is no need to waste time computing\r\n    // other runners\r\n    _clearTransformRunnersBefore (currentRunner) {\r\n      this._transformationRunners.clearBefore(currentRunner.id)\r\n    },\r\n\r\n    _currentTransform (current) {\r\n      return this._transformationRunners.runners\r\n        // we need the equal sign here to make sure, that also transformations\r\n        // on the same runner which execute before the current transformation are\r\n        // taken into account\r\n        .filter((runner) => runner.id <= current.id)\r\n        .map(getRunnerTransform)\r\n        .reduce(lmultiply, new Matrix())\r\n    },\r\n\r\n    _addRunner (runner) {\r\n      this._transformationRunners.add(runner)\r\n\r\n      // Make sure that the runner merge is executed at the very end of\r\n      // all Animator functions. Thats why we use immediate here to execute\r\n      // the merge right after all frames are run\r\n      Animator.cancelImmediate(this._frameId)\r\n      this._frameId = Animator.immediate(mergeTransforms.bind(this))\r\n    },\r\n\r\n    _prepareRunner () {\r\n      if (this._frameId == null) {\r\n        this._transformationRunners = new RunnerArray()\r\n          .add(new FakeRunner(new Matrix(this)))\r\n      }\r\n    }\r\n  }\r\n})\r\n\r\n// Will output the elements from array A that are not in the array B\r\nconst difference = (a, b) => a.filter(x => !b.includes(x))\r\n\r\nextend(Runner, {\r\n  attr (a, v) {\r\n    return this.styleAttr('attr', a, v)\r\n  },\r\n\r\n  // Add animatable styles\r\n  css (s, v) {\r\n    return this.styleAttr('css', s, v)\r\n  },\r\n\r\n  styleAttr (type, nameOrAttrs, val) {\r\n    if (typeof nameOrAttrs === 'string') {\r\n      return this.styleAttr(type, { [nameOrAttrs]: val })\r\n    }\r\n\r\n    let attrs = nameOrAttrs\r\n    if (this._tryRetarget(type, attrs)) return this\r\n\r\n    let morpher = new Morphable(this._stepper).to(attrs)\r\n    let keys = Object.keys(attrs)\r\n\r\n    this.queue(function () {\r\n      morpher = morpher.from(this.element()[type](keys))\r\n    }, function (pos) {\r\n      this.element()[type](morpher.at(pos).valueOf())\r\n      return morpher.done()\r\n    }, function (newToAttrs) {\r\n\r\n      // Check if any new keys were added\r\n      const newKeys = Object.keys(newToAttrs)\r\n      const differences = difference(newKeys, keys)\r\n\r\n      // If their are new keys, initialize them and add them to morpher\r\n      if (differences.length) {\r\n        // Get the values\r\n        const addedFromAttrs = this.element()[type](differences)\r\n\r\n        // Get the already initialized values\r\n        const oldFromAttrs = new ObjectBag(morpher.from()).valueOf()\r\n\r\n        // Merge old and new\r\n        Object.assign(oldFromAttrs, addedFromAttrs)\r\n        morpher.from(oldFromAttrs)\r\n      }\r\n\r\n      // Get the object from the morpher\r\n      const oldToAttrs = new ObjectBag(morpher.to()).valueOf()\r\n\r\n      // Merge in new attributes\r\n      Object.assign(oldToAttrs, newToAttrs)\r\n\r\n      // Change morpher target\r\n      morpher.to(oldToAttrs)\r\n\r\n      // Make sure that we save the work we did so we don't need it to do again\r\n      keys = newKeys\r\n      attrs = newToAttrs\r\n    })\r\n\r\n    this._rememberMorpher(type, morpher)\r\n    return this\r\n  },\r\n\r\n  zoom (level, point) {\r\n    if (this._tryRetarget('zoom', level, point)) return this\r\n\r\n    let morpher = new Morphable(this._stepper).to(new SVGNumber(level))\r\n\r\n    this.queue(function () {\r\n      morpher = morpher.from(this.element().zoom())\r\n    }, function (pos) {\r\n      this.element().zoom(morpher.at(pos), point)\r\n      return morpher.done()\r\n    }, function (newLevel, newPoint) {\r\n      point = newPoint\r\n      morpher.to(newLevel)\r\n    })\r\n\r\n    this._rememberMorpher('zoom', morpher)\r\n    return this\r\n  },\r\n\r\n  /**\r\n   ** absolute transformations\r\n   **/\r\n\r\n  //\r\n  // M v -----|-----(D M v = F v)------|----->  T v\r\n  //\r\n  // 1. define the final state (T) and decompose it (once)\r\n  //    t = [tx, ty, the, lam, sy, sx]\r\n  // 2. on every frame: pull the current state of all previous transforms\r\n  //    (M - m can change)\r\n  //   and then write this as m = [tx0, ty0, the0, lam0, sy0, sx0]\r\n  // 3. Find the interpolated matrix F(pos) = m + pos * (t - m)\r\n  //   - Note F(0) = M\r\n  //   - Note F(1) = T\r\n  // 4. Now you get the delta matrix as a result: D = F * inv(M)\r\n\r\n  transform (transforms, relative, affine) {\r\n    // If we have a declarative function, we should retarget it if possible\r\n    relative = transforms.relative || relative\r\n    if (this._isDeclarative && !relative && this._tryRetarget('transform', transforms)) {\r\n      return this\r\n    }\r\n\r\n    // Parse the parameters\r\n    const isMatrix = Matrix.isMatrixLike(transforms)\r\n    affine = transforms.affine != null\r\n      ? transforms.affine\r\n      : (affine != null ? affine : !isMatrix)\r\n\r\n    // Create a morepher and set its type\r\n    const morpher = new Morphable(this._stepper)\r\n      .type(affine ? TransformBag : Matrix)\r\n\r\n    let origin\r\n    let element\r\n    let current\r\n    let currentAngle\r\n    let startTransform\r\n\r\n    function setup () {\r\n      // make sure element and origin is defined\r\n      element = element || this.element()\r\n      origin = origin || getOrigin(transforms, element)\r\n\r\n      startTransform = new Matrix(relative ? undefined : element)\r\n\r\n      // add the runner to the element so it can merge transformations\r\n      element._addRunner(this)\r\n\r\n      // Deactivate all transforms that have run so far if we are absolute\r\n      if (!relative) {\r\n        element._clearTransformRunnersBefore(this)\r\n      }\r\n    }\r\n\r\n    function run (pos) {\r\n      // clear all other transforms before this in case something is saved\r\n      // on this runner. We are absolute. We dont need these!\r\n      if (!relative) this.clearTransform()\r\n\r\n      const { x, y } = new Point(origin).transform(element._currentTransform(this))\r\n\r\n      let target = new Matrix({ ...transforms, origin: [ x, y ] })\r\n      let start = this._isDeclarative && current\r\n        ? current\r\n        : startTransform\r\n\r\n      if (affine) {\r\n        target = target.decompose(x, y)\r\n        start = start.decompose(x, y)\r\n\r\n        // Get the current and target angle as it was set\r\n        const rTarget = target.rotate\r\n        const rCurrent = start.rotate\r\n\r\n        // Figure out the shortest path to rotate directly\r\n        const possibilities = [ rTarget - 360, rTarget, rTarget + 360 ]\r\n        const distances = possibilities.map(a => Math.abs(a - rCurrent))\r\n        const shortest = Math.min(...distances)\r\n        const index = distances.indexOf(shortest)\r\n        target.rotate = possibilities[index]\r\n      }\r\n\r\n      if (relative) {\r\n        // we have to be careful here not to overwrite the rotation\r\n        // with the rotate method of Matrix\r\n        if (!isMatrix) {\r\n          target.rotate = transforms.rotate || 0\r\n        }\r\n        if (this._isDeclarative && currentAngle) {\r\n          start.rotate = currentAngle\r\n        }\r\n      }\r\n\r\n      morpher.from(start)\r\n      morpher.to(target)\r\n\r\n      const affineParameters = morpher.at(pos)\r\n      currentAngle = affineParameters.rotate\r\n      current = new Matrix(affineParameters)\r\n\r\n      this.addTransform(current)\r\n      element._addRunner(this)\r\n      return morpher.done()\r\n    }\r\n\r\n    function retarget (newTransforms) {\r\n      // only get a new origin if it changed since the last call\r\n      if (\r\n        (newTransforms.origin || 'center').toString()\r\n        !== (transforms.origin || 'center').toString()\r\n      ) {\r\n        origin = getOrigin(newTransforms, element)\r\n      }\r\n\r\n      // overwrite the old transformations with the new ones\r\n      transforms = { ...newTransforms, origin }\r\n    }\r\n\r\n    this.queue(setup, run, retarget, true)\r\n    this._isDeclarative && this._rememberMorpher('transform', morpher)\r\n    return this\r\n  },\r\n\r\n  // Animatable x-axis\r\n  x (x, relative) {\r\n    return this._queueNumber('x', x)\r\n  },\r\n\r\n  // Animatable y-axis\r\n  y (y) {\r\n    return this._queueNumber('y', y)\r\n  },\r\n\r\n  dx (x = 0) {\r\n    return this._queueNumberDelta('x', x)\r\n  },\r\n\r\n  dy (y = 0) {\r\n    return this._queueNumberDelta('y', y)\r\n  },\r\n\r\n  dmove (x, y) {\r\n    return this.dx(x).dy(y)\r\n  },\r\n\r\n  _queueNumberDelta (method, to) {\r\n    to = new SVGNumber(to)\r\n\r\n    // Try to change the target if we have this method already registerd\r\n    if (this._tryRetarget(method, to)) return this\r\n\r\n    // Make a morpher and queue the animation\r\n    const morpher = new Morphable(this._stepper).to(to)\r\n    let from = null\r\n    this.queue(function () {\r\n      from = this.element()[method]()\r\n      morpher.from(from)\r\n      morpher.to(from + to)\r\n    }, function (pos) {\r\n      this.element()[method](morpher.at(pos))\r\n      return morpher.done()\r\n    }, function (newTo) {\r\n      morpher.to(from + new SVGNumber(newTo))\r\n    })\r\n\r\n    // Register the morpher so that if it is changed again, we can retarget it\r\n    this._rememberMorpher(method, morpher)\r\n    return this\r\n  },\r\n\r\n  _queueObject (method, to) {\r\n    // Try to change the target if we have this method already registerd\r\n    if (this._tryRetarget(method, to)) return this\r\n\r\n    // Make a morpher and queue the animation\r\n    const morpher = new Morphable(this._stepper).to(to)\r\n    this.queue(function () {\r\n      morpher.from(this.element()[method]())\r\n    }, function (pos) {\r\n      this.element()[method](morpher.at(pos))\r\n      return morpher.done()\r\n    })\r\n\r\n    // Register the morpher so that if it is changed again, we can retarget it\r\n    this._rememberMorpher(method, morpher)\r\n    return this\r\n  },\r\n\r\n  _queueNumber (method, value) {\r\n    return this._queueObject(method, new SVGNumber(value))\r\n  },\r\n\r\n  // Animatable center x-axis\r\n  cx (x) {\r\n    return this._queueNumber('cx', x)\r\n  },\r\n\r\n  // Animatable center y-axis\r\n  cy (y) {\r\n    return this._queueNumber('cy', y)\r\n  },\r\n\r\n  // Add animatable move\r\n  move (x, y) {\r\n    return this.x(x).y(y)\r\n  },\r\n\r\n  // Add animatable center\r\n  center (x, y) {\r\n    return this.cx(x).cy(y)\r\n  },\r\n\r\n  // Add animatable size\r\n  size (width, height) {\r\n    // animate bbox based size for all other elements\r\n    let box\r\n\r\n    if (!width || !height) {\r\n      box = this._element.bbox()\r\n    }\r\n\r\n    if (!width) {\r\n      width = box.width / box.height * height\r\n    }\r\n\r\n    if (!height) {\r\n      height = box.height / box.width * width\r\n    }\r\n\r\n    return this\r\n      .width(width)\r\n      .height(height)\r\n  },\r\n\r\n  // Add animatable width\r\n  width (width) {\r\n    return this._queueNumber('width', width)\r\n  },\r\n\r\n  // Add animatable height\r\n  height (height) {\r\n    return this._queueNumber('height', height)\r\n  },\r\n\r\n  // Add animatable plot\r\n  plot (a, b, c, d) {\r\n    // Lines can be plotted with 4 arguments\r\n    if (arguments.length === 4) {\r\n      return this.plot([ a, b, c, d ])\r\n    }\r\n\r\n    if (this._tryRetarget('plot', a)) return this\r\n\r\n    const morpher = new Morphable(this._stepper)\r\n      .type(this._element.MorphArray).to(a)\r\n\r\n    this.queue(function () {\r\n      morpher.from(this._element.array())\r\n    }, function (pos) {\r\n      this._element.plot(morpher.at(pos))\r\n      return morpher.done()\r\n    })\r\n\r\n    this._rememberMorpher('plot', morpher)\r\n    return this\r\n  },\r\n\r\n  // Add leading method\r\n  leading (value) {\r\n    return this._queueNumber('leading', value)\r\n  },\r\n\r\n  // Add animatable viewbox\r\n  viewbox (x, y, width, height) {\r\n    return this._queueObject('viewbox', new Box(x, y, width, height))\r\n  },\r\n\r\n  update (o) {\r\n    if (typeof o !== 'object') {\r\n      return this.update({\r\n        offset: arguments[0],\r\n        color: arguments[1],\r\n        opacity: arguments[2]\r\n      })\r\n    }\r\n\r\n    if (o.opacity != null) this.attr('stop-opacity', o.opacity)\r\n    if (o.color != null) this.attr('stop-color', o.color)\r\n    if (o.offset != null) this.attr('offset', o.offset)\r\n\r\n    return this\r\n  }\r\n})\r\n\r\nextend(Runner, { rx, ry, from, to })\r\nregister(Runner, 'Runner')\r\n","import {\r\n  adopt,\r\n  nodeOrNew,\r\n  register,\r\n  wrapWithAttrCheck\r\n} from '../utils/adopter.js'\r\nimport { svg, svgjs, xlink, xmlns } from '../modules/core/namespaces.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport Container from './Container.js'\r\nimport Defs from './Defs.js'\r\nimport { globals } from '../utils/window.js'\r\n\r\nexport default class Svg extends Container {\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('svg', node), attrs)\r\n    this.namespace()\r\n  }\r\n\r\n  // Creates and returns defs element\r\n  defs () {\r\n    if (!this.isRoot()) return this.root().defs()\r\n\r\n    return adopt(this.node.querySelector('defs'))\r\n      || this.put(new Defs())\r\n  }\r\n\r\n  isRoot () {\r\n    return !this.node.parentNode\r\n      || (!(this.node.parentNode instanceof globals.window.SVGElement) && this.node.parentNode.nodeName !== '#document-fragment')\r\n  }\r\n\r\n  // Add namespaces\r\n  namespace () {\r\n    if (!this.isRoot()) return this.root().namespace()\r\n    return this\r\n      .attr({ xmlns: svg, version: '1.1' })\r\n      .attr('xmlns:xlink', xlink, xmlns)\r\n      .attr('xmlns:svgjs', svgjs, xmlns)\r\n  }\r\n\r\n  removeNamespace () {\r\n    return this.attr({ xmlns: null, version: null })\r\n      .attr('xmlns:xlink', null, xmlns)\r\n      .attr('xmlns:svgjs', null, xmlns)\r\n  }\r\n\r\n  // Check if this is a root svg\r\n  // If not, call root() from this element\r\n  root () {\r\n    if (this.isRoot()) return this\r\n    return super.root()\r\n  }\r\n\r\n}\r\n\r\nregisterMethods({\r\n  Container: {\r\n    // Create nested svg document\r\n    nested: wrapWithAttrCheck(function () {\r\n      return this.put(new Svg())\r\n    })\r\n  }\r\n})\r\n\r\nregister(Svg, 'Svg', true)\r\n","import { nodeOrNew, register, wrapWithAttrCheck } from '../utils/adopter.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport Container from './Container.js'\r\n\r\nexport default class Symbol extends Container {\r\n  // Initialize node\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('symbol', node), attrs)\r\n  }\r\n}\r\n\r\nregisterMethods({\r\n  Container: {\r\n    symbol: wrapWithAttrCheck(function () {\r\n      return this.put(new Symbol())\r\n    })\r\n  }\r\n})\r\n\r\nregister(Symbol, 'Symbol')\r\n","import { globals } from '../../utils/window.js'\r\n\r\n// Create plain text node\r\nexport function plain (text) {\r\n  // clear if build mode is disabled\r\n  if (this._build === false) {\r\n    this.clear()\r\n  }\r\n\r\n  // create text node\r\n  this.node.appendChild(globals.document.createTextNode(text))\r\n\r\n  return this\r\n}\r\n\r\n// Get length of text element\r\nexport function length () {\r\n  return this.node.getComputedTextLength()\r\n}\r\n\r\n// Move over x-axis\r\n// Text is moved by its bounding box\r\n// text-anchor does NOT matter\r\nexport function x (x, box = this.bbox()) {\r\n  if (x == null) {\r\n    return box.x\r\n  }\r\n\r\n  return this.attr('x', this.attr('x') + x - box.x)\r\n}\r\n\r\n// Move over y-axis\r\nexport function y (y, box = this.bbox()) {\r\n  if (y == null) {\r\n    return box.y\r\n  }\r\n\r\n  return this.attr('y', this.attr('y') + y - box.y)\r\n}\r\n\r\nexport function move (x, y, box = this.bbox()) {\r\n  return this.x(x, box).y(y, box)\r\n}\r\n\r\n// Move center over x-axis\r\nexport function cx (x, box = this.bbox()) {\r\n  if (x == null) {\r\n    return box.cx\r\n  }\r\n\r\n  return this.attr('x', this.attr('x') + x - box.cx)\r\n}\r\n\r\n// Move center over y-axis\r\nexport function cy (y, box = this.bbox()) {\r\n  if (y == null) {\r\n    return box.cy\r\n  }\r\n\r\n  return this.attr('y', this.attr('y') + y - box.cy)\r\n}\r\n\r\nexport function center (x, y, box = this.bbox()) {\r\n  return this.cx(x, box).cy(y, box)\r\n}\r\n\r\nexport function ax (x) {\r\n  return this.attr('x', x)\r\n}\r\n\r\nexport function ay (y) {\r\n  return this.attr('y', y)\r\n}\r\n\r\nexport function amove (x, y) {\r\n  return this.ax(x).ay(y)\r\n}\r\n\r\n// Enable / disable build mode\r\nexport function build (build) {\r\n  this._build = !!build\r\n  return this\r\n}\r\n","import {\r\n  adopt,\r\n  extend,\r\n  nodeOrNew,\r\n  register,\r\n  wrapWithAttrCheck\r\n} from '../utils/adopter.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport SVGNumber from '../types/SVGNumber.js'\r\nimport Shape from './Shape.js'\r\nimport { globals } from '../utils/window.js'\r\nimport * as textable from '../modules/core/textable.js'\r\n\r\nexport default class Text extends Shape {\r\n  // Initialize node\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('text', node), attrs)\r\n\r\n    this.dom.leading = new SVGNumber(1.3) // store leading value for rebuilding\r\n    this._rebuild = true // enable automatic updating of dy values\r\n    this._build = false // disable build mode for adding multiple lines\r\n  }\r\n\r\n  // Set / get leading\n  leading (value) {\r\n    // act as getter\r\n    if (value == null) {\r\n      return this.dom.leading\r\n    }\r\n\r\n    // act as setter\r\n    this.dom.leading = new SVGNumber(value)\r\n\r\n    return this.rebuild()\r\n  }\n\n  // Rebuild appearance type\n  rebuild (rebuild) {\r\n    // store new rebuild flag if given\r\n    if (typeof rebuild === 'boolean') {\r\n      this._rebuild = rebuild\r\n    }\r\n\r\n    // define position of all lines\r\n    if (this._rebuild) {\r\n      const self = this\r\n      let blankLineOffset = 0\r\n      const leading = this.dom.leading\r\n\r\n      this.each(function (i) {\r\n        const fontSize = globals.window.getComputedStyle(this.node)\r\n          .getPropertyValue('font-size')\r\n\r\n        const dy = leading * new SVGNumber(fontSize)\r\n\r\n        if (this.dom.newLined) {\r\n          this.attr('x', self.attr('x'))\r\n\r\n          if (this.text() === '\\n') {\r\n            blankLineOffset += dy\r\n          } else {\r\n            this.attr('dy', i ? dy + blankLineOffset : 0)\r\n            blankLineOffset = 0\r\n          }\r\n        }\r\n      })\r\n\r\n      this.fire('rebuild')\r\n    }\r\n\r\n    return this\r\n  }\n\n  // overwrite method from parent to set data properly\n  setData (o) {\r\n    this.dom = o\r\n    this.dom.leading = new SVGNumber(o.leading || 1.3)\r\n    return this\r\n  }\n\n  // Set the text content\r\n  text (text) {\r\n    // act as getter\r\n    if (text === undefined) {\r\n      const children = this.node.childNodes\r\n      let firstLine = 0\r\n      text = ''\r\n\r\n      for (let i = 0, len = children.length; i < len; ++i) {\r\n        // skip textPaths - they are no lines\r\n        if (children[i].nodeName === 'textPath') {\r\n          if (i === 0) firstLine = 1\r\n          continue\r\n        }\r\n\r\n        // add newline if its not the first child and newLined is set to true\r\n        if (i !== firstLine && children[i].nodeType !== 3 && adopt(children[i]).dom.newLined === true) {\r\n          text += '\\n'\r\n        }\r\n\r\n        // add content of this node\r\n        text += children[i].textContent\r\n      }\r\n\r\n      return text\r\n    }\r\n\r\n    // remove existing content\r\n    this.clear().build(true)\r\n\r\n    if (typeof text === 'function') {\r\n      // call block\r\n      text.call(this, this)\r\n    } else {\r\n      // store text and make sure text is not blank\r\n      text = (text + '').split('\\n')\r\n\r\n      // build new lines\r\n      for (let j = 0, jl = text.length; j < jl; j++) {\r\n        this.newLine(text[j])\r\n      }\r\n    }\r\n\r\n    // disable build mode and rebuild lines\r\n    return this.build(false).rebuild()\r\n  }\r\n\r\n}\r\n\r\nextend(Text, textable)\r\n\r\nregisterMethods({\r\n  Container: {\r\n    // Create text element\r\n    text: wrapWithAttrCheck(function (text = '') {\r\n      return this.put(new Text()).text(text)\r\n    }),\r\n\r\n    // Create plain text element\r\n    plain: wrapWithAttrCheck(function (text = '') {\r\n      return this.put(new Text()).plain(text)\r\n    })\r\n  }\r\n})\r\n\r\nregister(Text, 'Text')\r\n","import {\r\n  extend,\r\n  nodeOrNew,\r\n  register,\r\n  wrapWithAttrCheck\r\n} from '../utils/adopter.js'\r\nimport { globals } from '../utils/window.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport SVGNumber from '../types/SVGNumber.js'\r\nimport Shape from './Shape.js'\r\nimport Text from './Text.js'\r\nimport * as textable from '../modules/core/textable.js'\r\n\r\nexport default class Tspan extends Shape {\r\n  // Initialize node\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('tspan', node), attrs)\r\n    this._build = false // disable build mode for adding multiple lines\r\n  }\r\n\r\n  // Shortcut dx\n  dx (dx) {\r\n    return this.attr('dx', dx)\r\n  }\n\n  // Shortcut dy\n  dy (dy) {\r\n    return this.attr('dy', dy)\r\n  }\n\n  // Create new line\n  newLine () {\r\n    // mark new line\r\n    this.dom.newLined = true\r\n\r\n    // fetch parent\r\n    const text = this.parent()\r\n\r\n    // early return in case we are not in a text element\r\n    if (!(text instanceof Text)) {\r\n      return this\r\n    }\r\n\r\n    const i = text.index(this)\r\n\r\n    const fontSize = globals.window.getComputedStyle(this.node)\r\n      .getPropertyValue('font-size')\r\n    const dy = text.dom.leading * new SVGNumber(fontSize)\r\n\r\n    // apply new position\r\n    return this.dy(i ? dy : 0).attr('x', text.x())\r\n  }\n\n  // Set text content\r\n  text (text) {\r\n    if (text == null) return this.node.textContent + (this.dom.newLined ? '\\n' : '')\r\n\r\n    if (typeof text === 'function') {\r\n      this.clear().build(true)\r\n      text.call(this, this)\r\n      this.build(false)\r\n    } else {\r\n      this.plain(text)\r\n    }\r\n\r\n    return this\r\n  }\r\n\r\n}\r\n\r\nextend(Tspan, textable)\r\n\r\nregisterMethods({\r\n  Tspan: {\r\n    tspan: wrapWithAttrCheck(function (text = '') {\r\n      const tspan = new Tspan()\r\n\r\n      // clear if build mode is disabled\r\n      if (!this._build) {\r\n        this.clear()\r\n      }\r\n\r\n      // add new tspan\r\n      return this.put(tspan).text(text)\r\n    })\r\n  },\r\n  Text: {\r\n    newLine: function (text = '') {\r\n      return this.tspan(text).newLine()\r\n    }\r\n  }\r\n})\r\n\r\nregister(Tspan, 'Tspan')\r\n","import { cx, cy, height, width, x, y } from '../modules/core/circled.js'\r\nimport {\r\n  extend,\r\n  nodeOrNew,\r\n  register,\r\n  wrapWithAttrCheck\r\n} from '../utils/adopter.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport SVGNumber from '../types/SVGNumber.js'\r\nimport Shape from './Shape.js'\r\n\r\nexport default class Circle extends Shape {\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('circle', node), attrs)\r\n  }\r\n\r\n  radius (r) {\r\n    return this.attr('r', r)\r\n  }\r\n\r\n  // Radius x value\r\n  rx (rx) {\r\n    return this.attr('r', rx)\r\n  }\r\n\r\n  // Alias radius x value\r\n  ry (ry) {\r\n    return this.rx(ry)\r\n  }\r\n\r\n  size (size) {\r\n    return this.radius(new SVGNumber(size).divide(2))\r\n  }\r\n}\r\n\r\nextend(Circle, { x, y, cx, cy, width, height })\r\n\r\nregisterMethods({\r\n  Container: {\r\n    // Create circle element\r\n    circle: wrapWithAttrCheck(function (size = 0) {\r\n      return this.put(new Circle())\r\n        .size(size)\r\n        .move(0, 0)\r\n    })\r\n  }\r\n})\r\n\r\nregister(Circle, 'Circle')\r\n","import { nodeOrNew, register, wrapWithAttrCheck } from '../utils/adopter.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport Container from './Container.js'\r\nimport baseFind from '../modules/core/selector.js'\r\n\r\nexport default class ClipPath extends Container {\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('clipPath', node), attrs)\r\n  }\r\n\r\n  // Unclip all clipped elements and remove itself\r\n  remove () {\r\n    // unclip all targets\r\n    this.targets().forEach(function (el) {\r\n      el.unclip()\r\n    })\r\n\r\n    // remove clipPath from parent\r\n    return super.remove()\r\n  }\r\n\r\n  targets () {\r\n    return baseFind('svg [clip-path*=\"' + this.id() + '\"]')\r\n  }\r\n}\r\n\r\nregisterMethods({\r\n  Container: {\r\n    // Create clipping element\r\n    clip: wrapWithAttrCheck(function () {\r\n      return this.defs().put(new ClipPath())\r\n    })\r\n  },\r\n  Element: {\r\n    // Distribute clipPath to svg element\r\n    clipper () {\r\n      return this.reference('clip-path')\r\n    },\r\n\r\n    clipWith (element) {\r\n      // use given clip or create a new one\r\n      const clipper = element instanceof ClipPath\r\n        ? element\r\n        : this.parent().clip().add(element)\r\n\r\n      // apply mask\r\n      return this.attr('clip-path', 'url(\"#' + clipper.id() + '\")')\r\n    },\r\n\r\n    // Unclip element\r\n    unclip () {\r\n      return this.attr('clip-path', null)\r\n    }\r\n  }\r\n})\r\n\r\nregister(ClipPath, 'ClipPath')\r\n","import { nodeOrNew, register, wrapWithAttrCheck } from '../utils/adopter.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport Element from './Element.js'\r\n\r\nexport default class ForeignObject extends Element {\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('foreignObject', node), attrs)\r\n  }\r\n}\r\n\r\nregisterMethods({\r\n  Container: {\r\n    foreignObject: wrapWithAttrCheck(function (width, height) {\r\n      return this.put(new ForeignObject()).size(width, height)\r\n    })\r\n  }\r\n})\r\n\r\nregister(ForeignObject, 'ForeignObject')\r\n","import Matrix from '../../types/Matrix.js'\nimport Point from '../../types/Point.js'\nimport { proportionalSize } from '../../utils/utils.js'\n\nexport function dmove (dx, dy) {\n  this.children().forEach((child, i) => {\n\n    let bbox\n\n    // We have to wrap this for elements that dont have a bbox\n    // e.g. title and other descriptive elements\n    try {\n      // Get the childs bbox\n      bbox = child.bbox()\n    } catch (e) {\n      return\n    }\n\n    // Get childs matrix\n    const m = new Matrix(child)\n    // Translate childs matrix by amount and\n    // transform it back into parents space\n    const matrix = m.translate(dx, dy).transform(m.inverse())\n    // Calculate new x and y from old box\n    const p = new Point(bbox.x, bbox.y).transform(matrix)\n    // Move element\n    child.move(p.x, p.y)\n  })\n\n  return this\n}\n\nexport function dx (dx) {\n  return this.dmove(dx, 0)\n}\n\nexport function dy (dy) {\n  return this.dmove(0, dy)\n}\n\nexport function height (height, box = this.bbox()) {\n  if (height == null) return box.height\n  return this.size(box.width, height, box)\n}\n\nexport function move (x = 0, y = 0, box = this.bbox()) {\n  const dx = x - box.x\n  const dy = y - box.y\n\n  return this.dmove(dx, dy)\n}\n\nexport function size (width, height, box = this.bbox()) {\n  const p = proportionalSize(this, width, height, box)\n  const scaleX = p.width / box.width\n  const scaleY = p.height / box.height\n\n  this.children().forEach((child, i) => {\n    const o = new Point(box).transform(new Matrix(child).inverse())\n    child.scale(scaleX, scaleY, o.x, o.y)\n  })\n\n  return this\n}\n\nexport function width (width, box = this.bbox()) {\n  if (width == null) return box.width\n  return this.size(width, box.height, box)\n}\n\nexport function x (x, box = this.bbox()) {\n  if (x == null) return box.x\n  return this.move(x, box.y, box)\n}\n\nexport function y (y, box = this.bbox()) {\n  if (y == null) return box.y\n  return this.move(box.x, y, box)\n}\n","import { nodeOrNew, register, wrapWithAttrCheck, extend } from '../utils/adopter.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport Container from './Container.js'\r\nimport * as containerGeometry from '../modules/core/containerGeometry.js'\r\n\r\nexport default class G extends Container {\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('g', node), attrs)\r\n  }\r\n}\r\n\r\nextend(G, containerGeometry)\r\n\r\nregisterMethods({\r\n  Container: {\r\n    // Create a group element\r\n    group: wrapWithAttrCheck(function () {\r\n      return this.put(new G())\r\n    })\r\n  }\r\n})\r\n\r\nregister(G, 'G')\r\n","import { nodeOrNew, register, wrapWithAttrCheck, extend } from '../utils/adopter.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport { xlink } from '../modules/core/namespaces.js'\r\nimport Container from './Container.js'\r\nimport * as containerGeometry from '../modules/core/containerGeometry.js'\r\n\r\nexport default class A extends Container {\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('a', node), attrs)\r\n  }\r\n\r\n  // Link target attribute\r\n  target (target) {\r\n    return this.attr('target', target)\r\n  }\r\n\r\n  // Link url\r\n  to (url) {\r\n    return this.attr('href', url, xlink)\r\n  }\r\n\r\n}\r\n\r\nextend(A, containerGeometry)\r\n\r\nregisterMethods({\r\n  Container: {\r\n    // Create a hyperlink element\r\n    link: wrapWithAttrCheck(function (url) {\r\n      return this.put(new A()).to(url)\r\n    })\r\n  },\r\n  Element: {\r\n    unlink () {\r\n      const link = this.linker()\r\n\r\n      if (!link) return this\r\n\r\n      const parent = link.parent()\r\n\r\n      if (!parent) {\r\n        return this.remove()\r\n      }\r\n\r\n      const index = parent.index(link)\r\n      parent.add(this, index)\r\n\r\n      link.remove()\r\n      return this\r\n    },\r\n    linkTo (url) {\r\n      // reuse old link if possible\r\n      let link = this.linker()\r\n\r\n      if (!link) {\r\n        link = new A()\r\n        this.wrap(link)\r\n      }\r\n\r\n      if (typeof url === 'function') {\r\n        url.call(link, link)\r\n      } else {\r\n        link.to(url)\r\n      }\r\n\r\n      return this\r\n    },\r\n    linker () {\r\n      const link = this.parent()\r\n      if (link && link.node.nodeName.toLowerCase() === 'a') {\r\n        return link\r\n      }\r\n\r\n      return null\r\n    }\r\n  }\r\n})\r\n\r\nregister(A, 'A')\r\n","import { nodeOrNew, register, wrapWithAttrCheck } from '../utils/adopter.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport Container from './Container.js'\r\nimport baseFind from '../modules/core/selector.js'\r\n\r\nexport default class Mask extends Container {\r\n  // Initialize node\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('mask', node), attrs)\r\n  }\r\n\r\n  // Unmask all masked elements and remove itself\r\n  remove () {\r\n    // unmask all targets\r\n    this.targets().forEach(function (el) {\r\n      el.unmask()\r\n    })\r\n\r\n    // remove mask from parent\r\n    return super.remove()\r\n  }\r\n\r\n  targets () {\r\n    return baseFind('svg [mask*=\"' + this.id() + '\"]')\r\n  }\r\n}\r\n\r\nregisterMethods({\r\n  Container: {\r\n    mask: wrapWithAttrCheck(function () {\r\n      return this.defs().put(new Mask())\r\n    })\r\n  },\r\n  Element: {\r\n    // Distribute mask to svg element\r\n    masker () {\r\n      return this.reference('mask')\r\n    },\r\n\r\n    maskWith (element) {\r\n      // use given mask or create a new one\r\n      const masker = element instanceof Mask\r\n        ? element\r\n        : this.parent().mask().add(element)\r\n\r\n      // apply mask\r\n      return this.attr('mask', 'url(\"#' + masker.id() + '\")')\r\n    },\r\n\r\n    // Unmask element\r\n    unmask () {\r\n      return this.attr('mask', null)\r\n    }\r\n  }\r\n})\r\n\r\nregister(Mask, 'Mask')\r\n","import { nodeOrNew, register } from '../utils/adopter.js'\r\nimport Element from './Element.js'\r\nimport SVGNumber from '../types/SVGNumber.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\n\r\nexport default class Stop extends Element {\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('stop', node), attrs)\r\n  }\r\n\r\n  // add color stops\r\n  update (o) {\r\n    if (typeof o === 'number' || o instanceof SVGNumber) {\r\n      o = {\r\n        offset: arguments[0],\r\n        color: arguments[1],\r\n        opacity: arguments[2]\r\n      }\r\n    }\r\n\r\n    // set attributes\r\n    if (o.opacity != null) this.attr('stop-opacity', o.opacity)\r\n    if (o.color != null) this.attr('stop-color', o.color)\r\n    if (o.offset != null) this.attr('offset', new SVGNumber(o.offset))\r\n\r\n    return this\r\n  }\r\n}\r\n\r\nregisterMethods({\r\n  Gradient: {\r\n    // Add a color stop\r\n    stop: function (offset, color, opacity) {\r\n      return this.put(new Stop()).update(offset, color, opacity)\r\n    }\r\n  }\r\n})\r\n\r\nregister(Stop, 'Stop')\r\n","import { nodeOrNew, register } from '../utils/adopter.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport { unCamelCase } from '../utils/utils.js'\r\nimport Element from './Element.js'\r\n\r\nfunction cssRule (selector, rule) {\r\n  if (!selector) return ''\r\n  if (!rule) return selector\r\n\r\n  let ret = selector + '{'\r\n\r\n  for (const i in rule) {\r\n    ret += unCamelCase(i) + ':' + rule[i] + ';'\r\n  }\r\n\r\n  ret += '}'\r\n\r\n  return ret\r\n}\r\n\r\nexport default class Style extends Element {\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('style', node), attrs)\r\n  }\r\n\r\n  addText (w = '') {\r\n    this.node.textContent += w\r\n    return this\r\n  }\r\n\r\n  font (name, src, params = {}) {\r\n    return this.rule('@font-face', {\r\n      fontFamily: name,\r\n      src: src,\r\n      ...params\r\n    })\r\n  }\r\n\r\n  rule (selector, obj) {\r\n    return this.addText(cssRule(selector, obj))\r\n  }\r\n}\r\n\r\nregisterMethods('Dom', {\r\n  style (selector, obj) {\r\n    return this.put(new Style()).rule(selector, obj)\r\n  },\r\n  fontface  (name, src, params) {\r\n    return this.put(new Style()).font(name, src, params)\r\n  }\r\n})\r\n\r\nregister(Style, 'Style')\r\n","import { nodeOrNew, register, wrapWithAttrCheck } from '../utils/adopter.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport { xlink } from '../modules/core/namespaces.js'\r\nimport Path from './Path.js'\r\nimport PathArray from '../types/PathArray.js'\r\nimport Text from './Text.js'\r\nimport baseFind from '../modules/core/selector.js'\r\n\r\nexport default class TextPath extends Text {\r\n  // Initialize node\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('textPath', node), attrs)\r\n  }\r\n\r\n  // return the array of the path track element\r\n  array () {\r\n    const track = this.track()\r\n\r\n    return track ? track.array() : null\r\n  }\r\n\r\n  // Plot path if any\r\n  plot (d) {\r\n    const track = this.track()\r\n    let pathArray = null\r\n\r\n    if (track) {\r\n      pathArray = track.plot(d)\r\n    }\r\n\r\n    return (d == null) ? pathArray : this\r\n  }\r\n\r\n  // Get the path element\r\n  track () {\r\n    return this.reference('href')\r\n  }\r\n}\r\n\r\nregisterMethods({\r\n  Container: {\r\n    textPath: wrapWithAttrCheck(function (text, path) {\r\n      // Convert text to instance if needed\r\n      if (!(text instanceof Text)) {\r\n        text = this.text(text)\r\n      }\r\n\r\n      return text.path(path)\r\n    })\r\n  },\r\n  Text: {\r\n    // Create path for text to run on\r\n    path: wrapWithAttrCheck(function (track, importNodes = true) {\r\n      const textPath = new TextPath()\r\n\r\n      // if track is a path, reuse it\r\n      if (!(track instanceof Path)) {\r\n        // create path element\r\n        track = this.defs().path(track)\r\n      }\r\n\r\n      // link textPath to path and add content\r\n      textPath.attr('href', '#' + track, xlink)\r\n\r\n      // Transplant all nodes from text to textPath\r\n      let node\r\n      if (importNodes) {\r\n        while ((node = this.node.firstChild)) {\r\n          textPath.node.appendChild(node)\r\n        }\r\n      }\r\n\r\n      // add textPath element as child node and return textPath\r\n      return this.put(textPath)\r\n    }),\r\n\r\n    // Get the textPath children\r\n    textPath () {\r\n      return this.findOne('textPath')\r\n    }\r\n  },\r\n  Path: {\r\n    // creates a textPath from this path\r\n    text: wrapWithAttrCheck(function (text) {\r\n      // Convert text to instance if needed\r\n      if (!(text instanceof Text)) {\r\n        text = new Text().addTo(this.parent()).text(text)\r\n      }\r\n\r\n      // Create textPath from text and path and return\r\n      return text.path(this)\r\n    }),\r\n\r\n    targets () {\r\n      return baseFind('svg textPath').filter((node) => {\r\n        return (node.attr('href') || '').includes(this.id())\r\n      })\r\n\r\n      // Does not work in IE11. Use when IE support is dropped\r\n      // return baseFind('svg textPath[*|href*=\"' + this.id() + '\"]')\r\n    }\r\n  }\r\n})\r\n\r\nTextPath.prototype.MorphArray = PathArray\r\nregister(TextPath, 'TextPath')\r\n","import { nodeOrNew, register, wrapWithAttrCheck } from '../utils/adopter.js'\r\nimport { registerMethods } from '../utils/methods.js'\r\nimport { xlink } from '../modules/core/namespaces.js'\r\nimport Shape from './Shape.js'\r\n\r\nexport default class Use extends Shape {\r\n  constructor (node, attrs = node) {\r\n    super(nodeOrNew('use', node), attrs)\r\n  }\r\n\r\n  // Use element as a reference\r\n  use (element, file) {\r\n    // Set lined element\r\n    return this.attr('href', (file || '') + '#' + element, xlink)\r\n  }\r\n}\r\n\r\nregisterMethods({\r\n  Container: {\r\n    // Create a use element\r\n    use: wrapWithAttrCheck(function (element, file) {\r\n      return this.put(new Use()).use(element, file)\r\n    })\r\n  }\r\n})\r\n\r\nregister(Use, 'Use')\r\n","/* Optional Modules */\r\nimport './modules/optional/arrange.js'\r\nimport './modules/optional/class.js'\r\nimport './modules/optional/css.js'\r\nimport './modules/optional/data.js'\r\nimport './modules/optional/memory.js'\r\nimport './modules/optional/sugar.js'\r\nimport './modules/optional/transform.js'\r\n\r\nimport { extend, makeInstance } from './utils/adopter.js'\r\nimport { getMethodNames, getMethodsFor } from './utils/methods.js'\r\nimport Box from './types/Box.js'\r\nimport Color from './types/Color.js'\r\nimport Container from './elements/Container.js'\r\nimport Defs from './elements/Defs.js'\r\nimport Dom from './elements/Dom.js'\r\nimport Element from './elements/Element.js'\r\nimport Ellipse from './elements/Ellipse.js'\r\nimport EventTarget from './types/EventTarget.js'\r\nimport Fragment from './elements/Fragment.js'\r\nimport Gradient from './elements/Gradient.js'\r\nimport Image from './elements/Image.js'\r\nimport Line from './elements/Line.js'\r\nimport List from './types/List.js'\r\nimport Marker from './elements/Marker.js'\r\nimport Matrix from './types/Matrix.js'\r\nimport Morphable, {\r\n  NonMorphable,\r\n  ObjectBag,\r\n  TransformBag,\r\n  makeMorphable,\r\n  registerMorphableType\r\n} from './animation/Morphable.js'\r\nimport Path from './elements/Path.js'\r\nimport PathArray from './types/PathArray.js'\r\nimport Pattern from './elements/Pattern.js'\r\nimport PointArray from './types/PointArray.js'\r\nimport Point from './types/Point.js'\r\nimport Polygon from './elements/Polygon.js'\r\nimport Polyline from './elements/Polyline.js'\r\nimport Rect from './elements/Rect.js'\r\nimport Runner from './animation/Runner.js'\r\nimport SVGArray from './types/SVGArray.js'\r\nimport SVGNumber from './types/SVGNumber.js'\r\nimport Shape from './elements/Shape.js'\r\nimport Svg from './elements/Svg.js'\r\nimport Symbol from './elements/Symbol.js'\r\nimport Text from './elements/Text.js'\r\nimport Tspan from './elements/Tspan.js'\r\nimport * as defaults from './modules/core/defaults.js'\r\nimport * as utils from './utils/utils.js'\r\nimport * as namespaces from './modules/core/namespaces.js'\r\nimport * as regex from './modules/core/regex.js'\r\n\r\nexport {\r\n  Morphable,\r\n  registerMorphableType,\r\n  makeMorphable,\r\n  TransformBag,\r\n  ObjectBag,\r\n  NonMorphable\r\n}\r\n\r\nexport { defaults, utils, namespaces, regex }\r\nexport const SVG = makeInstance\r\nexport { default as parser } from './modules/core/parser.js'\r\nexport { default as find } from './modules/core/selector.js'\r\nexport * from './modules/core/event.js'\r\nexport * from './utils/adopter.js'\r\nexport {\r\n  getWindow,\r\n  registerWindow,\r\n  restoreWindow,\r\n  saveWindow,\r\n  withWindow\r\n} from './utils/window.js'\r\n\r\n/* Animation Modules */\r\nexport { default as Animator } from './animation/Animator.js'\r\nexport { Controller, Ease, PID, Spring, easing } from './animation/Controller.js'\r\nexport { default as Queue } from './animation/Queue.js'\r\nexport { default as Runner } from './animation/Runner.js'\r\nexport { default as Timeline } from './animation/Timeline.js'\r\n\r\n/* Types */\r\nexport { default as Array } from './types/SVGArray.js'\r\nexport { default as Box } from './types/Box.js'\r\nexport { default as Color } from './types/Color.js'\r\nexport { default as EventTarget } from './types/EventTarget.js'\r\nexport { default as Matrix } from './types/Matrix.js'\r\nexport { default as Number } from './types/SVGNumber.js'\r\nexport { default as PathArray } from './types/PathArray.js'\r\nexport { default as Point } from './types/Point.js'\r\nexport { default as PointArray } from './types/PointArray.js'\r\nexport { default as List } from './types/List.js'\r\n\r\n/* Elements */\r\nexport { default as Circle } from './elements/Circle.js'\r\nexport { default as ClipPath } from './elements/ClipPath.js'\r\nexport { default as Container } from './elements/Container.js'\r\nexport { default as Defs } from './elements/Defs.js'\r\nexport { default as Dom } from './elements/Dom.js'\r\nexport { default as Element } from './elements/Element.js'\r\nexport { default as Ellipse } from './elements/Ellipse.js'\r\nexport { default as ForeignObject } from './elements/ForeignObject.js'\r\nexport { default as Fragment } from './elements/Fragment.js'\r\nexport { default as Gradient } from './elements/Gradient.js'\r\nexport { default as G } from './elements/G.js'\r\nexport { default as A } from './elements/A.js'\r\nexport { default as Image } from './elements/Image.js'\r\nexport { default as Line } from './elements/Line.js'\r\nexport { default as Marker } from './elements/Marker.js'\r\nexport { default as Mask } from './elements/Mask.js'\r\nexport { default as Path } from './elements/Path.js'\r\nexport { default as Pattern } from './elements/Pattern.js'\r\nexport { default as Polygon } from './elements/Polygon.js'\r\nexport { default as Polyline } from './elements/Polyline.js'\r\nexport { default as Rect } from './elements/Rect.js'\r\nexport { default as Shape } from './elements/Shape.js'\r\nexport { default as Stop } from './elements/Stop.js'\r\nexport { default as Style } from './elements/Style.js'\r\nexport { default as Svg } from './elements/Svg.js'\r\nexport { default as Symbol } from './elements/Symbol.js'\r\nexport { default as Text } from './elements/Text.js'\r\nexport { default as TextPath } from './elements/TextPath.js'\r\nexport { default as Tspan } from './elements/Tspan.js'\r\nexport { default as Use } from './elements/Use.js'\r\n\r\nextend([\r\n  Svg,\r\n  Symbol,\r\n  Image,\r\n  Pattern,\r\n  Marker\r\n], getMethodsFor('viewbox'))\r\n\r\nextend([\r\n  Line,\r\n  Polyline,\r\n  Polygon,\r\n  Path\r\n], getMethodsFor('marker'))\r\n\r\nextend(Text, getMethodsFor('Text'))\r\nextend(Path, getMethodsFor('Path'))\r\n\r\nextend(Defs, getMethodsFor('Defs'))\r\n\r\nextend([\r\n  Text,\r\n  Tspan\r\n], getMethodsFor('Tspan'))\r\n\r\nextend([\r\n  Rect,\r\n  Ellipse,\r\n  Gradient,\r\n  Runner\r\n], getMethodsFor('radius'))\r\n\r\nextend(EventTarget, getMethodsFor('EventTarget'))\r\nextend(Dom, getMethodsFor('Dom'))\r\nextend(Element, getMethodsFor('Element'))\r\nextend(Shape, getMethodsFor('Shape'))\r\nextend([ Container, Fragment ], getMethodsFor('Container'))\r\nextend(Gradient, getMethodsFor('Gradient'))\r\n\r\nextend(Runner, getMethodsFor('Runner'))\r\n\r\nList.extend(getMethodNames())\r\n\r\nregisterMorphableType([\r\n  SVGNumber,\r\n  Color,\r\n  Box,\r\n  Matrix,\r\n  SVGArray,\r\n  PointArray,\r\n  PathArray,\r\n  Point\r\n])\r\n\r\nmakeMorphable()\r\n","import {SVG_NAMESPACE} from '@recogito/annotorious/src/util/SVG';\nimport {SVG} from '@svgdotjs/svg.js';\n\n/**\n * Draws an SVG circle, either from an annotation, or an\n * (cx, cy, r)-tuple.\n */\n\nexport const drawPin = (x, y) => {\n  const g = document.createElementNS(SVG_NAMESPACE, 'g');\n\n  const outerPin = SVG()\n    .path(\n      'M356.36,202.77c-3.45,201.59-303.3,201.56-306.72,0C53.09,1.19,352.94,1.22,356.36,202.77Z',\n    )\n    .attr('class', 'a9s-outer')\n    .stroke({color: 'white', width: 1.5})\n    .size(47)\n    .move(x, y);\n  outerPin.move(x - outerPin.width() / 4, y - outerPin.height());\n\n  const innerPin = SVG()\n    .path(\n      'M 4637 -4760.267 C 4127.9 -4704.567 3574.7 -4479.767 3142.4 -4155.167 C 2235.7 -3477.067 1761.2 -2259.167 1982.1 -1177.567 C 2070.5 -747.267 2220.3 -407.267 2794.7 676.233 C 3207.7 1458.133 4250.8 3525.133 4758 4568.233 C 4882.9 4825.633 4992.4 5029.233 5000.1 5019.633 C 5007.8 5011.933 5215.3 4593.133 5461.1 4091.733 C 5997.1 2994.833 6623.3 1767.333 7074.8 931.633 C 7687.6 -203.667 7885.5 -632.067 7985.3 -1037.367 C 8102.5 -1519.567 8100.6 -1961.367 7977.6 -2451.267 C 7599.2 -3955.367 6187.3 -4933.167 4637 -4760.267 Z M 5240.2 -3744.067 C 5722.4 -3684.467 6150.8 -3467.467 6488.9 -3110.167 C 7111.3 -2451.267 7226.6 -1467.667 6773.2 -683.967 C 6300.6 126.733 5328.6 518.633 4431.4 257.433 C 3766.7 65.333 3225 -474.467 3032.9 -1137.267 C 2890.7 -1630.967 2936.9 -2155.367 3167.4 -2622.267 C 3369.1 -3035.267 3755.2 -3404.167 4172.1 -3584.667 C 4523.7 -3736.367 4873.3 -3788.267 5240.2 -3744.067 Z',\n    )\n    .attr('class', 'a9s-inner') \n    .attr('data-type', 'pinpoint')\n    .attr('data-position', `xywh=pixel:${x},${y},47,56`)\n    .size(47)\n    .move(x, y);\n    \n  innerPin.move(x - innerPin.width() / 4, y - innerPin.height());\n  \n  flatten(outerPin.node, 100); \n  flatten(innerPin.node, 500);\n  g.appendChild(outerPin.node); \n  g.appendChild(innerPin.node);\n\n  return g;\n};\n\nexport const setPinSize = (g, cx, cy, r) => {\n  const innerPath = g.querySelector('.a9s-inner');\n  const outerPath = g.querySelector('.a9s-outer');\n\n  const innerPathData = SVG(innerPath).move(cx, cy);\n  const outerPathData = SVG(outerPath).move(cx, cy);\n\n  innerPath.setAttribute('d', innerPathData.node.getAttribute('d'));\n\n  outerPath.setAttribute('d', outerPathData.node.getAttribute('d'));\n};\n\n/**\n * Flattens paths that contain curves into points\n * @param {*} path\n * @param {*} num total number of points to create.\n * higher results is smoother shapes but increases the size\n */\nexport const flatten = (path, num) => {\n  var l = path.getTotalLength();\n  var p = path.getPointAtLength(0);\n  var d = `M${p.x} ${p.y}`;\n  for (var i = l / num; i <= l; i += l / num) {\n    p = path.getPointAtLength(i);\n    d += `L${p.x} ${p.y}`;\n  }\n  path.setAttribute('d', d + 'z');\n};\n","import {Selection} from '@recogito/annotorious/src/tools/Tool';\nimport {toSVGTarget} from '@recogito/annotorious/src/selectors/EmbeddedSVG';\nimport {SVG_NAMESPACE} from '@recogito/annotorious/src/util/SVG';\nimport {drawPin, setPinSize} from './Pin';\n\n/**\n * A 'rubberband' selection tool for creating a circle by\n * clicking and dragging.\n */\nexport default class Pinpoint {\n  constructor(anchorX, anchorY, g, env) {\n    this.anchor = [anchorX, anchorY];\n\n    this.env = env;\n\n    this.group = document.createElementNS(SVG_NAMESPACE, 'g');\n\n    this.pinpoint = drawPin(anchorX, anchorY);\n    this.pinpoint.setAttribute('class', 'a9s-selection');\n\n    // We make the selection transparent to\n    // pointer events because it would interfere with the\n    // rendered annotations' mouseleave/enter events\n    this.group.style.pointerEvents = 'none';\n\n    // Additionally, selection remains hidden until\n    // the user actually moves the mouse\n    this.group.style.display = 'none';\n\n    this.group.appendChild(this.pinpoint);\n\n    g.appendChild(this.group);\n  }\n\n  get element() {\n    return this.pinpoint;\n  }\n\n  dragTo = (oppositeX, oppositeY) => {\n    const {naturalWidth, naturalHeight} = this.env.image;\n\n    // Make visible\n    this.group.style.display = null;\n\n    const w = oppositeX - this.anchor[0];\n    const h = oppositeY - this.anchor[1];\n    const r = Math.max(1, Math.pow(w ** 2 + h ** 2, 0.5) / 2);\n\n    const cx = this.anchor[0] + w / 2;\n    const cy = this.anchor[1] + h / 2;\n\n    if (\n      cx - r < 0 ||\n      cx + r > naturalWidth ||\n      cy - r < 0 ||\n      cy + r > naturalHeight\n    )\n      return;\n\n    setPinSize(this.pinpoint, cx, cy, r);\n    this.anchor = [cx, cy];\n  };\n\n  getBoundingClientRect = () => this.pinpoint.getBoundingClientRect();\n\n  toSelection = () => {\n    return new Selection({\n      ...toSVGTarget(this.group, this.env.image),\n      renderedVia: {\n        name: 'pinpoint',\n      },\n      body: [\n        {\n          purpose: 'position',\n          value: `xywh=pixel:${this.anchor[0]},${this.anchor[1]},47,56`,\n        },\n      ],\n    });\n  };\n\n  destroy = () => {\n    this.group.parentNode.removeChild(this.group);\n\n    this.pinpoint = null;\n    this.group = null;\n  };\n}","import { addClass, SVG_NAMESPACE } from './SVG';\n\nconst isFirefox = /firefox/i.test(navigator.userAgent);\n\nconst formatSvgEl = (svgEl, x, y, w, h) => {\n  svgEl.setAttribute('width', w);\n  svgEl.setAttribute('height', h);\n\n  // Argh - Firefox produces broken SVG bounds for nested SVG\n  if (isFirefox) {\n    svgEl.setAttribute('x', 0);\n    svgEl.setAttribute('y', 0);\n    svgEl.setAttribute('transform', `translate(${x}, ${y})`);  \n  } else {\n    svgEl.setAttribute('x', x);\n    svgEl.setAttribute('y', y);\n  }\n}\n\nconst appendFormatterEl = (formatterEl, shape) => {\n  const { x, y, width, height } = shape.getBBox();\n\n  const svgEl = document.createElementNS(SVG_NAMESPACE, 'svg');\n  svgEl.setAttribute('class', 'a9s-formatter-el');\n\n  formatSvgEl(svgEl, x, y, width, height);\n\n  const g = document.createElementNS(SVG_NAMESPACE, 'g');\n  g.appendChild(formatterEl);y\n\n  svgEl.appendChild(g);\n  \n  shape.append(svgEl);\n}\n\n/**\n * A formatter is a user-defined function that takes an annotation as input,\n * and returns either a string, or an object. If a string is returned, this\n * will be appended to the annotation element CSS class list. Otherwise, the\n * object can have the following properties: \n * \n * - 'className' added to the CSS class list\n * - 'data-*' added as data attributes\n * - 'style' a list of CSS styles (in the form of a string) \n */\nexport const format = (shape, annotation, formatters) => {\n  // The formatter can be undefined\n  if (!formatters)\n    return shape;\n\n  // Merge outputs from all formatter functions into one object\n  const format = formatters.reduce((merged, fn) => {\n    const format = fn(annotation);\n\n    if (!format)\n      return merged;\n\n    if (typeof format === 'string' || format instanceof String) {\n      merged.className = merged.className ? `${merged.className} ${format}` : format; \n    } else if (format.nodeType === Node.ELEMENT_NODE) {\n      merged.elements = merged.elements ? [...merged.elements, format] : [format];\n    } else {\n      const { className, style, element } = format;\n\n      if (className)\n        merged.className = merged.className ? `${merged.className} ${className}` : className;\n\n      if (style)\n        merged.style = merged.style ? `${merged.style} ${style}` : style;\n\n      if (element)\n        merged.elements = merged.elements ? [...merged.elements, element] : [element];\n    }\n\n    // Copy data attributes\n    for (const key in format) {\n      if (format.hasOwnProperty(key) && key.startsWith('data-')) {\n        merged[key] = format[key];\n      }\n    }\n\n    return merged;\n  }, {});\n\n  const { className, style, elements } = format;\n\n  if (className)\n    addClass(shape, className);\n\n  if (style) {\n    const outer = shape.querySelector('.a9s-outer');\n    const inner = shape.querySelector('.a9s-inner');\n\n    if (outer && inner) {\n      outer.setAttribute('style', 'display:none');\n      inner.setAttribute('style', style);\n    } else {\n      shape.setAttribute('style', style);\n    }\n  }\n\n  if (elements)\n    elements.forEach(el => appendFormatterEl(el, shape));\n\n  for (const key in format) {\n    if (format.hasOwnProperty(key) && key.startsWith('data-')) {\n      shape.setAttribute(key, format[key]);\n    }\n  }\n}\n\nexport const setFormatterElSize = (group, x, y, w, h) => {\n  const formatterEl = group.querySelector('.a9s-formatter-el');\n  if (formatterEl)\n    formatSvgEl(formatterEl, x, y, w, h);\n}","import EditableShape from '@recogito/annotorious/src/tools/EditableShape';\nimport {\n  drawEmbeddedSVG,\n  svgFragmentToShape,\n  toSVGTarget,\n} from '@recogito/annotorious/src/selectors/EmbeddedSVG';\nimport { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\nimport {\n  format,\n  setFormatterElSize,\n} from '@recogito/annotorious/src/util/Formatting';\n\nimport { drawPin } from './Pin';\n// TODO optional: mask to dim the outside area\n//import Mask from './FreehandMask';\n\nconst getPoints = (shape) => {\n  const pointList = shape.getAttribute('d').split('L');\n  const points = [];\n  if (pointList.length > 0) {\n    var point = pointList[0].substring(1).trim().split(' ');\n    points.push({ x: parseFloat(point[0]), y: parseFloat(point[1]) });\n\n    for (let i = 1; i < pointList.length; i++) {\n      var point = pointList[i].trim().split(' ');\n      points.push({ x: parseFloat(point[0]), y: parseFloat(point[1]) });\n    }\n  }\n\n  return points;\n};\n\nconst getBBox = (shape) => {\n  return shape.querySelector('.a9s-inner').getBBox();\n};\n\n/**\n * An editable freehand drawing.\n */\nexport default class EditablePinpoint extends EditableShape {\n  constructor(annotation, g, config, env) {\n    super(annotation, g, config, env);\n\n    this.svg.addEventListener('mousemove', this.onMouseMove);\n    this.svg.addEventListener('mouseup', this.onMouseUp);\n\n    // 'g' for the editable free drawing compound shape\n    this.containerGroup = document.createElementNS(SVG_NAMESPACE, 'g');\n    const position = null; // this.getAnnotationPosition(annotation);\n\n    if (position) {\n      this.shape = drawPin(position.x, position.y);\n    } else {\n      this.shape = drawEmbeddedSVG(annotation);\n    }\n\n    // TODO optional: mask to dim the outside area\n    // this.mask = new Mask(env.image, this.shape.querySelector('.a9s-inner'));\n\n    // this.containerGroup.appendChild(this.mask.element);\n\n    this.elementGroup = document.createElementNS(SVG_NAMESPACE, 'g');\n    this.elementGroup.setAttribute('class', 'a9s-annotation editable selected');\n    this.elementGroup.appendChild(this.shape);\n\n    this.containerGroup.appendChild(this.elementGroup);\n    g.appendChild(this.containerGroup);\n\n    format(this.shape, annotation, config.formatter);\n\n    this.shape\n      .querySelector('.a9s-inner')\n      .addEventListener('mousedown', this.onGrab(this.shape));\n\n    // The grabbed element (handle or entire shape), if any\n    this.grabbedElem = null;\n\n    // Mouse grab point\n    this.grabbedAt = null;\n  }\n\n  setPoints = (points) => {\n    // Not using .toFixed(1) because that will ALWAYS\n    // return one decimal, e.g. \"15.0\" (when we want \"15\")\n    const round = (num) => Math.round(10 * num) / 10;\n\n    var str = points.map((pt) => `L${round(pt.x)} ${round(pt.y)}`).join(' ');\n    str = 'M' + str.substring(1);\n\n    const inner = this.shape.querySelector('.a9s-inner');\n    inner.setAttribute('d', str);\n\n    const outer = this.shape.querySelector('.a9s-outer');\n    outer.setAttribute('d', str);\n\n    const { x, y, width, height } = outer.getBBox();\n\n    setFormatterElSize(this.elementGroup, x, y, width, height);\n  };\n\n  // TODO optional: handles to stretch the shape\n  /*  stretchCorners = (draggedHandleIdx, anchorHandle, mousePos) => {\n    const anchor = this.getHandleXY(anchorHandle);\n  }*/\n\n  onGrab = (grabbedElem) => (evt) => {\n    this.grabbedElem = grabbedElem;\n    const pos = this.getSVGPoint(evt);\n    this.grabbedAt = { x: pos.x, y: pos.y };\n  };\n\n  onMouseMove = (evt) => {\n    const constrain = (coord, delta, max) =>\n      coord + delta < 0 ? -coord : coord + delta > max ? max - coord : delta;\n\n    if (this.grabbedElem) {\n      const pos = this.getSVGPoint(evt);\n\n      const { x, y, width, height } = getBBox(this.shape);\n\n      if (this.grabbedElem === this.shape) {\n        const { naturalWidth, naturalHeight } = this.env.image;\n\n        const dx = constrain(x, pos.x - this.grabbedAt.x, naturalWidth - width);\n        const dy = constrain(\n          y,\n          pos.y - this.grabbedAt.y,\n          naturalHeight - height\n        );\n\n        const inner = this.shape.querySelector('.a9s-inner');\n        const updatedPoints = getPoints(inner).map((pt) => ({\n          x: pt.x + dx,\n          y: pt.y + dy,\n        }));\n\n        this.grabbedAt = pos;\n\n        this.setPoints(updatedPoints);\n\n        this.emit('update', toSVGTarget(this.shape, this.env.image));\n      }\n    }\n  };\n\n  onMouseUp = (evt) => {\n    this.grabbedElem = null;\n    this.grabbedAt = null;\n    // this.emit('update', toSVGTarget(this.shape, this.env.image));\n  };\n\n  get element() {\n    return this.elementGroup;\n  }\n\n  updateState = (annotation) => {\n    const points = getPoints(svgFragmentToShape(annotation));\n    this.setPoints(points);\n  };\n\n  destroy = () => {\n    this.containerGroup.parentNode.removeChild(this.containerGroup);\n    super.destroy();\n  };\n\n  getAnnotationPosition = (annotation) => {\n    const position = annotation.targets\n      ?.find((t) => t.renderedVia?.name === 'pinpoint')\n      ?.body?.find((b) => b.purpose === 'position');\n\n    if (position) {\n      const { value } = position;\n      const format = value.includes(':')\n        ? value.substring(value.indexOf('=') + 1, value.indexOf(':'))\n        : 'pixel';\n      const coords = value.includes(':')\n        ? value.substring(value.indexOf(':') + 1)\n        : value.substring(value.indexOf('=') + 1);\n\n      let [x, y, w, h] = coords.split(',').map(parseFloat);\n\n      if (format.toLowerCase() === 'percent') {\n        x = (x * this.env.image.naturalWidth) / 100;\n        y = (y * this.env.image.naturalHeight) / 100;\n        w = (w * this.env.image.naturalWidth) / 100;\n        h = (h * this.env.image.naturalHeight) / 100;\n      }\n\n      return { x, y, w, h };\n    }\n    return null;\n  };\n}\n","import Tool from '@recogito/annotorious/src/tools/Tool';\nimport Pinpoint from './Pinpoint';\nimport EditablePinpoint from './EditablePinpoint';\n\n/**\n * A rubberband selector for circle selections.\n */\nexport default class PinpointTool extends Tool {\n  constructor(g, config, env) {\n    super(g, config, env);\n\n    this.pinpoint = null;\n  }\n\n  startDrawing = (x, y, _, evt) => {\n    // The top-most existing annotation at this position (if any)\n    const annotation = evt.target.closest('.a9s-annotation')?.annotation;\n    if (!annotation) {\n      this.pinpoint = new Pinpoint(x, y, this.g, this.env);\n      // Emit the SVG shape with selection attached\n      const {element} = this.pinpoint;\n      element.annotation = this.pinpoint.toSelection();\n      element.body = [\n        {\n          purpose: 'position',\n          value: `xywh=pixel:${x},${y},47,56`,\n        },\n      ];\n      // Emit the completed shape...\n      this.emit('complete', element);\n      //this.stop();\n    } else {\n      this.emit('cancel');\n    }\n  };\n\n  stop = () => {\n    if (this.pinpoint) {\n      this.pinpoint.destroy();\n      this.pinpoint = null;\n    }\n  };\n\n  onMouseMove = (x, y) => {\n    this.pinpoint.dragTo(x, y);\n  };\n\n  get isDrawing() {\n    return this.pinpoint != null;\n  }\n\n  createEditableShape = (annotation) => {\n    return new EditablePinpoint(annotation, this.g, this.config, this.env);\n  };\n}\n\nPinpointTool.identifier = 'pinpoint';\n\nPinpointTool.supports = (annotation) => {\n  // const selector = annotation.selector('SvgSelector');\n  // if (selector) {\n  //   return (\n  //     selector.value?.match(/^<svg.*(<path)/g) &&\n  //     annotation.renderedVia === 'pinpoint'\n  //   );\n  // }\n  return false;\n};\n","import { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\n\n/** Shorthand to apply the given (x, y, r) to the SVG shape **/\nconst setXYR = (shape, x, y, r) => {  \n  shape.setAttribute('cx', x);\n  shape.setAttribute('cy', y);\n  shape.setAttribute('r', r);\n}\n\n/** \n * Draws an SVG circle, either from an annotation, or an\n * (cx, cy, r)-tuple.\n */\nexport const drawCircle = (cx, cy, r) => {\n  const g = document.createElementNS(SVG_NAMESPACE, 'g');\n  const outerCircle  = document.createElementNS(SVG_NAMESPACE, 'circle');\n  const innerCircle  = document.createElementNS(SVG_NAMESPACE, 'circle');\n\n  innerCircle.setAttribute('class', 'a9s-inner');\n  setXYR(innerCircle, cx, cy, r);\n\n  outerCircle.setAttribute('class', 'a9s-outer');\n  setXYR(outerCircle, cx, cy, r);\n\n  g.appendChild(outerCircle);\n  g.appendChild(innerCircle);\n\n  return g;\n}\n\nexport const setCircleSize = (g, cx, cy, r) => {\n  const innerCircle = g.querySelector('.a9s-inner');\n  const outerCircle = g.querySelector('.a9s-outer');\n  \n  setXYR(innerCircle, cx, cy, r);\n  setXYR(outerCircle, cx, cy, r);\n}\n\nexport const getCircleSize = g => {\n  const outerCircle = g.querySelector('.a9s-outer');\n\n  const cx = parseFloat(outerCircle.getAttribute('cx'));\n  const cy = parseFloat(outerCircle.getAttribute('cy'));\n  const r = parseFloat(outerCircle.getAttribute('r'));\n  \n  return { cx, cy, r };\n}","import { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\nimport { getCircleSize } from './Circle';\n\nexport default class CircleMask {\n\n  constructor(imageDimensions, circle) {\n    this.w = imageDimensions.naturalWidth;\n    this.h = imageDimensions.naturalHeight;\n\n    this.circle = circle;\n\n    const { cx, cy, r } = getCircleSize(this.circle);\n    const tx = ((cx + r) > this.w) ? this.w - r : cx;\n    const ty = ((cy + r) > this.h) ? this.h - r : cy + r;\n\n    this.mask = document.createElementNS(SVG_NAMESPACE, 'path');\n    this.mask.setAttribute('fill-rule', 'evenodd');    \n    this.mask.setAttribute('class', 'a9s-selection-mask');\n\n    this.mask.setAttribute('d', `M0 0 h${this.w} v${this.h} h-${this.w} z M${tx} ${ty} a ${r} ${r} 0 1 1 1 0`);\n  }\n\n  redraw = () => {\n    const { cx, cy, r } = getCircleSize(this.circle);\n\n    const tx = ((cx + r) > this.w) ? this.w - r : cx;\n    const ty = ((cy + r) > this.h) ? this.h - r : cy + r;\n\n    this.mask.setAttribute('d', `M0 0 h${this.w} v${this.h} h-${this.w} z M${tx} ${ty} a ${r} ${r} 0 1 1 1 0`);\n  }\n\n  get element() {\n    return this.mask;\n  }\n\n  destroy = () =>\n    this.mask.parentNode.removeChild(this.mask)\n\n}","import { Selection } from '@recogito/annotorious/src/tools/Tool';\nimport { toSVGTarget } from '@recogito/annotorious/src/selectors/EmbeddedSVG';\nimport { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\nimport { drawCircle, setCircleSize } from './Circle';\nimport Mask from './CircleMask';\n\n/**\n * A 'rubberband' selection tool for creating a circle by\n * clicking and dragging.\n */\nexport default class RubberbandCircle {\n\n  constructor(anchorX, anchorY, g, env) {\n    this.anchor = [ anchorX, anchorY ];\n\n    this.env = env;\n\n    this.group = document.createElementNS(SVG_NAMESPACE, 'g');\n\n    this.circle = drawCircle(anchorX, anchorY, 2);\n    this.circle.setAttribute('class', 'a9s-selection');\n\n    this.mask = new Mask(env.image, this.circle);\n\n    // We make the selection transparent to \n    // pointer events because it would interfere with the \n    // rendered annotations' mouseleave/enter events\n    this.group.style.pointerEvents = 'none';\n\n    // Additionally, selection remains hidden until \n    // the user actually moves the mouse\n    this.group.style.display = 'none';\n\n    this.group.appendChild(this.mask.element);\n    this.group.appendChild(this.circle);\n\n    g.appendChild(this.group);\n  }\n\n  get element() {\n    return this.circle;\n  }\n\n  dragTo = (oppositeX, oppositeY) => {\n    const { naturalWidth, naturalHeight } = this.env.image;\n\n    // Make visible\n    this.group.style.display = null;\n\n    const w = oppositeX - this.anchor[0];\n    const h = oppositeY - this.anchor[1];\n    const r = Math.max(1, Math.pow(w ** 2 + h ** 2, 0.5) / 2);\n\n    const cx = this.anchor[0] + w / 2;\n    const cy = this.anchor[1] + h / 2;\n\n    if ((cx-r < 0 || cx + r > naturalWidth) || (cy-r < 0 || cy + r > naturalHeight)) return;\n    \n    setCircleSize(this.circle, cx, cy, r);\n    this.mask.redraw();\n  }\n\n  getBoundingClientRect = () => \n    this.circle.getBoundingClientRect();\n\n  toSelection = () => {\n    return new Selection(toSVGTarget(this.group, this.env.image));\n  }\n\n  destroy = () => {\n    this.group.parentNode.removeChild(this.group);\n\n    this.mask = null;\n    this.circle = null;\n    this.group = null;\n  }\n\n}","import EditableShape from '@recogito/annotorious/src/tools/EditableShape';\nimport { drawEmbeddedSVG, svgFragmentToShape, toSVGTarget } from '@recogito/annotorious/src/selectors/EmbeddedSVG';\nimport { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\nimport { format, setFormatterElSize } from '@recogito/annotorious/src/util/Formatting';\nimport { getCircleSize, setCircleSize } from './Circle';\nimport Mask from './CircleMask';\n\n/**\n * An editable circle shape.\n */\nexport default class EditableCircle extends EditableShape {\n\n  constructor(annotation, g, config, env) {\n    super(annotation, g, config, env);\n\n    this.svg.addEventListener('mousemove', this.onMouseMove);\n    this.svg.addEventListener('mouseup', this.onMouseUp);\n\n    // SVG markup for this class looks like this:\n    // \n    // <g>\n    //   <path class=\"a9s-selection mask\"... />\n    //   <g> <-- return this node as .element\n    //     <circle class=\"a9s-outer\" ... />\n    //     <circle class=\"a9s-inner\" ... />\n    //     <g class=\"a9s-handle\" ...> ... </g>\n    //     <g class=\"a9s-handle\" ...> ... </g>\n    //     <g class=\"a9s-handle\" ...> ... </g>\n    //     <g class=\"a9s-handle\" ...> ... </g>\n    //   </g> \n    // </g>\n\n    // 'g' for the editable circle compound shape\n    this.containerGroup = document.createElementNS(SVG_NAMESPACE, 'g');\n\n    this.circle = drawEmbeddedSVG(annotation);\n    this.circle.querySelector('.a9s-inner')\n      .addEventListener('mousedown', this.onGrab(this.circle));\n\n    this.mask = new Mask(env.image, this.circle);\n\n    this.containerGroup.appendChild(this.mask.element);\n\n    // The 'element' = circle + handles\n    this.elementGroup = document.createElementNS(SVG_NAMESPACE, 'g');\n    this.elementGroup.setAttribute('class', 'a9s-annotation editable selected');\n    this.elementGroup.appendChild(this.circle);    \n\n    const { cx, cy, r } = getCircleSize(this.circle);\n\n    this.handles = [\n      [ cx, cy - r ],\n      [ cx + r, cy ],\n      [ cx, cy + r ],\n      [ cx - r, cy ]\n    ].map(t => { \n      const [ x, y ] = t;\n      const handle = this.drawHandle(x, y);\n\n      handle.addEventListener('mousedown', this.onGrab(handle));\n      this.elementGroup.appendChild(handle);\n\n      return handle;\n    });\n\n    this.containerGroup.appendChild(this.elementGroup);\n    g.appendChild(this.containerGroup);\n\n    format(this.circle, annotation, config.formatter);\n\n    // The grabbed element (handle or entire group), if any\n    this.grabbedElem = null; \n\n    // Mouse xy offset inside the shape, if mouse pressed\n    this.grabbedAt = null;\n  }\n\n  setSize = (cx, cy, r) => {\n    setCircleSize(this.circle, cx, cy, r);\n    this.mask.redraw();\n    setFormatterElSize(this.elementGroup, cx, cy, r, r);\n\n    const [ topleft, topright, bottomright, bottomleft] = this.handles;\n    this.setHandleXY(topleft, cx, cy - r);\n    this.setHandleXY(topright, cx + r, cy);\n    this.setHandleXY(bottomright, cx, cy + r);\n    this.setHandleXY(bottomleft, cx - r, cy);\n  }\n\n  stretchCorners = (draggedHandleIdx, anchorHandle, mousePos) => {\n    const anchor = this.getHandleXY(anchorHandle);\n\n    var mouseX = mousePos.x;\n    var mouseY = mousePos.y;\n    var width = 0;\n    var height = 0;\n    var r;\n    if (draggedHandleIdx == 0 || draggedHandleIdx == 2) {\n      mouseX = anchor.x;\n      height = mouseY - anchor.y;\n      r = Math.abs(height) / 2;\n    } else {\n      mouseY = anchor.y;\n      width = mouseX - anchor.x;\n      r = Math.abs(width) / 2;\n    }\n\n    const x = width > 0 ? anchor.x : mouseX;\n    const y = height > 0 ? anchor.y : mouseY;\n    const w = Math.abs(width);\n    const h = Math.abs(height);\n    const cx = x + w/2;\n    const cy = y + h/2;\n\n    setCircleSize(this.circle, cx, cy, r);\n    this.mask.redraw();\n    setFormatterElSize(this.elementGroup, cx, cy, r, r);\n\n    if (draggedHandleIdx == 0 || draggedHandleIdx == 2) {\n      var idx0 = 0;\n      var idx2 = 2;\n      if(draggedHandleIdx == 0 && height > 0 || draggedHandleIdx == 2 && height < 0) {\n        idx0 = 2;\n        idx2 = 0;\n      }\n      this.setHandleXY(this.handles[idx0], cx, cy - r);\n      this.setHandleXY(this.handles[idx2], cx, cy + r);\n      this.setHandleXY(this.handles[1], cx + r, cy);\n      this.setHandleXY(this.handles[3], cx - r, cy);\n    } else {\n      var idx3 = 3;\n      var idx1 = 1;\n      if (draggedHandleIdx == 1 && width > 0 || draggedHandleIdx == 3 && width < 0) {\n        idx3 = 1;\n        idx1 = 3;\n      }\n      this.setHandleXY(this.handles[idx3], cx + r, cy);\n      this.setHandleXY(this.handles[idx1], cx - r, cy);\n      this.setHandleXY(this.handles[0], cx, cy - r);\n      this.setHandleXY(this.handles[2], cx, cy + r);\n    }\n  }\n\n  onGrab = grabbedElem => evt => {\n    this.grabbedElem = grabbedElem; \n    \n    const pos = this.getSVGPoint(evt);\n    const { cx, cy } = getCircleSize(this.circle);\n    \n    this.grabbedAt = { x: pos.x - cx, y: pos.y - cy };\n  }\n\n  onMouseMove = evt => {\n    const constrain = (coord, max) =>\n      coord < 0 ? 0 : ( coord > max ? max : coord);\n\n    if (this.grabbedElem) {\n      const pos = this.getSVGPoint(evt);\n\n      if (this.grabbedElem === this.circle) {\n        const { r } = getCircleSize(this.circle);\n\n        const { naturalWidth, naturalHeight } = this.env.image;\n\n        const cx = Math.max(constrain(pos.x - this.grabbedAt.x, naturalWidth - r), r);\n        const cy = Math.max(constrain(pos.y - this.grabbedAt.y, naturalHeight - r), r);\n\n        this.setSize(cx, cy, r); \n        this.emit('update', toSVGTarget(this.circle, this.env.image)); \n      } else {\n        // Mouse position replaces one of the corner coords, depending\n        // on which handle is the grabbed element\n        const handleIdx = this.handles.indexOf(this.grabbedElem);\n        const oppositeHandle = handleIdx < 2 ? \n          this.handles[handleIdx + 2] : this.handles[handleIdx - 2];\n\n        this.stretchCorners(handleIdx, oppositeHandle, pos);\n        this.emit('update', toSVGTarget(this.circle, this.env.image));\n      }\n    }\n  }\n\n  onMouseUp = () => {\n    this.grabbedElem = null;\n    this.grabbedAt = null;\n  }\n\n  onScaleChanged = scale =>\n    this.handles.map(this.scaleHandle);\n\n  get element() { \n    return this.elementGroup; \n  }\n\n  updateState = annotation => {\n    const shape = svgFragmentToShape(annotation);\n\n    const cx = parseFloat(shape.getAttribute('cx'));\n    const cy = parseFloat(shape.getAttribute('cy'));\n    const r =  parseFloat(shape.getAttribute('r'));\n\n    this.setSize(cx, cy, r);\n  }\n\n  destroy() {\n    this.containerGroup.parentNode.removeChild(this.containerGroup);\n    super.destroy();\n  }\n\n}\n","import Tool from '@recogito/annotorious/src/tools/Tool';\nimport RubberbandCircle from './RubberbandCircle';\nimport EditableCircle from './EditableCircle';\n\n/**\n * A rubberband selector for circle selections.\n */\nexport default class RubberbandCircleTool extends Tool {\n\n  constructor(g, config, env) {\n    super(g, config, env);\n\n    this.rubberband = null;\n  }\n\n  startDrawing = (x, y) => {\n    this.attachListeners({\n      mouseMove: this.onMouseMove,\n      mouseUp: this.onMouseUp\n    });\n\n    this.rubberband = new RubberbandCircle(x, y, this.g, this.env);\n  }\n\n  stop = () => {\n    if (this.rubberband) {\n      this.rubberband.destroy();\n      this.rubberband = null;\n    }\n  }\n\n  onMouseMove = (x, y) =>\n    this.rubberband.dragTo(x, y);\n  \n  onMouseUp = () => {\n    this.detachListeners();\n    this.started = false;\n\n    const { width, height } = this.rubberband.getBoundingClientRect();\n\n    const minWidth = this.config.minSelectionWidth || 4;\n    const minHeight = this.config.minSelectionHeight || 4;\n\n    if (width >= minWidth && height >= minHeight) {\n      // Emit the SVG shape with selection attached    \n      const { element } = this.rubberband;\n      element.annotation = this.rubberband.toSelection();\n\n      // Emit the completed shape...\n      this.emit('complete', element);\n    } else {\n      this.emit('cancel');\n    }\n\n    this.stop();\n  }\n\n  get isDrawing() {\n    return this.rubberband != null;\n  }\n  \n  createEditableShape = annotation =>\n    new EditableCircle(annotation, this.g, this.config, this.env);\n\n}\n\nRubberbandCircleTool.identifier = 'circle';\n\nRubberbandCircleTool.supports = annotation => {\n  const selector = annotation.selector('SvgSelector');\n  if (selector)\n    return selector.value?.match(/^<svg.*<circle/g);\n}","import { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\n\n/** Shorthand to apply the given (x, y, rx, ry) to the SVG shape **/\nconst setXYR = (shape, x, y, rx, ry) => {  \n  shape.setAttribute('cx', x);\n  shape.setAttribute('cy', y);\n  shape.setAttribute('rx', rx);\n  shape.setAttribute('ry', ry);\n}\n\n/** \n * Draws an SVG ellipse, either from an annotation, or an\n * (cx, cy, rx, ry)-tuple.\n */\nexport const drawEllipse = (cx, cy, rx, ry) => {\n  const g = document.createElementNS(SVG_NAMESPACE, 'g');\n  const innerEllipse  = document.createElementNS(SVG_NAMESPACE, 'ellipse');\n  const outerEllipse  = document.createElementNS(SVG_NAMESPACE, 'ellipse');\n\n  innerEllipse.setAttribute('class', 'a9s-inner');\n  setXYR(innerEllipse, cx, cy, rx, ry);\n\n  outerEllipse.setAttribute('class', 'a9s-outer');\n  setXYR(outerEllipse, cx, cy, rx, ry);\n\n  g.appendChild(outerEllipse);\n  g.appendChild(innerEllipse);\n\n  return g;\n}\n\nexport const setEllipseSize = (g, cx, cy, rx, ry) => {\n  const innerEllipse = g.querySelector('.a9s-inner');\n  const outerEllipse = g.querySelector('.a9s-outer');\n\n  setXYR(innerEllipse, cx, cy, rx, ry);\n  setXYR(outerEllipse, cx, cy, rx, ry);\n}\n\nexport const getEllipseSize = g => {\n  const outerEllipse = g.querySelector('.a9s-outer');\n\n  const cx = parseFloat(outerEllipse.getAttribute('cx'));\n  const cy = parseFloat(outerEllipse.getAttribute('cy'));\n  const rx = parseFloat(outerEllipse.getAttribute('rx'));\n  const ry = parseFloat(outerEllipse.getAttribute('ry'));\n  \n  return { cx, cy, rx, ry };\n}","import { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\nimport { getEllipseSize } from './Ellipse';\n\nexport default class EllipseMask {\n\n  constructor(imageDimensions, ellipse) {\n    this.w = imageDimensions.naturalWidth;\n    this.h = imageDimensions.naturalHeight;\n\n    this.ellipse = ellipse;\n\n    const { cx, cy, rx, ry } = getEllipseSize(this.ellipse);\n\n    const ty = cy + ry;\n\n    this.mask = document.createElementNS(SVG_NAMESPACE, 'path');\n    this.mask.setAttribute('fill-rule', 'evenodd');    \n    this.mask.setAttribute('class', 'a9s-selection-mask');\n\n    this.mask.setAttribute('d', `M0 0 h${this.w} v${this.h} h-${this.w} z M${cx} ${ty} a ${rx} ${ry} 0 1 1 1 0`);\n  }\n\n  redraw = () => {\n    const { cx, cy, rx, ry } = getEllipseSize(this.ellipse);\n\n    const ty = cy + ry;\n\n    this.mask.setAttribute('d', `M0 0 h${this.w} v${this.h} h-${this.w} z M${cx} ${ty} a ${rx} ${ry} 0 1 1 1 0`);\n  }\n\n  get element() {\n    return this.mask;\n  }\n\n  destroy = () =>\n    this.mask.parentNode.removeChild(this.mask)\n\n}","import { Selection } from '@recogito/annotorious/src/tools/Tool';\nimport { toSVGTarget } from '@recogito/annotorious/src/selectors/EmbeddedSVG';\nimport { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\nimport { drawEllipse, setEllipseSize } from './Ellipse';\nimport Mask from './EllipseMask';\n\n/**\n * A 'rubberband' selection tool for creating a ellipse by\n * clicking and dragging.\n */\nexport default class RubberbandEllipse {\n\n  constructor(anchorX, anchorY, g, env) {\n    this.anchor = [ anchorX, anchorY ];\n\n    this.env = env;\n\n    this.group = document.createElementNS(SVG_NAMESPACE, 'g');\n\n    this.ellipse = drawEllipse(anchorX, anchorY, 2);\n    this.ellipse.setAttribute('class', 'a9s-selection');\n\n    this.mask = new Mask(env.image, this.ellipse);\n\n    // We make the selection transparent to \n    // pointer events because it would interfere with the \n    // rendered annotations' mouseleave/enter events\n    this.group.style.pointerEvents = 'none';\n\n    // Additionally, selection remains hidden until \n    // the user actually moves the mouse\n    this.group.style.display = 'none';\n\n    this.group.appendChild(this.mask.element);\n    this.group.appendChild(this.ellipse);\n\n    g.appendChild(this.group);\n  }\n\n  get element() {\n    return this.ellipse;\n  }\n\n  dragTo = (oppositeX, oppositeY) => {\n    // Make visible\n    this.group.style.display = null;\n\n    const w = oppositeX - this.anchor[0];\n    const h = oppositeY - this.anchor[1];\n\n    const cx = w > 0 ? this.anchor[0] + w / 2 : oppositeX + w / 2;\n    const cy = h > 0 ? this.anchor[1] + h / 2 : oppositeY + h / 2;\n\n    const rx = Math.abs(w / 2);\n    const ry = Math.abs(h / 2);\n\n    setEllipseSize(this.ellipse, cx, cy, rx, ry);\n    this.mask.redraw();\n  }\n\n  getBoundingClientRect = () => \n    this.ellipse.getBoundingClientRect();\n\n  toSelection = () => {\n    return new Selection(toSVGTarget(this.group, this.env.image));\n  }\n\n  destroy = () => {\n    this.group.parentNode.removeChild(this.group);\n\n    this.mask = null;\n    this.ellipse = null;\n    this.group = null;\n  }\n\n}","import EditableShape from '@recogito/annotorious/src/tools/EditableShape';\nimport { drawEmbeddedSVG, svgFragmentToShape, toSVGTarget } from '@recogito/annotorious/src/selectors/EmbeddedSVG';\nimport { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\nimport { format, setFormatterElSize } from '@recogito/annotorious/src/util/Formatting';\nimport { getEllipseSize, setEllipseSize } from './Ellipse';\nimport Mask from './EllipseMask';\n\n/**\n * An editable ellipse shape.\n */\nexport default class EditableEllipse extends EditableShape {\n\n  constructor(annotation, g, config, env) {\n    super(annotation, g, config, env);\n\n    this.svg.addEventListener('mousemove', this.onMouseMove);\n    this.svg.addEventListener('mouseup', this.onMouseUp);\n\n    // SVG markup for this class looks like this:\n    // \n    // <g>\n    //   <path class=\"a9s-selection mask\"... />\n    //   <g> <-- return this node as .element\n    //     <ellipse class=\"a9s-outer\" ... />\n    //     <g class=\"a9s-handle\" ...> ... </g>\n    //     <g class=\"a9s-handle\" ...> ... </g>\n    //     <g class=\"a9s-handle\" ...> ... </g>\n    //     <g class=\"a9s-handle\" ...> ... </g>\n    //   </g> \n    // </g>\n\n    // 'g' for the editable ellipse compound shape\n    this.containerGroup = document.createElementNS(SVG_NAMESPACE, 'g');\n\n    this.ellipse = drawEmbeddedSVG(annotation);\n    this.ellipse.querySelector('.a9s-inner')\n      .addEventListener('mousedown', this.onGrab(this.ellipse));\n\n    this.mask = new Mask(env.image, this.ellipse);\n\n    this.containerGroup.appendChild(this.mask.element);\n\n    // The 'element' = ellipse + handles\n    this.elementGroup = document.createElementNS(SVG_NAMESPACE, 'g');\n    this.elementGroup.setAttribute('class', 'a9s-annotation editable selected');\n    this.elementGroup.appendChild(this.ellipse);    \n\n    const { cx, cy, rx, ry } = getEllipseSize(this.ellipse);\n\n    this.handles = [\n      [ cx, cy - ry ],\n      [ cx + rx, cy ],\n      [ cx, cy + ry ],\n      [ cx - rx, cy ]\n    ].map(t => { \n      const [ x, y ] = t;\n      const handle = this.drawHandle(x, y);\n\n      handle.addEventListener('mousedown', this.onGrab(handle));\n      this.elementGroup.appendChild(handle);\n\n      return handle;\n    });\n\n    this.containerGroup.appendChild(this.elementGroup);\n    g.appendChild(this.containerGroup);\n\n    format(this.ellipse, annotation, config.formatter);\n\n    // The grabbed element (handle or entire group), if any\n    this.grabbedElem = null; \n\n    // Mouse xy offset inside the shape, if mouse pressed\n    this.grabbedAt = null;\n  }\n\n  setSize = (cx, cy, rx, ry) => {\n    setEllipseSize(this.ellipse, cx, cy, rx, ry);\n    this.mask.redraw();\n    setFormatterElSize(this.elementGroup, cx, cy, rx, ry);\n\n    const [ topleft, topright, bottomright, bottomleft] = this.handles;\n    this.setHandleXY(topleft, cx, cy - ry);\n    this.setHandleXY(topright, cx + rx, cy);\n    this.setHandleXY(bottomright, cx, cy + ry);\n    this.setHandleXY(bottomleft, cx - rx, cy);\n  }\n\n  stretchCorners = (draggedHandleIdx, anchorHandle, leftHandle, mousePos) => {\n    const anchor = this.getHandleXY(anchorHandle);\n    const anchorLeft = this.getHandleXY(leftHandle);\n\n    var mouseX = mousePos.x;\n    var mouseY = mousePos.y;\n    var rx = 0;\n    var ry = 0;\n    if(draggedHandleIdx == 0 || draggedHandleIdx == 2) {\n      mouseX = anchor.x;\n    } else {\n      mouseY = anchor.y;\n    }\n\n    const width = mouseX - anchor.x;\n    const height = mouseY - anchor.y;\n    const x = width > 0 ? anchor.x : mouseX;\n    const y = height > 0 ? anchor.y : mouseY;\n    const w = Math.abs(width);\n    const h = Math.abs(height);\n    const cx = x + w/2;\n    const cy = y + h/2;\n    var rx = w/2;\n    var ry = h/2;\n    if(draggedHandleIdx == 0 || draggedHandleIdx == 2) {\n      rx = Math.abs(anchor.x - anchorLeft.x);\n    } else {\n      ry = Math.abs(anchor.y - anchorLeft.y);\n    }\n\n    setEllipseSize(this.ellipse, cx, cy, rx, ry);\n    this.mask.redraw();\n    setFormatterElSize(this.elementGroup, cx, cy, rx, ry);\n\n    if (draggedHandleIdx == 0 || draggedHandleIdx == 2) {\n      var idx0 = 0;\n      var idx2 = 2;\n      if(draggedHandleIdx == 0 && height > 0 || draggedHandleIdx == 2 && height < 0) {\n        idx0 = 2;\n        idx2 = 0;\n      }\n      this.setHandleXY(this.handles[idx0], cx, cy - ry);\n      this.setHandleXY(this.handles[idx2], cx, cy + ry);\n      this.setHandleXY(this.handles[1], cx + rx, cy);\n      this.setHandleXY(this.handles[3], cx - rx, cy);\n    } else {\n      var idx3 = 3;\n      var idx1 = 1;\n      if (draggedHandleIdx == 1 && width > 0 || draggedHandleIdx == 3 && width < 0) {\n        idx3 = 1;\n        idx1 = 3;\n      }\n      this.setHandleXY(this.handles[idx3], cx + rx, cy);\n      this.setHandleXY(this.handles[idx1], cx - rx, cy);\n      this.setHandleXY(this.handles[0], cx, cy - ry);\n      this.setHandleXY(this.handles[2], cx, cy + ry);\n    }\n  }\n\n  onGrab = grabbedElem => evt => {\n    this.grabbedElem = grabbedElem; \n\n    const pos = this.getSVGPoint(evt);\n    const { cx, cy } = getEllipseSize(this.ellipse);\n\n    this.grabbedAt = { x: pos.x - cx, y: pos.y - cy };\n  }\n\n  onMouseMove = evt => {\n    const constrain = (coord, max) =>\n      coord < 0 ? 0 : ( coord > max ? max : coord);\n\n    if (this.grabbedElem) {\n      const pos = this.getSVGPoint(evt);\n\n      if (this.grabbedElem === this.ellipse) {\n        const { rx, ry } = getEllipseSize(this.ellipse);\n\n        const { naturalWidth, naturalHeight } = this.env.image;\n\n        const cx = constrain(pos.x - this.grabbedAt.x, naturalWidth - rx);\n        const cy = constrain(pos.y - this.grabbedAt.y, naturalHeight - ry);\n\n        this.setSize(cx, cy, rx, ry); \n        this.emit('update', toSVGTarget(this.ellipse, this.env.image));\n      } else {\n        // Mouse position replaces one of the corner coords, depending\n        // on which handle is the grabbed element\n        const handleIdx = this.handles.indexOf(this.grabbedElem);\n        const oppositeHandle = handleIdx < 2 ? \n          this.handles[handleIdx + 2] : this.handles[handleIdx - 2];\n        const leftHandle = this.handles[(handleIdx + 3) % 4];\n\n        this.stretchCorners(handleIdx, oppositeHandle, leftHandle, pos);\n        this.emit('update', toSVGTarget(this.ellipse, this.env.image));\n      }\n    }\n  }\n\n  onMouseUp = () => {\n    this.grabbedElem = null;\n    this.grabbedAt = null;\n  }\n\n  onScaleChanged = scale =>\n    this.handles.map(this.scaleHandle);\n\n  get element() { \n    return this.elementGroup; \n  }\n\n  updateState = annotation => {\n    const shape = svgFragmentToShape(annotation);\n\n    const cx = parseFloat(shape.getAttribute('cx'));\n    const cy = parseFloat(shape.getAttribute('cy'));\n    const rx = parseFloat(shape.getAttribute('rx'));\n    const ry = parseFloat(shape.getAttribute('ry'));\n    \n    this.setSize(cx, cy, rx, ry);\n  }\n\n  destroy() {\n    this.containerGroup.parentNode.removeChild(this.containerGroup);\n    super.destroy();\n  }\n\n}","import Tool from '@recogito/annotorious/src/tools/Tool';\nimport RubberbandEllipse from './RubberbandEllipse';\nimport EditableEllipse from './EditableEllipse';\n\n/**\n * A rubberband selector for ellipse selections.\n */\nexport default class RubberbandEllipseTool extends Tool {\n\n  constructor(g, config, env) {\n    super(g, config, env);\n\n    this.rubberband = null;\n  }\n\n  startDrawing = (x, y) => {\n    this.attachListeners({\n      mouseMove: this.onMouseMove,\n      mouseUp: this.onMouseUp\n    });\n\n    this.rubberband = new RubberbandEllipse(x, y, this.g, this.env);\n  }\n\n  stop = () => {\n    if (this.rubberband) {\n      this.rubberband.destroy();\n      this.rubberband = null;\n    }\n  }\n\n  onMouseMove = (x, y) =>\n    this.rubberband.dragTo(x, y);\n  \n  onMouseUp = () => {\n    this.detachListeners();\n    this.started = false;\n\n    const { width, height } = this.rubberband.getBoundingClientRect();\n\n    const minWidth = this.config.minSelectionWidth || 4;\n    const minHeight = this.config.minSelectionHeight || 4;\n\n    if (width >= minWidth && height >= minHeight) {\n      // Emit the SVG shape with selection attached    \n      const { element } = this.rubberband;\n      element.annotation = this.rubberband.toSelection();\n\n      // Emit the completed shape...\n      this.emit('complete', element);\n    } else {\n      this.emit('cancel');\n    }\n\n    this.stop();\n  }\n\n  get isDrawing() {\n    return this.rubberband != null;\n  }\n  \n  createEditableShape = annotation =>\n    new EditableEllipse(annotation, this.g, this.config, this.env);\n\n}\n\nRubberbandEllipseTool.identifier = 'ellipse';\n\nRubberbandEllipseTool.supports = annotation => {\n  const selector = annotation.selector('SvgSelector');\n  if (selector)\n    return selector.value?.match(/^<svg.*<ellipse/g);\n}","import { Selection } from '@recogito/annotorious/src/tools/Tool';\nimport { toSVGTarget } from '@recogito/annotorious/src/selectors/EmbeddedSVG';\nimport { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\n// TODO optional: mask to dim the outside area\n//import Mask from './FreehandMask';\n\n/**\n * A 'rubberband' selection tool for creating freehand drawing by\n * clicking and dragging.\n */\nexport default class RubberbandFreehand {\n\n  constructor(anchor, g, env) {\n    this.points = [ anchor ];\n\n    this.env = env;\n\n    this.group = document.createElementNS(SVG_NAMESPACE, 'g');\n\n    this.freehand = document.createElementNS(SVG_NAMESPACE, 'g');\n    this.freehand.setAttribute('class', 'a9s-selection');\n\n    this.outer = document.createElementNS(SVG_NAMESPACE, 'path');\n    this.outer.setAttribute('class', 'a9s-outer');\n\n    this.inner = document.createElementNS(SVG_NAMESPACE, 'path');\n    this.inner.setAttribute('class', 'a9s-inner');\n\n    this.setPoints(this.points);\n\n   // TODO optional: mask to dim the outside area\n   // this.mask = new Mask(env.image, this.inner);\n\n    this.freehand.appendChild(this.outer);\n    this.freehand.appendChild(this.inner);\n\n    // Additionally, selection remains hidden until \n    // the user actually moves the mouse\n    this.group.style.display = 'none';\n\n   // TODO optional: mask to dim the outside area\n   // this.group.appendChild(this.mask.element);\n    this.group.appendChild(this.freehand);\n\n    g.appendChild(this.group);\n  }\n\n  setPoints = points => {\n    var str = points.map(pt => `L${pt[0]} ${pt[1]}`).join(' ');\n    str = 'M' + str.substring(1);\n    this.outer.setAttribute('d', str);\n    this.inner.setAttribute('d', str);\n  }\n\n  getBoundingClientRect = () =>\n    this.outer.getBoundingClientRect();\n\n  dragTo = xy => {\n    // Make visible\n    this.group.style.display = null;\n\n    //TODO optional: edge smoothing\n\n    this.addPoint(xy);\n\n   // TODO optional: mask to dim the outside area\n   // this.mask.redraw();\n  }\n\n  addPoint = xy => {\n    this.points = [ ...this.points, xy ];\n    this.setPoints(this.points);   \n   // TODO optional: mask to dim the outside area\n   // this.mask.redraw();\n  }\n\n  get element() {\n    return this.freehand;\n  }\n\n  destroy = () => {\n    this.group.parentNode.removeChild(this.group);\n    this.freehand = null;    \n    this.group = null;\n  }\n\n  toSelection = () => {\n    return new Selection(toSVGTarget(this.group, this.env.image));\n  }\n\n}\n","import EditableShape from '@recogito/annotorious/src/tools/EditableShape';\nimport { drawEmbeddedSVG, svgFragmentToShape, toSVGTarget } from '@recogito/annotorious/src/selectors/EmbeddedSVG';\nimport { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\nimport { format, setFormatterElSize } from '@recogito/annotorious/src/util/Formatting';\n// TODO optional: mask to dim the outside area\n//import Mask from './FreehandMask';\n\nconst getPoints = shape => {\n  const pointList = shape.getAttribute('d').split('L');\n  const points = [];\n  if(pointList.length > 0) {\n    var point = pointList[0].substring(1).trim().split(' ');\n    points.push({ x: parseFloat(point[0]), y: parseFloat(point[1]) });\n\n    for (let i = 1; i < pointList.length; i++) {\n      var point = pointList[i].trim().split(' ');\n      points.push({ x: parseFloat(point[0]), y: parseFloat(point[1]) });\n    }\n  }\n\n  return points;\n}\n\nconst getBBox = shape => {\n  return shape.querySelector('.a9s-inner').getBBox();\n}\n\n/**\n * An editable freehand drawing.\n */\nexport default class EditableFreehand extends EditableShape {\n\n  constructor(annotation, g, config, env) {\n    super(annotation, g, config, env);\n\n    this.svg.addEventListener('mousemove', this.onMouseMove);\n    this.svg.addEventListener('mouseup', this.onMouseUp);\n\n    // SVG markup for this class looks like this:\n    // \n    // <g>\n    //   <path class=\"a9s-selection mask\"... />\n    //   <g> <-- return this node as .element\n    //     <polygon class=\"a9s-outer\" ... />\n    //     <polygon class=\"a9s-inner\" ... />\n    //     <g class=\"a9s-handle\" ...> ... </g>\n    //     <g class=\"a9s-handle\" ...> ... </g>\n    //     <g class=\"a9s-handle\" ...> ... </g>\n    //     ...\n    //   </g> \n    // </g>\n\n    // 'g' for the editable free drawing compound shape\n    this.containerGroup = document.createElementNS(SVG_NAMESPACE, 'g');\n\n    this.shape = drawEmbeddedSVG(annotation);\n\n   // TODO optional: mask to dim the outside area\n   // this.mask = new Mask(env.image, this.shape.querySelector('.a9s-inner'));\n    \n   // this.containerGroup.appendChild(this.mask.element);\n\n    this.elementGroup = document.createElementNS(SVG_NAMESPACE, 'g');\n    this.elementGroup.setAttribute('class', 'a9s-annotation editable selected');\n    this.elementGroup.appendChild(this.shape);\n\n    this.containerGroup.appendChild(this.elementGroup);\n    g.appendChild(this.containerGroup);\n\n    format(this.shape, annotation, config.formatter);\n\n    this.shape.querySelector('.a9s-inner')\n      .addEventListener('mousedown', this.onGrab(this.shape));\n\n    const { x, y, width, height } = getBBox(this.shape);\n\n    // TODO optional: handles to stretch the shape\n/*    this.handles = [\n      [ x, y ], \n      [ x + width, y ], \n      [ x + width, y + height ], \n      [ x, y + height ]\n    ].map(t => { \n      const [ x, y ] = t;\n      const handle = this.drawHandle(x, y);\n\n      handle.addEventListener('mousedown', this.onGrab(handle));\n      this.elementGroup.appendChild(handle);\n\n      return handle;\n    });*/\n\n    // The grabbed element (handle or entire shape), if any\n    this.grabbedElem = null;\n\n    // Mouse grab point\n    this.grabbedAt = null;\n  }\n\n  setPoints = (points) => {\n    // Not using .toFixed(1) because that will ALWAYS\n    // return one decimal, e.g. \"15.0\" (when we want \"15\")\n    const round = num => Math.round(10 * num) / 10;\n\n    var str = points.map(pt => `L${round(pt.x)} ${round(pt.y)}`).join(' ');\n    str = 'M' + str.substring(1);\n\n    const inner = this.shape.querySelector('.a9s-inner');\n    inner.setAttribute('d', str);\n\n    const outer = this.shape.querySelector('.a9s-outer');\n    outer.setAttribute('d', str);\n\n    const { x, y, width, height } = outer.getBBox();\n\n    // TODO optional: mask to dim the outside area\n    // this.mask.redraw();\n\n    // TODO optional: handles to stretch the shape\n/*    const [ topleft, topright, bottomright, bottomleft] = this.handles;\n\n    this.setHandleXY(topleft, x, y);\n    this.setHandleXY(topright, x + width, y);\n    this.setHandleXY(bottomright, x + width, y + height);\n    this.setHandleXY(bottomleft, x, y + height);*/\n\n    setFormatterElSize(this.elementGroup, x, y, width, height);\n  }\n\n    // TODO optional: handles to stretch the shape\n/*  stretchCorners = (draggedHandleIdx, anchorHandle, mousePos) => {\n    const anchor = this.getHandleXY(anchorHandle);\n  }*/\n\n  onGrab = grabbedElem => evt => {\n    this.grabbedElem = grabbedElem;\n    const pos = this.getSVGPoint(evt);\n    this.grabbedAt = { x: pos.x, y: pos.y };\n  }\n\n  onMouseMove = evt => {\n    const constrain = (coord, delta, max) =>\n      coord + delta < 0 ? -coord : (coord + delta > max ? max - coord : delta);\n\n    if (this.grabbedElem) {\n      const pos = this.getSVGPoint(evt);\n\n      const { x, y, width, height } = getBBox(this.shape);\n\n      if (this.grabbedElem === this.shape) {\n\n        const { naturalWidth, naturalHeight } = this.env.image;\n\n        const dx = constrain(x, pos.x - this.grabbedAt.x, naturalWidth - width);\n        const dy = constrain(y, pos.y - this.grabbedAt.y, naturalHeight - height);\n\n        const inner = this.shape.querySelector('.a9s-inner');\n        const updatedPoints = getPoints(inner).map(pt => ({ x: pt.x + dx, y: pt.y + dy }));\n\n        this.grabbedAt = pos;\n\n        this.setPoints(updatedPoints);\n\n        this.emit('update', toSVGTarget(this.shape, this.env.image));\n      }\n      // TODO optional: handles to stretch the shape\n      /* else {\n        const handleIdx = this.handles.indexOf(this.grabbedElem);\n        const oppositeHandle = handleIdx < 2 ? \n          this.handles[handleIdx + 2] : this.handles[handleIdx - 2];\n\n        this.stretchCorners(handleIdx, oppositeHandle, pos);\n\n        this.emit('update', toSVGTarget(this.shape, this.env.image));\n      }*/\n    }\n  }\n\n  onMouseUp = evt => {\n    this.grabbedElem = null;\n    this.grabbedAt = null;\n  }\n\n  get element() {\n    return this.elementGroup;\n  }\n\n  updateState = annotation => {\n    const points = getPoints(svgFragmentToShape(annotation));\n    this.setPoints(points);\n  }\n\n  destroy = () => {\n    this.containerGroup.parentNode.removeChild(this.containerGroup);\n    super.destroy();\n  }\n\n}\n","import Tool from '@recogito/annotorious/src/tools/Tool';\nimport RubberbandFreehand from './RubberbandFreehand';\nimport EditableFreehand from './EditableFreehand';\n\n/**\n * A rubberband selector for freehand fragments.\n */\nexport default class RubberbandFreehandTool extends Tool {\n\n  constructor(g, config, env) {\n    super(g, config, env);\n\n    this._isDrawing = false;\n  }\n\n  startDrawing = (x, y) => {\n    this._isDrawing = true;\n    \n    this.attachListeners({\n      mouseMove: this.onMouseMove,\n      mouseUp: this.onMouseUp,\n      dblClick: this.onDblClick\n    });\n    \n    this.rubberband = new RubberbandFreehand([ x, y ], this.g, this.env);\n  }\n\n  stop = () => {\n    this.detachListeners();\n    \n    this._isDrawing = false;\n\n    if (this.rubberband) {\n      this.rubberband.destroy();\n      this.rubberband = null;\n    }\n  }\n\n  onMouseMove = (x, y) =>\n    this.rubberband.dragTo([ x, y ]);\n\n  onMouseUp = (x, y) => {\n    this.onDblClick(x, y);\n  }\n\n  onDblClick = (x, y) => {\n    this._isDrawing = false;\n\n    this.rubberband.addPoint([ x, y ]);\n\n    this.detachListeners();\n\n    const { width, height } = this.rubberband.getBoundingClientRect();\n\n    const minWidth = this.config.minSelectionWidth || 4;\n    const minHeight = this.config.minSelectionHeight || 4;\n\n    if (width >= minWidth || height >= minHeight) {\n\n      const shape = this.rubberband.element;\n      shape.annotation = this.rubberband.toSelection();\n\n      this.emit('complete', shape);\n    } else {\n      this.emit('cancel');\n    }\n\n    this.stop();\n  }\n\n  get isDrawing() {\n    return this._isDrawing;\n  }\n\n  createEditableShape = annotation =>\n    new EditableFreehand(annotation, this.g, this.config, this.env);\n\n}\n\nRubberbandFreehandTool.identifier = 'freehand';\n\nRubberbandFreehandTool.supports = annotation => {\n  const selector = annotation.selector('SvgSelector');\n  if (selector)\n    return (selector.value.match(/^<svg.*<path*/g) && !selector.value.toUpperCase().includes('Z'));\n}","import { SVG_NAMESPACE } from '../../util/SVG';\n\nexport default class PolygonMask {\n\n  constructor(imageDimensions, polygon) {\n    this.w = imageDimensions.naturalWidth;\n    this.h = imageDimensions.naturalHeight;\n\n    this.polygon = polygon;\n\n    this.mask = document.createElementNS(SVG_NAMESPACE, 'path');\n    this.mask.setAttribute('fill-rule', 'evenodd');    \n    this.mask.setAttribute('class', 'a9s-selection-mask');\n\n    this.mask.setAttribute('d', `M0 0 h${this.w} v${this.h} h-${this.w} z M${this.polygon.getAttribute('points')} z`);\n  }\n\n  redraw = () => {\n    this.mask.setAttribute('d', `M0 0 h${this.w} v${this.h} h-${this.w} z M${this.polygon.getAttribute('points')} z`);\n  }\n\n  get element() {\n    return this.mask;\n  }\n\n  destroy = () =>\n    this.mask.parentNode.removeChild(this.mask)\n\n}","import { Selection } from '@recogito/annotorious/src/tools/Tool';\nimport { toSVGTarget } from '@recogito/annotorious/src/selectors/EmbeddedSVG';\nimport { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\nimport Mask from '@recogito/annotorious/src/tools/polygon/PolygonMask';\n\n// TODO optional: mask to dim the outside area\n//import Mask from './multipolygonMask';\n\n/**\n * A 'rubberband' selection tool for creating multipolygon drawing by\n * clicking and dragging.\n */\nexport default class RubberbandMultipolygon {\n\n  constructor(anchor, g, env) {\n    this.points =  [];\n    this.points.push([ anchor, anchor ])\n\n    this.env = env;\n\n    this.group = document.createElementNS(SVG_NAMESPACE, 'g');\n\n    this.multipolygon = document.createElementNS(SVG_NAMESPACE, 'g');\n    this.multipolygon.setAttribute('class', 'a9s-selection');\n\n    this.outer = document.createElementNS(SVG_NAMESPACE, 'path');\n    this.outer.setAttribute('class', 'a9s-outer');\n\n    this.inner = document.createElementNS(SVG_NAMESPACE, 'path');\n    this.inner.setAttribute('class', 'a9s-inner');\n\n    this.setPoints(this.points);\n    this.mask = new Mask(env.image, this.inner);\n\n    // TODO optional: mask to dim the outside area\n    // this.mask = new Mask(env.image, this.inner);\n\n    this.multipolygon.appendChild(this.outer);\n    this.multipolygon.appendChild(this.inner);\n\n    // Additionally, selection remains hidden until \n    // the user actually moves the mouse\n    this.group.style.display = 'none';\n\n    // TODO optional: mask to dim the outside area\n    // this.group.appendChild(this.mask.element);\n    this.group.appendChild(this.mask.element);\n    this.group.appendChild(this.multipolygon);\n\n    g.appendChild(this.group);\n  }\n\n  setPoints = points => {\n    var attr =\"\";\n\n    for (var ps of points){\n      var attr2=\"\"\n      if (ps.length>0){\n        for (var p of ps) {\n          if (p){\n            if (attr2===\"\"){\n              attr2  +=`M${p[0]},${p[1]}`;\n            }\n            else{\n              attr2  +=` L${p[0]},${p[1]}`;\n            }\n          }\n        };\n         attr+=attr2\n      }\n    }\n\n    attr+=\" Z\"\n    \n    this.outer.setAttribute('d', attr);\n    this.inner.setAttribute('d', attr);\n  }\n\n  getBoundingClientRect = () =>\n    this.outer.getBoundingClientRect();\n\n  dragTo = xy => {\n    // Make visible\n    this.group.style.display = null;\n    const head = this.points[this.points.length - 1].slice(0, this.points[this.points.length - 1].length - 1);\n    var headRest=this.points.slice(0,-1)\n    const rubberband = [ ...head, xy, head[0] ];\n    headRest.push(rubberband)\n    this.setPoints(headRest);\n    this.mask.redraw();\n  }\n  \n  addPoint = xy => {\n    // Don't add a new point if distance < 2 pixels\n    if (this.points[this.points.length - 1].length>0){\n      const head = this.points[this.points.length - 1].slice(0, this.points[this.points.length - 1].length - 1);\n      const lastCorner = head[head.length - 1];\n      const dist = Math.pow(xy[0] - lastCorner[0], 2) + Math.pow(xy[1] - lastCorner[1], 2);\n      if (dist > 4) {\n        this.points[this.points.length - 1] = [ ...head, xy, head[0] ];\n        this.setPoints(this.points);   \n        this.mask.redraw();\n      } \n    } else{\n      this.points[this.points.length - 1] = [xy,xy];\n      this.setPoints(this.points);\n    }\n  }\n\n  undo = () => {\n    if (this.points[this.points.length - 1].length>2){\n      this.points[this.points.length - 1].pop();\n    } else {\n      if (this.points.length>1){\n        this.points.pop()\n      }\n    }\n  }\n\n  newPart = () => {\n    this.points.push([]);\n  }\n \n  get element() {\n    return this.multipolygon;\n  }\n\n  destroy = () => {\n    this.group.parentNode.removeChild(this.group);\n    this.multipolygon = null;    \n    this.group = null;\n  }\n\n  toSelection = () =>\n    new Selection({\n      ...toSVGTarget(this.group, this.env.image),\n      renderedVia: {\n        name: 'multipolygon'\n      }\n    });\n\n}\n","import EditableShape from '@recogito/annotorious/src/tools/EditableShape';\nimport { svgFragmentToShape, toSVGTarget } from '@recogito/annotorious/src/selectors/EmbeddedSVG';\nimport { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\nimport { format, setFormatterElSize } from '@recogito/annotorious/src/util/Formatting';\n\n// TODO optional: mask to dim the outside area\n//import Mask from './MultipolygonMask';\n\nconst getPoints = (shape) => {\n  // Could just be Array.from(shape.querySelector('.inner').points) but...\n  // IE11 :-(\n  const pointLists = getPointsFromPathValue(shape.querySelector('.a9s-inner').attributes.d.nodeValue)\n  const pointArray = [];\n  for (let pointList of pointLists) {\n    let points = []\n    for (let point of pointList) {\n      let p = {\n        x:parseFloat(point[0]),\n        y:parseFloat(point[1])\n      }\n      points.push(p);\n    }\n    pointArray.push(points);\n  }\n\n  return pointArray;\n}\nconst getPointsFromPathValue = polygon => {\n  var results =polygon.split('M');\n  var allcoords = []\n  results.forEach(function (result, index) {\n    if (result.length>0){\n      let coords = []\n      result=result.replace(/ Z/g,\"Z\")\n      result=result.replace(/Z /g,\"Z\")\n      result=result.replace(/Z/g,\"\")\n      result=result.replace(/L /g,\"L\")\n      result=result.replace(/ L/g,\"L\")\n      var coordsString = result.split(\"L\")\n      coordsString.forEach(function(coord, index){\n        coords.push([parseFloat(coord.split(\",\")[0]).toFixed(2).toString(),parseFloat(coord.split(\",\")[1]).toFixed(2).toString()]);\n      });\n      if (coords[0] !== coords[coords.length - 1]){\n        coords.push(coords[0])\n      }\n      allcoords.push(coords)\n    }\n  });\n  return allcoords\n}\nconst getBBox = shape => {\n  return shape.querySelector('.a9s-inner').getBBox();\n}\nexport const svgFragmentToPoints = annotation => {\n  const svgShape = svgFragmentToShape(annotation);\n  var polygon = svgShape.getAttribute('d')\n  var allcoords =  getPointsFromPathValue(polygon)\n  return allcoords\n  //svgShape.getAttribute('d')\n  //  .split(' ') // Split x/y tuples\n  //  .map(xy => xy.split(',').map(str => parseFloat(str.trim())));\n}\n\nconst drawEmbeddedSVG = annotation => {\n  const shape = svgFragmentToShape(annotation);\n\n  // Hack\n  svgFragmentToPoints(annotation);\n\n  // Because we're nitpicky, we don't just draw the shape,\n  // but duplicate it, so we can have inner and an outer lines\n  const g = document.createElementNS(SVG_NAMESPACE, 'g');\n\n  const inner = shape.cloneNode(true);\n  inner.setAttribute('class', 'a9s-inner');\n\n  const outer = shape.cloneNode(true);\n  outer.setAttribute('class', 'a9s-outer');\n\n  g.appendChild(outer);\n  g.appendChild(inner);\n\n  return g;\n}\n/**\n * An editable multipolygon drawing.\n */\nexport default class EditableMultipolygon extends EditableShape {\n\n  constructor(annotation, g, config, env) {\n    super(annotation, g, config, env);\n\n    this.svg.addEventListener('mousemove', this.onMouseMove);\n    this.svg.addEventListener('mouseup', this.onMouseUp);\n\n    // SVG markup for this class looks like this:\n    // \n    // <g>\n    //   <path class=\"a9s-selection mask\"... />\n    //   <g> <-- return this node as .element\n    //     <polygon class=\"a9s-outer\" ... />\n    //     <polygon class=\"a9s-inner\" ... />\n    //     <g class=\"a9s-handle\" ...> ... </g>\n    //     <g class=\"a9s-handle\" ...> ... </g>\n    //     <g class=\"a9s-handle\" ...> ... </g>\n    //     ...\n    //   </g> \n    // </g>\n\n    // 'g' for the editable free drawing compound shape\n    this.containerGroup = document.createElementNS(SVG_NAMESPACE, 'g');\n\n    this.shape = drawEmbeddedSVG(annotation);\n   // TODO optional: mask to dim the outside area\n   // this.mask = new Mask(env.image, this.shape.querySelector('.a9s-inner'));\n    \n   // this.containerGroup.appendChild(this.mask.element);\n\n    this.elementGroup = document.createElementNS(SVG_NAMESPACE, 'g');\n    this.elementGroup.setAttribute('class', 'a9s-annotation editable selected');\n    this.elementGroup.appendChild(this.shape);\n    let pointList = getPoints(this.shape);\n    this.handles = []\n    for (let points of pointList){\n      this.handles.push(points.map(pt => {\n        const handle = this.drawHandle(pt.x, pt.y);\n        handle.addEventListener('mousedown', this.onGrab(handle));\n        this.elementGroup.appendChild(handle);\n        return handle;\n      }))\n    } \n\n\n    this.containerGroup.appendChild(this.elementGroup);\n    g.appendChild(this.containerGroup);\n\n    format(this.shape, annotation, config.formatter);\n\n    this.shape.querySelector('.a9s-inner')\n      .addEventListener('mousedown', this.onGrab(this.shape));\n\n    const { x, y, width, height } = getBBox(this.shape);\n\n    // TODO optional: handles to stretch the shape\n/*    this.handles = [\n      [ x, y ], \n      [ x + width, y ], \n      [ x + width, y + height ], \n      [ x, y + height ]\n    ].map(t => { \n      const [ x, y ] = t;\n      const handle = this.drawHandle(x, y);\n\n      handle.addEventListener('mousedown', this.onGrab(handle));\n      this.elementGroup.appendChild(handle);\n\n      return handle;\n    });*/\n\n    // The grabbed element (handle or entire shape), if any\n    this.grabbedElem = null;\n\n    // Mouse grab point\n    this.grabbedAt = null;\n  }\n\n  setPoints = (points) => {\n    const round = num =>\n    Math.round(10 * num) / 10;\n\n    let str = \"\"\n    for (let pointList of points){\n      str += \"M\"\n      let first = true \n      for (let point of pointList){\n        if (first){\n          first = false\n          str += point.x.toString() + \",\" + point.y.toString()\n        } else {\n          str += \" L\" + round(point.x).toString() + \",\" + round(point.y).toString()\n        }\n      }\n      str += \" Z\"\n    }\n    const inner = this.shape.querySelector('.a9s-inner');\n    inner.setAttribute('d', str);\n\n    const outer = this.shape.querySelector('.a9s-outer');\n    outer.setAttribute('d', str);\n\n    // this.mask.redraw();\n\n    const { x, y, width, height } = outer.getBBox();\n    setFormatterElSize(this.elementGroup, x, y, width, height);\n  }\n\n\n    // TODO optional: handles to stretch the shape\n/*  stretchCorners = (draggedHandleIdx, anchorHandle, mousePos) => {\n    const anchor = this.getHandleXY(anchorHandle);\n  }*/\n\n  onGrab = grabbedElem => evt => {\n    this.grabbedElem = grabbedElem;\n    const pos = this.getSVGPoint(evt);\n    this.grabbedAt = { x: pos.x, y: pos.y };\n  }\n\n  onMouseMove = evt => {\n    if (this.grabbedElem) {\n\n      const pos = this.getSVGPoint(evt);\n\n      if (this.grabbedElem === this.shape) {\n        const dx = pos.x - this.grabbedAt.x;\n        const dy = pos.y - this.grabbedAt.y;\n\n        let pointList = getPoints(this.shape)\n\n        const updatedPoints = []\n        for (let points of pointList){\n          updatedPoints.push(points.map(pt =>\n            ({ x: pt.x + dx, y: pt.y + dy })))\n        } \n    \n        this.grabbedAt = pos;\n\n        this.setPoints(updatedPoints);\n        let i = 0\n        for (let updatedPointsList of updatedPoints){\n            updatedPointsList.forEach((pt, idx) => { \n              if (this.handles[i][idx] !== undefined)\n                this.setHandleXY(this.handles[i][idx], pt.x, pt.y)\n            });\n            i+=1\n        }\n        \n        this.emit('update', {\n          ...toSVGTarget(this.shape, this.env.image),\n          renderedVia: {\n            name: 'multipolygon'\n          }\n        });\n      } else {\n        let handleIdx = -1\n        let pointListIDX = 0\n        let found = false\n\n        for (let handle of this.handles){\n          if (handle.indexOf(this.grabbedElem)>0){\n            handleIdx = handle.indexOf(this.grabbedElem);\n            found=true\n          } else {\n            if (!found){\n              pointListIDX += 1\n            }\n          }\n        }\n  \n        let pointList = getPoints(this.shape)\n  \n        const updatedPoints = []\n        let updatedPointsIDX = 0\n        for (let points of pointList){\n          if (updatedPointsIDX === pointListIDX){\n            let newPoints = []\n            points.forEach(function (value, i) {\n              if (i === handleIdx){\n                newPoints.push(pos)\n              } else {\n                newPoints.push(value)\n              }\n            });\n            updatedPoints.push(newPoints)\n          } else {\n            updatedPoints.push(points)\n          }\n          updatedPointsIDX +=1\n        } \n       \n        this.setPoints(updatedPoints);\n        updatedPointsIDX = 0\n        for (let handle of this.handles){\n          if (updatedPointsIDX === pointListIDX){\n\n            this.setHandleXY(handle[handleIdx], pos.x, pos.y);\n          }\n          updatedPointsIDX +=1\n\n        }\n        \n        this.emit('update', {\n          ...toSVGTarget(this.shape, this.env.image),\n          renderedVia: {\n            name: 'multipolygon'\n          }\n        });\n      }\n    }\n  }\n\n  onMouseUp = evt => {\n    this.grabbedElem = null;\n    this.grabbedAt = null;\n  }\n\n  get element() {\n    return this.elementGroup;\n  }\n\n  updateState = annotation => {\n    const points = getPoints(svgFragmentToShape(annotation));\n    this.setPoints(points);\n  }\n\n  destroy = () => {\n    this.containerGroup.parentNode.removeChild(this.containerGroup);\n    super.destroy();\n  }\n\n}\n","import Tool from '@recogito/annotorious/src/tools/Tool';\nimport RubberbandMultipolygon from './RubberbandMultipolygon';\nimport EditableMultipolygon from './EditableMultipolygon';\n\n/**\n * A rubberband selector for Multipolygon fragments.\n */\nexport default class RubberbandMultipolygonTool extends Tool {\n\n  constructor(g, config, env) {\n    super(g, config, env);\n\n    this._isDrawing = false;\n    \n    document.addEventListener('keydown', evt => {\n      if (evt.key == \"z\" && evt.ctrlKey) {\n        this.undo();\n      }\n      \n      if (evt.key == 'n') {\n        this.newPart();\n      }\n    });  \n  }\n\n  startDrawing = (x, y) => {\n    this._isDrawing = true;\n    \n    this.attachListeners({\n      mouseMove: this.onMouseMove,\n      mouseUp: this.onMouseUp,\n      dblClick: this.onDblClick\n    });\n    \n    this.rubberband = new RubberbandMultipolygon([ x, y ], this.g, this.env);\n  }\n\n  stop = () => {\n    this.detachListeners();\n    \n    this._isDrawing = false;\n\n    if (this.rubberband) {\n      this.rubberband.destroy();\n      this.rubberband = null;\n    }\n  }\n  undo = () =>{\n    if (this.rubberband){\n      this.rubberband.undo();\n\n    }\n  }\n  newPart = () =>{\n    if (this.rubberband){\n      this.rubberband.newPart();\n\n    }\n  }\n\n  onMouseMove = (x, y) =>\n    this.rubberband.dragTo([ x, y ]);\n\n  onMouseUp = (x, y, evt) => {\n    if (evt.altKey){\n      this.onDblClick(evt);\n    } else if (evt.ctrlKey) {\n      this.rubberband.undo();\n    } else{\n      const { width, height } = this.rubberband.getBoundingClientRect();\n\n      const minWidth = this.config.minSelectionWidth || 4;\n      const minHeight = this.config.minSelectionHeight || 4;\n      \n      if (width >= minWidth || height >= minHeight) {\n        this.rubberband.addPoint([ x, y ]);\n      } else {\n        this.emit('cancel');\n        this.stop();\n      }\n    }\n  }\n  \n  onDblClick = (x, y) => {\n    this._isDrawing = false;\n\n    this.rubberband.addPoint([ x, y ]);\n\n    const shape = this.rubberband.element;\n    shape.annotation = this.rubberband.toSelection();\n    this.emit('complete', shape);\n\n    this.stop();\n  }\n\n  get isDrawing() {\n    return this._isDrawing;\n  }\n\n  get isDrawing() {\n    return this._isDrawing;\n  }\n\n  createEditableShape = annotation => \n    new EditableMultipolygon(annotation, this.g, this.config, this.env);\n\n}\n\nRubberbandMultipolygonTool.identifier = 'multipolygon';\n\nRubberbandMultipolygonTool.supports = annotation => false;","import { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\n\nexport default class LineMask {\n\n  constructor(imageDimensions, line) {\n    this.w = imageDimensions.naturalWidth;\n    this.h = imageDimensions.naturalHeight;\n\n    this.line = line;\n\n    this.mask = document.createElementNS(SVG_NAMESPACE, 'path');\n    this.mask.setAttribute('fill-rule', 'evenodd');\n    this.mask.setAttribute('class', 'a9s-selection-mask');\n    this.mask.setAttribute('d', `M0 0 h${this.w} v${this.h} h-${this.w} z M${this.line.getAttribute('x1')} ${this.line.getAttribute('y1')} z`);\n  }\n\n  redraw = () => {\n    this.mask.setAttribute('d', `M0 0 h${this.w} v${this.h} h-${this.w} z M${this.line.getAttribute('x1')} ${this.line.getAttribute('y1')} ${this.line.getAttribute('x2')} ${this.line.getAttribute('y2')}z`);\n  }\n\n  get element() {\n    return this.mask;\n  }\n\n  destroy = () =>\n    this.mask.parentNode.removeChild(this.mask)\n\n}","import { Selection } from '@recogito/annotorious/src/tools/Tool';\nimport { toSVGTarget } from '@recogito/annotorious/src/selectors/EmbeddedSVG';\nimport { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\nimport Mask from './LineMask';\n\n\n/**\n * A 'rubberband' selection tool for creating Line drawing by\n * clicking and dragging.\n */\nexport default class RubberbandLine {\n\n  constructor(anchor, g, env) {\n    this.points =  anchor\n    //this.points.push([ anchor, anchor ])\n\n    this.env = env;\n\n    this.group = document.createElementNS(SVG_NAMESPACE, 'g');\n\n    this.Line = document.createElementNS(SVG_NAMESPACE, 'g');\n    this.Line.setAttribute('class', 'a9s-selection');\n\n    this.outer = document.createElementNS(SVG_NAMESPACE, 'line');\n    this.outer.setAttribute('class', 'a9s-outer');\n\n    this.inner = document.createElementNS(SVG_NAMESPACE, 'line');\n    this.inner.setAttribute('class', 'a9s-inner');\n\n    this.setPoints(this.points);\n    this.mask = new Mask(env.image, this.inner);\n\n    // TODO optional: mask to dim the outside area\n    // this.mask = new Mask(env.image, this.inner);\n\n    this.Line.appendChild(this.outer);\n    this.Line.appendChild(this.inner);\n\n    // Additionally, selection remains hidden until \n    // the user actually moves the mouse\n    this.group.style.display = 'none';\n\n    // TODO optional: mask to dim the outside area\n    // this.group.appendChild(this.mask.element);\n    this.group.appendChild(this.mask.element);\n    this.group.appendChild(this.Line);\n\n    g.appendChild(this.group);\n  }\n\n  setPoints = points => {\n    const attr = points;\n    // set attribute for line svg element for outer and inner\n    // example: <line x1=\"0\" y1=\"80\" x2=\"100\" y2=\"20\" stroke=\"black\" />\n    this.outer.setAttribute('x1', attr[0]);\n    this.inner.setAttribute('x1', attr[0]);\n    this.outer.setAttribute('y1', attr[1]);\n    this.inner.setAttribute('y1', attr[1]);\n    if(attr.length > 2) {\n    this.outer.setAttribute('x2', attr[2]);\n    this.inner.setAttribute('x2', attr[2]);\n    this.outer.setAttribute('y2', attr[3]);\n    this.inner.setAttribute('y2', attr[3]);\n    }\n  }\n\n  getBoundingClientRect = () =>\n    this.outer.getBoundingClientRect();\n\n  dragTo = xy => {\n    // Make visible\n    this.group.style.display = null;\n\n    this.mousepos = xy;\n    //console.log(xy);\n    const rubberband = [ ...this.points, xy[0], xy[1] ];\n    \n    this.setPoints(rubberband);\n    this.mask.redraw();\n  }\n  \n  addPoint = xy => {\n    // Don't add a new point if distance < 2 pixels\n    if (this.points.length <= 2) {\n      this.points[2] = xy[0];\n      this.points[3] = xy[1];\n      this.setPoints(this.points);\n    }\n  }\n\n  undo = () => {\n    if (this.points[this.points.length - 1].length>2){\n      this.points[this.points.length - 1].pop();\n    } else {\n      if (this.points.length>1){\n        this.points.pop()\n      }\n    }\n  }\n\n  newPart = () => {\n    this.points.push([]);\n  }\n \n  get element() {\n    return this.Line;\n  }\n\n  destroy = () => {\n    this.group.parentNode.removeChild(this.group);\n    this.Line = null;    \n    this.group = null;\n  }\n\n  toSelection = () =>\n    new Selection({\n      ...toSVGTarget(this.group, this.env.image),\n      renderedVia: {\n        name: 'line'\n      }\n    });\n\n}\n","import EditableShape from '@recogito/annotorious/src/tools/EditableShape';\nimport { drawEmbeddedSVG, svgFragmentToShape, toSVGTarget } from '@recogito/annotorious/src/selectors/EmbeddedSVG';\nimport { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\nimport { format, setFormatterElSize } from '@recogito/annotorious/src/util/Formatting';\nimport Mask from './LineMask';\n\nconst getPoints = shape => {\n  // Could just be Array.from(shape.querySelector('.inner').points) but...\n  // IE11 :-(\n  const innerElement = shape.querySelector('.a9s-inner');\n  const points = [\n    [innerElement.x1.baseVal, innerElement.y1.baseVal],\n    [innerElement.x2.baseVal, innerElement.y2.baseVal]\n  ];\n\n  return points;\n}\n\nconst getBBox = shape =>\n  shape.querySelector('.a9s-inner').getBBox();\n\n/**\n * An editable line shape.\n */\nexport default class EditableLine extends EditableShape {\n\n  constructor(annotation, g, config, env) {\n    super(annotation, g, config, env);\n\n    this.svg.addEventListener('mousemove', this.onMouseMove);\n    this.svg.addEventListener('mouseup', this.onMouseUp);\n\n    // SVG markup for this class looks like this:\n    //\n    // <g>\n    //   <path class=\"a9s-selection mask\"... />\n    //   <g> <-- return this node as .element\n    //     <line class=\"a9s-outer\" ... />\n    //     <line class=\"a9s-inner\" ... />\n    //     <g class=\"a9s-handle\" ...> ... </g>\n    //     <g class=\"a9s-handle\" ...> ... </g>\n    //     <g class=\"a9s-handle\" ...> ... </g>\n    //     ...\n    //   </g>\n    // </g>\n\n    // 'g' for the editable line shape\n    this.containerGroup = document.createElementNS(SVG_NAMESPACE, 'g');\n\n    this.shape = drawEmbeddedSVG(annotation);\n    this.shape.querySelector('.a9s-inner')\n      .addEventListener('mousedown', this.onGrab(this.shape));\n\n    this.mask = new Mask(env.image, this.shape.querySelector('.a9s-inner'));\n\n    this.containerGroup.appendChild(this.mask.element);\n\n    this.elementGroup = document.createElementNS(SVG_NAMESPACE, 'g');\n    this.elementGroup.setAttribute('class', 'a9s-annotation editable selected');\n    this.elementGroup.setAttribute('data-id', annotation.id);\n    this.elementGroup.appendChild(this.shape);\n\n    this.handles = getPoints(this.shape).map(pt => {\n      const handle = this.drawHandle(pt[0].value, pt[1].value);\n      handle.addEventListener('mousedown', this.onGrab(handle));\n      this.elementGroup.appendChild(handle);\n      return handle;\n    });\n\n    this.containerGroup.appendChild(this.elementGroup);\n    g.appendChild(this.containerGroup);\n\n    format(this.shape, annotation, config.formatters);\n\n    // The grabbed element (handle or entire shape), if any\n    this.grabbedElem = null;\n\n    // Mouse grab point\n    this.grabbedAt = null;\n  }\n\n  onScaleChanged = () => \n    this.handles.map(this.scaleHandle);\n\n  setPoints = (points) => {\n    // Not using .toFixed(1) because that will ALWAYS\n    // return one decimal, e.g. \"15.0\" (when we want \"15\")\n    const round = num =>\n      Math.round(10 * num) / 10;\n\n    var x1 = points[0].x;\n    var y1 = points[0].y;\n    var x2 = points[1].x;\n    var y2 = points[1].y;\n    const inner = this.shape.querySelector('.a9s-inner');\n    inner.setAttribute('x1', x1);\n    inner.setAttribute('y1', y1);\n    inner.setAttribute('x2', x2);\n    inner.setAttribute('y2', y2);\n\n    const outer = this.shape.querySelector('.a9s-outer');\n    outer.setAttribute('x1', x1);\n    outer.setAttribute('y1', y1);\n    outer.setAttribute('x2', x2);\n    outer.setAttribute('y2', y2);\n\n    this.mask.redraw();\n\n    const { x, y, width, height } = outer.getBBox();\n    setFormatterElSize(this.elementGroup, x, y, width, height);\n  }\n\n  onGrab = grabbedElem => evt => {\n    if (evt.button !== 0) return;  // left click\n    this.grabbedElem = grabbedElem;\n    this.grabbedAt = this.getSVGPoint(evt);\n  }\n\n  onMouseMove = evt => {\n    const constrain = (coord, delta, max) =>\n      coord + delta < 0 ? -coord : (coord + delta > max ? max - coord : delta);\n\n    if (this.grabbedElem) {\n      const pos = this.getSVGPoint(evt);\n      if (this.grabbedElem === this.shape) {\n        const { x, y, width, height } = getBBox(this.shape);\n\n        const { naturalWidth, naturalHeight } = this.env.image;\n\n        const dx = constrain(x, pos.x - this.grabbedAt.x, naturalWidth - width);\n        const dy = constrain(y, pos.y - this.grabbedAt.y, naturalHeight - height);\n\n        const updatedPoints = getPoints(this.shape).map(pt =>\n          ({ x: pt[0].value + dx, y: pt[1].value + dy }));\n\n        this.grabbedAt = pos;\n\n        this.setPoints(updatedPoints);\n        updatedPoints.forEach((pt, idx) => this.setHandleXY(this.handles[idx], pt.x, pt.y));\n\n        this.emit('update', toSVGTarget(this.shape, this.env.image));\n      } else {\n        const handleIdx = this.handles.indexOf(this.grabbedElem);\n\n        const updatedPoints = getPoints(this.shape).map((pt, idx) =>\n          (idx === handleIdx) ? pos : {'x':pt[0].value, 'y':pt[1].value});\n\n        this.setPoints(updatedPoints);\n        this.setHandleXY(this.handles[handleIdx], pos.x, pos.y);\n\n        this.emit('update', toSVGTarget(this.shape, this.env.image));\n      }\n    }\n  }\n\n  onMouseUp = evt => {\n    this.grabbedElem = null;\n    this.grabbedAt = null;\n  }\n\n  get element() {\n    return this.elementGroup;\n  }\n\n  // TODO: update this for line svg Attributes, currently not being used\n  updateState = annotation => {\n    const points = svgFragmentToShape(annotation)\n      .getAttribute('points')\n      .split(' ') // Split x/y tuples\n      .map(xy => { \n        const [ x, y ] = xy.split(',').map(str => parseFloat(str.trim()));\n        return { x, y };\n      });\n    \n    this.setPoints(points);\n    points.forEach((pt, idx) => this.setHandleXY(this.handles[idx], pt.x, pt.y));\n  }\n\n  destroy = () => {\n    this.containerGroup.parentNode.removeChild(this.containerGroup);\n    super.destroy();\n  }\n\n}\n","import Tool from '@recogito/annotorious/src/tools/Tool';\nimport RubberbandLine from './RubberbandLine';\nimport EditableLine from './EditableLine';\n\n/**\n * A rubberband selector for Line fragments.\n */\nexport default class RubberbandLineTool extends Tool {\n\n  constructor(g, config, env) {\n    super(g, config, env);\n\n    this._isDrawing = false;\n    \n    document.addEventListener('keydown', evt => {\n      if (evt.key == \"z\" && evt.ctrlKey) {\n        this.undo();\n      }\n      \n      if (evt.key == 'n') {\n        this.newPart();\n      }\n    });  \n  }\n\n  startDrawing = (x, y) => {\n    this._isDrawing = true;\n    \n    this.attachListeners({\n      mouseMove: this.onMouseMove,\n      mouseUp: this.onMouseUp,\n    });\n    \n    this.rubberband = new RubberbandLine([ x, y ], this.g, this.env);\n  }\n\n  stop = () => {\n    this.detachListeners();\n    \n    this._isDrawing = false;\n\n    if (this.rubberband) {\n      this.rubberband.destroy();\n      this.rubberband = null;\n    }\n  }\n  undo = () =>{\n    if (this.rubberband){\n      this.rubberband.undo();\n\n    }\n  }\n  newPart = () =>{\n    if (this.rubberband){\n      this.rubberband.newPart();\n\n    }\n  }\n\n  onMouseMove = (x, y) =>\n    this.rubberband.dragTo([ x, y ]);\n\n  onMouseUp = (x, y, evt) => {\n    if (evt.altKey){\n      this.onDblClick(evt);\n    } else if (evt.ctrlKey) {\n      this.rubberband.undo();\n    } else{\n      // TODO: see when this is useful\n      // const { width, height } = this.rubberband.getBoundingClientRect();\n\n      // const minWidth = this.config.minSelectionWidth || 4;\n      // const minHeight = this.config.minSelectionHeight || 4;\n      \n      if (this.rubberband.points.length == 2) {\n        this.rubberband.addPoint([ x, y ]); \n        // check if both coordinates are same\n        if (this.rubberband.points[0] == this.rubberband.points[2] && this.rubberband.points[1] == this.rubberband.points[3]) {\n          this.emit('cancel');\n          this.stop();\n        }\n        else{\n          this._isDrawing = false;\n          const shape = this.rubberband.element;\n          shape.annotation = this.rubberband.toSelection();\n          this.emit('complete', shape);\n          this.stop();\n        }\n      }\n    }\n  }\n  \n\n  get isDrawing() {\n    return this._isDrawing;\n  }\n\n  get isDrawing() {\n    return this._isDrawing;\n  }\n\n  createEditableShape = annotation => \n    new EditableLine(annotation, this.g, this.config, this.env);\n\n}\n\nRubberbandLineTool.identifier = 'line';\n\nRubberbandLineTool.supports = annotation => {\n  const selector = annotation.selector('SvgSelector');\n  if (selector)\n    return selector.value?.match(/^<svg.*<line/g);\n}","import PointTool from './point/PointTool';\nimport PinPointTool from './pinpoint/PinpointTool';\nimport RubberbandCircleTool from './circle/RubberbandCircleTool';\nimport RubberbandEllipseTool from './ellipse/RubberbandEllipseTool';\nimport RubberbandFreehandTool from './freehand/RubberbandFreehandTool';\nimport RubberbandMultipolygonTool from './multipolygon/RubberbandMultipolygonTool';\nimport RubberbandLineTool from './line/RubberbandLineTool';\n\nconst ALL_TOOLS = new Set([\n  'point',\n  'circle',\n  'ellipse',\n  'freehand',\n  'line',\n  'pinpoint',\n  // 'multipolygon' // exclude from defaults for now\n]);\n\nconst SelectorPack = (anno, config) => {\n\n  // Add configured tools, or all\n  const tools = config?.tools ? \n    config.tools.map(t => t.toLowerCase()) : ALL_TOOLS;\n\n  tools.forEach(tool => {\n    if (tool === 'point')\n      anno.addDrawingTool(PointTool);\n\n    if (tool === 'pinpoint')\n      anno.addDrawingTool(PinPointTool);\n\n    if (tool === 'circle')\n      anno.addDrawingTool(RubberbandCircleTool);\n\n    if (tool === 'ellipse')\n      anno.addDrawingTool(RubberbandEllipseTool);\n  \n    if (tool === 'freehand')\n      anno.addDrawingTool(RubberbandFreehandTool);\n\n    if (tool === 'multipolygon')\n      anno.addDrawingTool(RubberbandMultipolygonTool);\n\n    if (tool === 'line')\n      anno.addDrawingTool(RubberbandLineTool);\n  });\n\n}\nexport { default as ShapeLabelsFormatter } from './formatter/LabelFormatter'\nexport default SelectorPack;\n"],"names":["root","factory","exports","module","define","amd","self","_typeof","obj","Symbol","iterator","constructor","prototype","equal","a","b","length","i","keys","Array","isArray","RegExp","source","flags","valueOf","Object","toString","hasOwnProperty","call","key","E","on","name","callback","ctx","e","this","push","fn","once","listener","off","apply","arguments","_","emit","data","slice","evtArr","len","evts","liveEvents","TinyEmitter","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","definition","o","defineProperty","enumerable","get","prop","getRandomValues","SVG_NAMESPACE","rnds8","Uint8Array","rng","crypto","bind","msCrypto","Error","byteToHex","substr","arr","offset","uuid","toLowerCase","REGEX","validate","TypeError","options","buf","rnds","random","stringify","WebAnnotation","annotation","opts","_this","_classCallCheck","_defineProperty","opt_props","opt_opts","_objectSpread","underlying","type","target","selector","find","s","value","other","id","equals","_this$opts","readOnly","motivation","body","set","bodies","_this$selector","exact","_this$selector2","start","_this$selector3","end","args","stub","concat","Selection","cloned","JSON","parse","assign","IMPLEMENTATION_MISSING","isTouch","window","navigator","maxTouchPoints","msMaxTouchPoints","ToolLike","_EventEmitter","_inherits","_super","_createSuper","g","config","env","_assertThisInitialized","ResizeObserver","resizeObserver","svgBounds","svg","getBoundingClientRect","_this$svg$viewBox$bas","viewBox","baseVal","width","height","scale","Math","max","onScaleChanged","observe","parentNode","evt","pt","createSVGPoint","bbox","x","clientX","y","clientY","_this$svg$getBounding","left","top","matrixTransform","getScreenCTM","inverse","offsetX","offsetY","getCTM","containerGroup","document","createElementNS","setAttribute","group","drawCircle","r","c","radius","handleRadius","inner","outer","appendChild","handle","querySelector","parseFloat","getAttribute","closest","image","Element","HTMLDocument","enableResponsive","_createClass","disconnect","EventEmitter","Tool","_ToolLike","_super2","_this2","_ref","mouseMove","mouseUp","dblClick","_this2$getSVGPoint","getSVGPoint","started","addEventListener","button","_this2$getSVGPoint2","_this2$getSVGPoint3","removeEventListener","startOnSingleClick","_this2$getSVGPoint4","startDrawing","formatters","supports","EditableShape","parseRectFragment","conformsTo","startsWith","format","includes","substring","indexOf","_coords$split$map2","_slicedToArray","split","map","w","h","naturalWidth","naturalHeight","toFragment","fragmentUnit","px","py","pw","ph","src","toPercentRectFragment","toPixelRectFragment","toRectFragment","renderedVia","EditablePoint","_EditableShape","scaleHandle","point","isGrabbed","_this$getSVGPoint","setHandleXY","_parseRectFragment","onMouseMove","onMouseUp","_parseRectFragment2","container","elementGroup","drawHandle","onGrab","removeChild","_get","_getPrototypeOf","PointTool","_Tool","_evt$target$closest","_annotation$target$re","isPoint","element","identifier","sanitize","doc","cleanEl","el","from","attributes","forEach","attr","removeAttribute","scripts","getElementsByTagName","reverse","querySelectorAll","svgFragmentToShape","originalDoc","namespaced","parser","DOMParser","parseFromString","isPrefixDeclared","lookupPrefix","isDefaultNamespaceSVG","lookupNamespaceURI","firstChild","XMLSerializer","serializeToString","documentElement","replace","drawEmbeddedSVG","shape","cloneNode","toSVGTarget","serialized","outerHTML","methods$1","names","registerMethods","m","_step","_iterator","_createForOfIteratorHelper","done","err","f","addMethodNames","getOwnPropertyNames","_name","getMethodsFor","_names","_toConsumableArray","array","block","il","result","radians","PI","camelCase","toUpperCase","capitalize","charAt","proportionalSize","box","getOrigin","origin","ox","originX","oy","originY","_ref2","condX","condY","_element$bbox","xmlns","xlink","globals","Base","elements","create","ns","makeInstance","isHTML","adopter","wrapper","createElement","innerHTML","nodeOrNew","node","ownerDocument","defaultView","Node","adopt","instance","nodeName","Fragment","className","register","asRoot","did","eid","assignNewId","children","extend","modules","methods","wrapWithAttrCheck","_len","_key","siblings","parent","position","index","next","prev","forward","add","remove","backward","front","back","before","after","insertBefore","insertAfter","numberAndUnit","hex","rgb","reference","transforms","whitespace","isHex","isRgb","isBlank","isNumber","isImage","delimiter","isPathLetter","componentHex","component","integer","round","min","is","object","space","hueToRgb","p","q","t","classes","trim","hasClass","addClass","join","removeClass","filter","toggleClass","css","style","val","ret","cssText","_step2","_iterator2","cased","test","show","hide","visible","v","_step3","_iterator3","remember","k","memory","forget","_memory","Color","init","_this$rgb","_map2","_a","_b","_c","_this$rgb2","_map4","l","isGrey","delta","_d","values","params","z","getParameters","noWhitespace","_rgb$exec$slice$map2","exec","parseInt","_hex$exec$map","sixDigitHex","_hex$exec$map2","components","_this$xyz","xyz","_this$lab","lab","sqrt","pow","atan2","dToR","cos","sin","yL","xL","zL","ct","mx","nm","rU","gU","bU","bd","_this$_clamped$map2","_clamped","_this$_clamped2","rV","gV","bV","toHex","_this$rgb3","_map6","rL","gL","bL","xU","yU","zU","_this$rgb4","color","mode","pi","grey","Point","clone","transformO","Matrix","isMatrixLike","closeEnough","threshold","abs","cx","cy","matrix","aroundO","dx","dy","translateO","lmultiplyO","determinant","ccw","sx","thetaRad","theta","st","lam","sy","scaleX","scaleY","shear","rotate","translateX","translateY","comp","axis","around","flipO","scaleO","base","fromArray","matrixify","transform","inverseO","det","na","nb","nc","nd","ne","nf","matrixMultiply","multiplyO","rotateO","_this$clone","shearO","lx","_this$clone2","skewO","tan","ly","skew","formatTransforms","_Point$transform","transformer","rx","ry","skewX","skewY","isFinite","tx","ty","flipBoth","flip","flipX","flipY","positionX","NaN","positionY","translate","relative","relativeX","relativeY","nodes","size","path","addTo","isNulledBox","Box","pageXOffset","pageYOffset","x2","y2","xMin","Infinity","xMax","yMin","yMax","getBox","getBBoxFn","retry","contains","viewbox","zoom","level","_this$attr","clientWidth","clientHeight","zoomX","zoomY","zoomAmount","Number","MAX_SAFE_INTEGER","List","_Array","_this3","_len2","_key2","_possibleConstructorReturn","_wrapNativeSuper","each","fnOrMethodName","_len3","_key3","toArray","reserved","baseFind","query","reduce","_len4","attrs","_key4","listenerId","windowEvents","getEvents","getEventHolder","events","getEventTarget","binding","bag","_svgjsListenerId","event","ev","namespace","clearEvents","EventTarget","_Base","Event","CustomEvent","detail","cancelable","dispatchEvent","dispatch","j","defaultPrevented","noop","timeline","fill","stroke","opacity","SVGArray","_Array2","_super3","_this5","_this4","_len5","_key5","Set","SVGNumber","unit","number","isNaN","match","hooks","Dom","_EventTarget","_super4","_this7","removeNamespace","SVGElement","childNodes","put","hasChildNodes","lastChild","deep","writeDataToDom","htmlOrFn","xml","matcher","matches","matchesSelector","msMatchesSelector","mozMatchesSelector","webkitMatchesSelector","oMatchesSelector","removeElement","replaceChild","precision","factor","svgOrFn","outerSVG","text","textContent","xmlOrFn","outerXML","current","well","fragment","createDocumentFragment","firstElementChild","_this6","_step4","_iterator4","nodeValue","last","curr","_val","hook","isColor","leading","setAttributeNS","rebuild","findOne","_Dom","_super5","_this8","dom","hasAttribute","setData","defs","plus","until","isSelector","parents","getBBox","rbox","screenCTM","addOffset","inside","ctm","isRoot","rect","sugar","prefix","extension","mat","angle","direction","_element","getTotalLength","pointAt","getPointAtLength","font","untransform","str","kv","lmultiply","toParent","pCtm","multiply","toRoot","decomposed","decompose","Container","_Element","_super6","flatten","ungroup","Defs","_Container","_super7","Shape","_Element2","_super8","x$3","y$3","cx$1","cy$1","width$2","divide","height$2","Ellipse","_Shape","_super9","circled","ellipse","move","_Dom2","_super10","fx","fy","x1","y1","to","Gradient","_Container2","_super11","url","clear","gradiented","gradient","_this$defs","update","Pattern","_Container3","_super12","pattern","_this$defs2","patternUnits","Image","_Shape2","_super13","img","load","PointArray","_SVGArray","_super14","maxX","maxY","minX","minY","points","pop","_this$i","Line","_Shape3","_super15","toLine","pointed","line","_len6","_key6","plot","Marker","_Container4","_super16","orient","makeSetterGetter","marker","_this$defs3","ref","easing","pos","bezier","steps","stepPosition","jumps","beforeFlag","step","floor","jumping","Stepper","Ease","_Stepper","_super17","_this9","ease","Controller","_Stepper2","_super18","_this10","stepper","dt","recalculate","duration","_duration","overshoot","_overshoot","os","log","zeta","wn","_Controller","Spring","_super19","_this11","velocity","acceleration","newPosition","PID","_Controller2","_super20","_this12","windup","integral","error","_windup","P","I","D","segmentParameters","M","L","H","V","C","S","Q","T","A","Z","pathHandlers","p0","mlhvqtcsaz","jl","segmentComplete","segment","startNewSegment","token","inNumber","finalizeNumber","pathLetter","lastCommand","small","isSmall","inSegment","pointSeen","hasExponent","finalizeSegment","absolute","command","makeAbsolut","segments","isArcFlag","isArc","isExponential","lastToken","PathArray","_SVGArray2","_super21","pathParser","arrayToString","getClassForType","NonMorphable","morphableTypes","ObjectBag","Morphable","_stepper","_from","_to","_type","_context","_morphObj","morph","_set","align","toConsumable","TransformBag","defaults","sortByKey","defaultObject","toDelete","splice","_this$values","objOrArr","entries","Type","sort","shift","num","Path","_Shape4","_super22","_array","MorphArray","Polygon","_Shape5","_super23","polygon","poly","Polyline","_Shape6","_super24","polyline","Rect","_Shape7","_super25","Queue","_first","_last","item","Animator","nextDraw","frames","timeouts","immediates","timer","performance","Date","frame","run","requestAnimationFrame","_draw","timeout","delay","time","now","immediate","cancelFrame","clearTimeout","cancelImmediate","nextTimeout","lastTimeout","nextFrame","lastFrame","nextImmediate","first","makeSchedule","runnerInfo","runner","defaultSource","Timeline","_EventTarget2","_super26","_this13","timeSource","_timeSource","_startTime","_speed","_persist","_nextFrame","_paused","_runners","_runnerIds","_lastRunnerId","_time","_lastSourceTime","_lastStepTime","_stepFn","_stepImmediate","getEndTimeOfTimeline","pause","lastRunnerInfo","getLastRunnerInfo","lastDuration","endTimes","getRunnerInfoById","_continue","dtOrForever","updateTime","yes","currentSpeed","speed","positive","when","absoluteStartTime","endTime","getEndTime","unschedule","persist","info","active","immediateStep","dtSource","dtTime","fire","reset","runnersLeft","dtToStart","_timeline","Runner","_EventTarget3","_super27","_this14","_queue","_isDeclarative","_history","enabled","_lastTime","_reseted","transformId","_haveReversed","_reverse","_loopsDone","_swing","_wait","_times","_frameId","sanitise","loop","schedule","isTransform","animate","queue","_prepareRunner","times","swing","wait","loopDuration","loopsDone","partial","swinging","backwards","uncliped","loops","swingForward","initFn","runFn","retargetFn","initialiser","retarget","initialised","finished","running","_lastPosition","justStarted","justFinished","declarative","converged","_initialise","_run","needsIt","method","morpher","caller","play","positionOrDt","allfinished","extra","FakeRunner","mergeWith","getRunnerTransform","mergeTransforms","netTransform","_transformationRunners","runners","merge","RunnerArray","ids","deleteCnt","clearTransformsFromQueue","newRunner","lastRunner","edit","by","_clearTransformRunnersBefore","currentRunner","clearBefore","_currentTransform","_addRunner","styleAttr","nameOrAttrs","_tryRetarget","at","newToAttrs","newKeys","differences","addedFromAttrs","oldFromAttrs","oldToAttrs","_rememberMorpher","newLevel","newPoint","affine","isMatrix","currentAngle","startTransform","clearTransform","_Point$transform2","rTarget","rCurrent","possibilities","distances","shortest","affineParameters","addTransform","newTransforms","_queueNumber","_queueNumberDelta","dmove","newTo","_queueObject","center","Svg","_Container5","_super28","_this15","version","nested","_Container6","_Symbol","_super29","symbol","_build","createTextNode","getComputedTextLength","ax","ay","build","Text","_Shape8","_super30","_this16","_rebuild","blankLineOffset","fontSize","getComputedStyle","getPropertyValue","newLined","firstLine","nodeType","newLine","textable","plain","Tspan","_Shape9","_super31","_this17","tspan","Circle","_Shape10","_super32","circle","ClipPath","_Container7","_super33","targets","unclip","clip","clipper","clipWith","ForeignObject","_Element3","_super34","foreignObject","child","G","_Container8","_super35","containerGeometry","_Container9","_super36","link","unlink","linker","linkTo","wrap","Mask","_Container10","_super37","unmask","mask","masker","maskWith","Stop","_Element4","_super38","stop","Style","_Element5","_super39","rule","fontFamily","addText","cssRule","fontface","TextPath","_Text","_super40","track","pathArray","textPath","importNodes","_this18","Use","_Shape11","_super41","file","use","SVG","registerMorphableType","context","Pinpoint","anchorX","anchorY","oppositeX","oppositeY","_this$env$image","display","anchor","innerPath","outerPath","innerPathData","outerPathData","setPinSize","pinpoint","purpose","outerPin","innerPin","drawPin","pointerEvents","isFirefox","userAgent","formatSvgEl","svgEl","merged","String","ELEMENT_NODE","classNames","getClassNames","formatterEl","_shape$getBBox","append","appendFormatterEl","setFormatterElSize","getPoints","pointList","EditablePinpoint","_thisSuper","_outer$getBBox","grabbedElem","grabbedAt","constrain","coord","_getBBox","updatedPoints","setPoints","_annotation$targets","_annotation$targets$f","_annotation$targets$f2","_t$renderedVia","formatter","PinpointTool","toSelection","destroy","dragTo","setXYR","setCircleSize","innerCircle","outerCircle","getCircleSize","CircleMask","imageDimensions","_getCircleSize","_getCircleSize2","RubberbandCircle","redraw","EditableCircle","_this$handles","handles","topleft","topright","bottomright","bottomleft","draggedHandleIdx","anchorHandle","mousePos","getHandleXY","mouseX","mouseY","idx0","idx2","idx3","idx1","setSize","handleIdx","oppositeHandle","stretchCorners","_getCircleSize3","_t","RubberbandCircleTool","attachListeners","rubberband","detachListeners","_this$rubberband$getB","minWidth","minSelectionWidth","minHeight","minSelectionHeight","_selector$value","setEllipseSize","innerEllipse","outerEllipse","getEllipseSize","EllipseMask","_getEllipseSize","_getEllipseSize2","RubberbandEllipse","drawEllipse","EditableEllipse","leftHandle","anchorLeft","_getEllipseSize3","RubberbandEllipseTool","RubberbandFreehand","xy","addPoint","freehand","EditableFreehand","_getBBox2","RubberbandFreehandTool","_isDrawing","onDblClick","PolygonMask","RubberbandMultipolygon","ps","attr2","head","headRest","lastCorner","multipolygon","pointArray","getPointsFromPathValue","results","allcoords","coords","toFixed","EditableMultipolygon","_step5","_iterator5","_i","_updatedPoints","idx","_step6","pointListIDX","found","_iterator6","_step7","updatedPointsIDX","_iterator7","_loop","newPoints","_step8","_iterator8","svgFragmentToPoints","_step9","_iterator9","RubberbandMultipolygonTool","undo","newPart","altKey","ctrlKey","LineMask","RubberbandLine","mousepos","innerElement","EditableLine","_xy$split$map2","RubberbandLineTool","ALL_TOOLS","anno","tools","tool","addDrawingTool","PinPointTool"],"sourceRoot":""}